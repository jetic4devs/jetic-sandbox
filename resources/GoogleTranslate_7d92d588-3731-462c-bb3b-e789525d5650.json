{
  "type" : "BEANS",
  "properties" : {
    "codeGroovy" : "beans {\n    myString = 'Hello World!'\n\n    myProcessor = processor { \n        it.in.body = 'Hello from Groovy'\n    }\n\n    myPredicate = predicate {\n        it.in.body != null\n    }\n}",
    "codeJava" : "// Upgrade to v3beta1  https://googleapis.dev/java/google-api-grpc/0.62.0/com/google/cloud/translate/v3beta1/TranslateTextRequest.Builder.html\n@BindToRegistry\npublic Processor detectLanguage() {\n    return exchange -> {\n\n        URL googleCredentialUri;\n        String projectId = (String)exchange.getProperty(\"googleProjectId\");\n        GoogleCredentials credentials = null;\n        TranslationServiceSettings translationServiceSettings = null;\n\n        try {\n\t\t\t\t\t\tString credentialFile = \"yakrcl-service-account-dev.json\";\n            googleCredentialUri = exchange.getContext().getClassResolver().loadResourceAsURL(credentialFile);\n            credentials = GoogleCredentials.fromStream(googleCredentialUri.openStream());\n        } catch (Exception e) {\n            System.out.println(\"Failed to read/generate credentials \" + e);\n            return;\n        }\n\n        try {\n            translationServiceSettings = TranslationServiceSettings.newBuilder()\n                .setCredentialsProvider(FixedCredentialsProvider.create(credentials))\n                .build();\n\n\n            try (TranslationServiceClient client = TranslationServiceClient.create(translationServiceSettings)) {\n\n                LocationName parent = LocationName.of(projectId, \"global\");\n\n                // Supported Mime Types: https://cloud.google.com/translate/docs/supported-formats\n                DetectLanguageRequest request = DetectLanguageRequest.newBuilder()\n                    .setParent(parent.toString())\n                    .setMimeType(\"text/plain\")\n                    .setContent((String)exchange.getIn().getBody())\n                    .build();\n\n                DetectLanguageResponse response = client.detectLanguage(request);\n\n                ArrayList<HashMap<String, Object>> detectResults = new ArrayList<HashMap<String, Object>>();\n\t\t\t\t\t\t\t\texchange.setProperty(\"detectResults\", detectResults);\n                for (DetectedLanguage language : response.getLanguagesList()) {\n                    detectResults.add(new HashMap<String, Object>() {{\n                        put(\"code\", language.getLanguageCode());\n                        put(\"confidence\", language.getConfidence());\n                    }});\n                }\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (detectResults.size() == 0) {\n\t\t\t\t\t\t\t\t\texchange.getIn().setHeader(\"CamelHttpResponseCode\", 404);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t              exchange.getIn().setBody(detectResults);\n  \t            exchange.getIn().setHeader(\"CamelHttpResponseCode\", 200);\t\t\t\t\t\t\t\n            }\n        } catch (Exception e) {\n            exchange.getIn().setBody(e.getMessage());\n            exchange.getIn().setHeader(\"CamelHttpResponseCode\", 500);\n        }\n\n    };\n}\n\n@BindToRegistry\npublic Processor translateText() {\n    return exchange -> {\n\n        URL googleCredentialUri;\n        String projectId = (String)exchange.getProperty(\"googleProjectId\");\n        GoogleCredentials credentials = null;\n        TranslationServiceSettings translationServiceSettings = null;\n\n        try {\n\t\t\t\t\t\t//String credentialFile = (String)exchange.getProperty(\"credentialFile\");\n\t\t\t\t\t\tString credentialFile = \"yakrcl-service-account-dev.json\";\n            googleCredentialUri = exchange.getContext().getClassResolver().loadResourceAsURL(credentialFile);\n            credentials = GoogleCredentials.fromStream(googleCredentialUri.openStream());\n        } catch (Exception e) {\n            System.out.println(\"Failed to read/generate credentials \" + e);\n            return;\n        }\n\n        try {\n            translationServiceSettings = TranslationServiceSettings.newBuilder()\n                .setCredentialsProvider(FixedCredentialsProvider.create(credentials))\n                .build();\n\n            try (TranslationServiceClient client = TranslationServiceClient.create(translationServiceSettings)) {\n\n                LocationName parent = LocationName.of(projectId, \"global\");\n\n                String targetLanguage = (String)exchange.getProperty(\"outputDialect\");\n                if (targetLanguage == null) {\n                    exchange.getIn().setHeader(\"CamelHttpResponseCode\", \"400\");\n                    exchange.getIn().setBody(\"Target language not specified in request\");\n                }\n\n                // Supported Mime Types: https://cloud.google.com/translate/docs/supported-formats\n                TranslateTextRequest request = TranslateTextRequest.newBuilder()\n                    .setParent(parent.toString())\n                    .setMimeType(\"text/plain\")\n                    .setTargetLanguageCode(targetLanguage)\n                    .addContents((String)exchange.getIn().getBody())\n                    .build();\n\n                TranslateTextResponse response = client.translateText(request);\n                List<Translation> translationList = response.getTranslationsList();\n\n\t\t\t\t\t\t\t\texchange.setProperty(\"translationResults\", translationList);\n                if (translationList.size() == 0) {\n                    exchange.getIn().setHeader(\"CamelHttpResponseCode\", 404);\n                    return;\n                }\n\n                Translation translatedResponse = translationList.get(0);\n\n                exchange.getIn().setHeader(\"CamelHttpResponseCode\", 200);\n                exchange.getIn().setBody(new HashMap<String, String>() {{\n                    put(\"output_text\", translatedResponse.getTranslatedText());\n                    put(\"detected_dialect\", translatedResponse.getDetectedLanguageCode());\n                }});\n\n\t\t\t\t\t\t\treturn;\n            }\n        } catch (Exception e) {\n            System.out.println(e);\n            exchange.getIn().setBody(e.getMessage());\n            exchange.getIn().setHeader(\"CamelHttpResponseCode\", 500);\n        }\n\n    };\n}\n\n@BindToRegistry\npublic Processor getSupportedLanguages() {\n    return exchange -> {\n\n        URL googleCredentialUri;\n        String projectId = (String)exchange.getProperty(\"googleProjectId\");\n        GoogleCredentials credentials = null;\n        TranslationServiceSettings translationServiceSettings = null;\n\n        try {\n\t\t\t\t\t\tString credentialFile = (String)exchange.getProperty(\"credentialFile\");\n            googleCredentialUri = exchange.getContext().getClassResolver().loadResourceAsURL(credentialFile);\n            credentials = GoogleCredentials.fromStream(googleCredentialUri.openStream());\n        } catch (Exception e) {\n            System.out.println(\"Failed to read/generate credentials \" + e);\n            return;\n        }\n\n        try {\n            translationServiceSettings = TranslationServiceSettings.newBuilder()\n                .setCredentialsProvider(FixedCredentialsProvider.create(credentials))\n                .build();\n\n\n            try (TranslationServiceClient client = TranslationServiceClient.create(translationServiceSettings)) {\n                LocationName parent = LocationName.of(projectId, \"global\");\n                GetSupportedLanguagesRequest request = GetSupportedLanguagesRequest.newBuilder().setParent(parent.toString()).build();\n\n                SupportedLanguages response = client.getSupportedLanguages(request);\n                ArrayList<HashMap<String, String>> languages = new ArrayList<HashMap<String, String>>();\n                for (SupportedLanguage language : response.getLanguagesList()) {\n                    languages.add(new HashMap<String, String>() {{ put(\"code\", language.getLanguageCode()); }});\n                }\n\n                exchange.getIn().setBody(languages);\n                exchange.getIn().setHeader(\"CamelHttpResponseCode\", 200);\n            }\n        } catch (Exception e) {\n            exchange.getIn().setBody(e.getMessage());\n            exchange.getIn().setHeader(\"CamelHttpResponseCode\", 500);\n        }\n\n    };\n}",
    "importsJava" : "import org.apache.camel.BindToRegistry;\nimport org.apache.camel.Processor;\nimport org.apache.camel.builder.RouteBuilder;\nimport org.apache.commons.codec.binary.Base64;\n\nimport java.util.*;\nimport java.net.URL;\nimport java.io.IOException;\nimport java.io.FileInputStream;\nimport java.io.File;\n\nimport com.google.auth.oauth2.GoogleCredentials;\nimport com.google.cloud.translate.v3.GetSupportedLanguagesRequest;\nimport com.google.cloud.translate.v3.SupportedLanguage;\nimport com.google.cloud.translate.v3.SupportedLanguages;\nimport com.google.cloud.translate.v3.DetectLanguageRequest;\nimport com.google.cloud.translate.v3.DetectLanguageResponse;\nimport com.google.cloud.translate.v3.DetectedLanguage;\nimport com.google.cloud.translate.v3.LocationName;\nimport com.google.cloud.translate.v3.TranslateTextRequest;\nimport com.google.cloud.translate.v3.TranslateTextResponse;\nimport com.google.cloud.translate.v3.Translation;\nimport com.google.cloud.translate.v3.TranslationServiceClient;\nimport com.google.cloud.translate.v3.TranslationServiceSettings;\nimport com.google.api.gax.core.FixedCredentialsProvider;\n\nimport com.fasterxml.jackson.databind.ObjectMapper;",
    "type" : "Java"
  },
  "id" : "7d92d588-3731-462c-bb3b-e789525d5650",
  "name" : "GoogleTranslate",
  "description" : "Google Translate Bean",
  "createdAt" : "2023-10-04T18:05:19.218414947",
  "updatedAt" : "2023-10-04T18:05:19.218416101",
  "createdBy" : "612c1b37-217d-49f9-b344-54b8af760f6a",
  "updatedBy" : "612c1b37-217d-49f9-b344-54b8af760f6a"
}