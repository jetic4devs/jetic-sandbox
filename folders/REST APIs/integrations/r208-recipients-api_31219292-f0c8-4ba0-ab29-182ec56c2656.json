{
  "revision" : 1111,
  "compression" : false,
  "dataAnalyzer" : true,
  "replicas" : 1,
  "openApiUuid" : "4495358f-e00f-4ff5-bfca-d39fdd4767bd",
  "currentProfileUuid" : "62c1cde5-30f6-41d5-8c08-26ffb86e3053",
  "parameterGroupUuids" : [ "3dacce84-b8c8-4759-8bfa-355c8cf6acd6", "c9a8ecf3-391c-4a06-bdc0-68a1a504fdd9", "ca06b01a-b205-4b2b-9e9d-9f49614e7e94", "351ac858-4e6b-4902-9090-0be62c4dc9e0" ],
  "repoResourceUuids" : [ "07e34d9c-7cea-4532-94e6-7da0f6bddeb3", "2d21c0b9-a829-4420-84e6-67d34aaf6026", "fedc2ba8-c348-4a92-a89c-844badda8f1f", "71e48dda-80e9-4034-af48-cf39a9a10938", "60b1161c-74ee-4cd8-96a1-0055c90271c1", "1872a943-2a9b-4513-8739-06e95090b977", "f50d9293-f6bf-47b6-b21e-4cfda6eee3c4", "eddb9cf2-828c-4bf6-a038-93128340a0c2", "6501fd9a-7f2d-4062-80c2-1731502b18a6", "38657aaf-c7a4-4a04-9321-bb750c2e67b5", "9fb5f9ac-54fb-4ea4-b9d6-a3f95d92021b", "55882383-5e69-44b0-a3ac-12785e306303", "e859d27c-054e-489d-96ef-1338b179fde7", "a4411b87-973f-46d9-b2b6-369b518dbe52", "05649865-0c5a-4bfd-bddb-046f69383940", "cea63fc0-42b4-43ef-8a11-ab37de1f4f55", "b8eedc93-06a9-4e7d-b469-1d7b3d96c691", "95a31431-529a-48a1-a5a9-6be52b6235ad", "a1201a9d-569b-43a9-ad45-945750fa830b", "ef4aff81-4b71-4efc-9e73-b38e2c43b18d", "a1057428-1531-40a8-a129-ed27382e947f", "3b5aa833-0eaa-4cb9-8ce8-ca97eac74110", "0d41f9ca-58b0-434f-a68e-5855e59f3249", "17e7ca54-4247-4e9c-ba30-d078e3ac407a" ],
  "routeDefinitions" : [ {
    "id" : null,
    "camelRouteId" : "route-1",
    "enabled" : true,
    "routeId" : 1,
    "route" : [ {
      "name" : "postRequest",
      "nodeId" : "58dd659b-71ed-4ab1-9b7a-fb5f8c42adf7",
      "description" : "createRecipient",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/recipients",
        "method" : "post",
        "name" : "postRequest",
        "operationName" : "createRecipient",
        "produces" : "application/json",
        "requestmethod" : "POST",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/recipients&method=post&operationName=createRecipient&produces=application/json&requestmethod=POST"
    }, {
      "name" : "convertBodyTo",
      "nodeId" : "3e91b59b-de96-4716-8c05-0af7c54640e2",
      "description" : "To String",
      "properties" : {
        "_type" : "convertBodyTo",
        "active" : true,
        "camelGroup" : "transform",
        "name" : "convertBodyTo",
        "targetClass" : "String.class",
        "url" : ""
      },
      "_type" : "convertBodyTo",
      "kameletPropertiesUrl" : "?targetClass=String.class"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "979f4f5d-986c-4612-979a-b0e5510d4cb5",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "c6fd8891-a86f-44ea-a45b-0b3537e697d8",
      "description" : "Validate Request",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n  .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}')\t\n        .stop()\n    .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n  .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}')\t\n        .stop()\n    .end()"
    }, {
      "name" : "log",
      "nodeId" : "90039d80-c31d-4dbd-9443-22a83e76f8b6",
      "description" : "208.api.create.in",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "INFO",
        "logType" : "EIP",
        "loggerName" : "208.api.create.in",
        "message" : "${body}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.create.in&message=${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "setProperties",
      "nodeId" : "7b95e2a5-2cf2-4bc6-9306-696ddc728bcd",
      "description" : "Get Request Params",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Header",
          "propertyName" : "agencyId",
          "propertyValue" : "x-agency-id",
          "uuid" : "8efe67ff-d32c-4ae1-9cc7-dd6663cc36c4"
        }, {
          "language" : "JsonPath",
          "propertyName" : "number",
          "propertyValue" : "$.number",
          "uuid" : "8a0613b8-caf1-4526-b46c-eafc9740aff3"
        }, {
          "language" : "JsonPath",
          "propertyName" : "label",
          "propertyValue" : "$.label",
          "uuid" : "9f8c7d33-aeb0-477a-95ff-28eb98e6164d"
        }, {
          "language" : "JsonPath",
          "propertyName" : "language",
          "propertyValue" : "$.language",
          "uuid" : "57f48089-0bcf-4898-8620-c9b918772977"
        }, {
          "language" : "JsonPath",
          "propertyName" : "fingerprint",
          "propertyValue" : "$.fingerprint",
          "uuid" : "32200c6e-0b3f-453d-b544-f7552ff44c97"
        }, {
          "language" : "JsonPath",
          "propertyName" : "source",
          "propertyValue" : "$.source",
          "uuid" : "7c961da6-3f18-4296-8bf7-31444cb56832"
        }, {
          "language" : "Simple",
          "propertyName" : "requestBody",
          "propertyValue" : "${body}",
          "uuid" : "aee38036-4c15-43ab-ad61-401a0d1ca8c4"
        } ],
        "suppressExceptions" : true,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?agencyId=x-agency-id&number=$.number&label=$.label&language=$.language&fingerprint=$.fingerprint&source=$.source&requestBody=${body}&addNamespaces=false&suppressExceptions=true"
    }, {
      "name" : "messageFilter",
      "nodeId" : "57c1ef4c-3e40-4e16-9726-737dfb8551e2",
      "description" : "",
      "properties" : {
        "_type" : "messageFilter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageFilter",
        "url" : ""
      },
      "_type" : "messageFilter",
      "branches" : [ {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "dslProcessor",
          "nodeId" : "740bb281-4eff-45f0-8342-21c21e9ef9bf",
          "description" : "Remove Headers",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".removeHeaders(\"*\", \"x-*\", \"Authorization\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-*\", \"Authorization\")"
        }, {
          "name" : "process",
          "nodeId" : "07bd7521-9fd0-4357-8d2f-3149b9bf655b",
          "description" : "Validate Prefix",
          "properties" : {
            "_type" : "process",
            "active" : true,
            "camelGroup" : "transform",
            "code" : "String number = (String)exchange.getProperty(\"number\");\n\nif (number != null) {\n\tnumber = number.replaceAll(\"[^\\\\d]\", \"\");\n\tif (number.length() == 10)\n\t\tnumber = \"1\" + number;\n\n\texchange.setProperty(\"number\", \"+\" + number);\n}\n\n/*\nString language = (String)exchange.getProperty(\"language\");\nif (language != null) {\n\tif (language.trim().equals(\"\"))\n\t\tlanguage = null;\n\telse\n\t\tlanguage = language;\n\t\n\texchange.setProperty(\"language\", language);\n}\n*/",
            "import" : "// import org.apache.camel.Message",
            "name" : "process",
            "url" : ""
          },
          "_type" : "process",
          "kameletPropertiesUrl" : "?code=String number = (String)exchange.getProperty(\"number\");\n\nif (number != null) {\n\tnumber = number.replaceAll(\"[^\\\\d]\", \"\");\n\tif (number.length() == 10)\n\t\tnumber = \"1\" + number;\n\n\texchange.setProperty(\"number\", \"+\" + number);\n}\n\n/*\nString language = (String)exchange.getProperty(\"language\");\nif (language != null) {\n\tif (language.trim().equals(\"\"))\n\t\tlanguage = null;\n\telse\n\t\tlanguage = language;\n\t\n\texchange.setProperty(\"language\", language);\n}\n*/&import=// import org.apache.camel.Message"
        }, {
          "name" : "direct",
          "nodeId" : "a8d4ab9f-e02f-4e7f-b226-a4b06049fe7f",
          "description" : "sql-get-recipient",
          "properties" : {
            "_type" : "direct",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "core",
            "endpointName" : "sql-get-recipient",
            "name" : "direct",
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "direct",
          "kameletPropertiesUrl" : "?endpointName=sql-get-recipient"
        }, {
          "name" : "messageFilter",
          "nodeId" : "6785a4d3-6126-40b4-81bc-54e895d7b13c",
          "description" : "Recip Exists?",
          "properties" : {
            "_type" : "messageFilter",
            "active" : true,
            "camelGroup" : "routing",
            "name" : "messageFilter",
            "url" : ""
          },
          "_type" : "messageFilter",
          "branches" : [ {
            "type" : "route",
            "label" : "route",
            "route" : [ {
              "name" : "dslProcessor",
              "nodeId" : "9946b06d-30fb-40f2-9ae5-59a790adecb2",
              "description" : "SQL Create Recipient",
              "properties" : {
                "_type" : "dslProcessor",
                "active" : true,
                "camelGroup" : "core",
                "dsl" : ".to(\"sql:classpath:recipients.insert.sql?dataSource=#dsPostgres\")",
                "name" : "dslProcessor",
                "url" : ""
              },
              "_type" : "dslProcessor",
              "kameletPropertiesUrl" : "?dsl=.to(\"sql:classpath:recipients.insert.sql?dataSource=#dsPostgres\")"
            }, {
              "name" : "messageRouter",
              "nodeId" : "8e8f34d5-1d76-4d24-a96e-d1be5370eb1c",
              "description" : "",
              "properties" : {
                "_type" : "messageRouter",
                "active" : true,
                "camelGroup" : "routing",
                "name" : "messageRouter",
                "url" : ""
              },
              "_type" : "messageRouter",
              "branches" : [ {
                "type" : "when",
                "label" : "new recip",
                "route" : [ {
                  "name" : "setHeaders",
                  "nodeId" : "c67e82f4-5fce-4aea-b791-8c4b1f4afcd1",
                  "description" : "HTTP201",
                  "properties" : {
                    "_type" : "setHeaders",
                    "active" : true,
                    "addNamespaces" : false,
                    "camelGroup" : "core",
                    "headerList" : [ {
                      "headerName" : "CamelHttpResponseCode",
                      "headerValue" : "201",
                      "language" : "Constant",
                      "uuid" : "d6d3c72b-cf1e-4665-b660-8fa62937d156"
                    } ],
                    "name" : "setHeaders",
                    "namespaces" : [ ],
                    "suppressExceptions" : false,
                    "url" : ""
                  },
                  "_type" : "setHeaders",
                  "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
                }, {
                  "name" : "log",
                  "nodeId" : "0bfbec4b-4b18-4997-962c-51baa52d1c19",
                  "description" : "208.api.recip",
                  "properties" : {
                    "_type" : "log",
                    "active" : true,
                    "advancedParameters" : [ ],
                    "camelGroup" : "component",
                    "level" : "INFO",
                    "logType" : "EIP",
                    "loggerName" : "208.api.recip",
                    "message" : "(201) ${body}",
                    "multiline" : false,
                    "name" : "log",
                    "showAll" : false,
                    "showBody" : true,
                    "showBodyType" : true,
                    "showCaughtException" : false,
                    "showExchangeId" : false,
                    "showHeaders" : false,
                    "showProperties" : false,
                    "showStackTrace" : false,
                    "toDynamicEndpoint" : false,
                    "url" : ""
                  },
                  "_type" : "log",
                  "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.recip&message=(201) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
                } ],
                "properties" : {
                  "addNamespaces" : "false",
                  "condition" : "${header.CamelSqlRowCount} >= 1 && ${body[0][created_at]} == ${body[0][updated_at]}",
                  "language" : "Simple",
                  "namespaces" : [ ],
                  "suppressExceptions" : "false"
                }
              }, {
                "type" : "when",
                "label" : "recip exists",
                "route" : [ {
                  "name" : "setHeaders",
                  "nodeId" : "b32253e1-0f2f-4196-88f7-693c9a6e663c",
                  "description" : "HTTP200",
                  "properties" : {
                    "_type" : "setHeaders",
                    "active" : true,
                    "addNamespaces" : false,
                    "camelGroup" : "core",
                    "headerList" : [ {
                      "headerName" : "CamelHttpResponseCode",
                      "headerValue" : "200",
                      "language" : "Constant",
                      "uuid" : "fdbf3320-5e54-430e-8d03-03a45139f576"
                    } ],
                    "name" : "setHeaders",
                    "namespaces" : [ ],
                    "suppressExceptions" : false,
                    "url" : ""
                  },
                  "_type" : "setHeaders",
                  "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
                }, {
                  "name" : "log",
                  "nodeId" : "c4ef9304-6e53-4dd7-bed1-652efcff44c1",
                  "description" : "208.api.recip",
                  "properties" : {
                    "_type" : "log",
                    "active" : true,
                    "advancedParameters" : [ ],
                    "camelGroup" : "component",
                    "level" : "INFO",
                    "logType" : "EIP",
                    "loggerName" : "208.api.recip",
                    "message" : "(200) body: ${body}",
                    "multiline" : false,
                    "name" : "log",
                    "showAll" : false,
                    "showBody" : true,
                    "showBodyType" : true,
                    "showCaughtException" : false,
                    "showExchangeId" : false,
                    "showHeaders" : false,
                    "showProperties" : false,
                    "showStackTrace" : false,
                    "toDynamicEndpoint" : false,
                    "url" : ""
                  },
                  "_type" : "log",
                  "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.recip&message=(200) body: ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
                } ],
                "properties" : {
                  "addNamespaces" : "false",
                  "condition" : "${header.CamelSqlRowCount} >= 1 && ${body[0][created_at]} != ${body[0][updated_at]}",
                  "language" : "Simple",
                  "namespaces" : [ ],
                  "suppressExceptions" : "false"
                }
              }, {
                "type" : "otherwise",
                "label" : "otherwise",
                "route" : [ {
                  "name" : "setProperties",
                  "nodeId" : "cda0d186-ee02-4d21-b608-ac3bd7ff2d8a",
                  "description" : "Set Error",
                  "properties" : {
                    "_type" : "setProperties",
                    "active" : true,
                    "addNamespaces" : false,
                    "camelGroup" : "core",
                    "name" : "setProperties",
                    "namespaces" : [ ],
                    "propertyList" : [ {
                      "language" : "Constant",
                      "propertyName" : "error",
                      "propertyValue" : "Failed to create recipient. Please try again.",
                      "uuid" : "8ecdc66e-4159-4315-97a5-c76204b10a11"
                    } ],
                    "suppressExceptions" : false,
                    "url" : ""
                  },
                  "_type" : "setProperties",
                  "kameletPropertiesUrl" : "?error=Failed to create recipient. Please try again.&addNamespaces=false&suppressExceptions=false"
                }, {
                  "name" : "dslProcessor",
                  "nodeId" : "ea4017e9-8598-4408-b03e-4b6be4233a13",
                  "description" : "Render Response",
                  "properties" : {
                    "_type" : "dslProcessor",
                    "active" : true,
                    "camelGroup" : "core",
                    "dsl" : ".bean(\"renderResponse\")",
                    "name" : "dslProcessor",
                    "url" : ""
                  },
                  "_type" : "dslProcessor",
                  "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
                }, {
                  "name" : "log",
                  "nodeId" : "74dd6456-00c0-4dd6-9422-81a2376009ca",
                  "description" : "208.api.recip",
                  "properties" : {
                    "_type" : "log",
                    "active" : true,
                    "advancedParameters" : [ ],
                    "camelGroup" : "component",
                    "level" : "WARN",
                    "logType" : "EIP",
                    "loggerName" : "208.api.recip",
                    "message" : "${body}",
                    "multiline" : false,
                    "name" : "log",
                    "showAll" : false,
                    "showBody" : true,
                    "showBodyType" : true,
                    "showCaughtException" : false,
                    "showExchangeId" : false,
                    "showHeaders" : false,
                    "showProperties" : false,
                    "showStackTrace" : false,
                    "toDynamicEndpoint" : false,
                    "url" : ""
                  },
                  "_type" : "log",
                  "kameletPropertiesUrl" : "?level=WARN&logType=EIP&loggerName=208.api.recip&message=${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
                }, {
                  "name" : "stop",
                  "nodeId" : "d86e22f1-5c04-4cae-8181-84124f0fde37",
                  "description" : "",
                  "properties" : {
                    "_type" : "stop",
                    "camelGroup" : "misc",
                    "name" : "stop",
                    "url" : ""
                  },
                  "_type" : "stop",
                  "kameletPropertiesUrl" : ""
                } ],
                "properties" : { }
              }, {
                "type" : "route",
                "label" : "route",
                "route" : [ {
                  "name" : "setProperties",
                  "nodeId" : "3d7ae485-7e92-48df-b7a9-b28b688c189a",
                  "description" : "Get Recipient ID",
                  "properties" : {
                    "_type" : "setProperties",
                    "active" : true,
                    "addNamespaces" : false,
                    "camelGroup" : "core",
                    "name" : "setProperties",
                    "namespaces" : [ ],
                    "propertyList" : [ {
                      "language" : "Simple",
                      "propertyName" : "recipientId",
                      "propertyValue" : "${body[0][recipient_id]}",
                      "uuid" : "51a93142-98e4-424b-8e80-58aa20983817"
                    }, {
                      "language" : "Simple",
                      "propertyName" : "numberOrId",
                      "propertyValue" : "${body[0][recipient_id]}",
                      "uuid" : "a77cc658-c058-435b-b782-ea2e56917325"
                    }, {
                      "language" : "Simple",
                      "propertyName" : "x-authorized",
                      "propertyValue" : "true",
                      "uuid" : "7f87de3c-9a76-43fb-9656-cba6ffb8537e"
                    } ],
                    "suppressExceptions" : false,
                    "url" : ""
                  },
                  "_type" : "setProperties",
                  "kameletPropertiesUrl" : "?recipientId=${body[0][recipient_id]}&numberOrId=${body[0][recipient_id]}&x-authorized=true&addNamespaces=false&suppressExceptions=false"
                }, {
                  "name" : "direct",
                  "nodeId" : "38ed1a9d-9a3a-4ec0-9711-a0411792b133",
                  "description" : "getRecipientById",
                  "properties" : {
                    "_type" : "direct",
                    "active" : true,
                    "advancedParameters" : [ ],
                    "camelGroup" : "core",
                    "endpointName" : "getRecipientByNumberOrId",
                    "name" : "direct",
                    "toDynamicEndpoint" : false,
                    "url" : ""
                  },
                  "_type" : "direct",
                  "kameletPropertiesUrl" : "?endpointName=getRecipientByNumberOrId"
                }, {
                  "name" : "setBody",
                  "nodeId" : "ee9bad1d-29cd-42a3-92fe-8e844e0b29ef",
                  "description" : "Set Response",
                  "properties" : {
                    "_type" : "setBody",
                    "active" : true,
                    "addNamespaces" : false,
                    "camelGroup" : "core",
                    "expression" : "$.data",
                    "language" : "JsonPath",
                    "name" : "setBody",
                    "namespaces" : [ ],
                    "suppressExceptions" : false,
                    "url" : ""
                  },
                  "_type" : "setBody",
                  "kameletPropertiesUrl" : "?addNamespaces=false&expression=$.data&language=JsonPath&suppressExceptions=false"
                }, {
                  "name" : "dslProcessor",
                  "nodeId" : "4793f21c-944a-449a-97b6-f6780f789057",
                  "description" : "Render Response",
                  "properties" : {
                    "_type" : "dslProcessor",
                    "active" : true,
                    "camelGroup" : "core",
                    "dsl" : ".bean(\"renderResponse\")",
                    "name" : "dslProcessor",
                    "url" : ""
                  },
                  "_type" : "dslProcessor",
                  "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
                }, {
                  "name" : "log",
                  "nodeId" : "26b2f093-1fc5-4c9f-bf43-e48860502884",
                  "description" : "208.api.recip.out",
                  "properties" : {
                    "_type" : "log",
                    "active" : true,
                    "advancedParameters" : [ ],
                    "camelGroup" : "component",
                    "level" : "INFO",
                    "logType" : "EIP",
                    "loggerName" : "208.api.recip.out",
                    "message" : "(${header.CamelHttpResponseCode}) ${body}",
                    "multiline" : false,
                    "name" : "log",
                    "showAll" : false,
                    "showBody" : true,
                    "showBodyType" : true,
                    "showCaughtException" : false,
                    "showExchangeId" : false,
                    "showHeaders" : false,
                    "showProperties" : false,
                    "showStackTrace" : false,
                    "toDynamicEndpoint" : false,
                    "url" : ""
                  },
                  "_type" : "log",
                  "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.recip.out&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
                }, {
                  "name" : "seda",
                  "nodeId" : "47359ecd-42ce-47b1-8378-63ecf6d6e1b5",
                  "description" : "enqueue-event",
                  "properties" : {
                    "_type" : "seda",
                    "active" : true,
                    "advancedParameters" : [ ],
                    "blockWhenFull" : false,
                    "camelGroup" : "core",
                    "concurrentConsumers" : "1",
                    "endpointName" : "enqueue-event",
                    "limitConcurrentConsumers" : true,
                    "multipleConsumers" : false,
                    "name" : "seda",
                    "pollTimeout" : "1000",
                    "size" : "1000",
                    "specifyMaximumCapacitySize" : false,
                    "timeout" : "30000",
                    "toDynamicEndpoint" : false,
                    "url" : "",
                    "waitForTaskToComplete" : "Never"
                  },
                  "_type" : "seda",
                  "kameletPropertiesUrl" : "?blockWhenFull=false&concurrentConsumers=1&endpointName=enqueue-event&limitConcurrentConsumers=true&multipleConsumers=false&pollTimeout=1000&size=1000&specifyMaximumCapacitySize=false&timeout=30000&waitForTaskToComplete=Never"
                } ],
                "properties" : { }
              } ],
              "kameletPropertiesUrl" : ""
            } ],
            "properties" : { }
          }, {
            "type" : "filter",
            "label" : "recipientId != null",
            "route" : [ {
              "name" : "messagingEndpoint",
              "nodeId" : "f1291cf9-cdf9-46fa-ac6f-42c6128b6479",
              "description" : "SQL Update Recip",
              "properties" : {
                "_type" : "messagingEndpoint",
                "active" : false,
                "camelGroup" : "core",
                "name" : "messagingEndpoint",
                "toDynamicEndpoint" : false,
                "uri" : "sql:UPDATE recipients SET recipient_number = COALESCE(:#${exchangeProperty.number}, recipient_number), COALESCE(:#${exchangeProperty.fingerprint}, fingerprint), language = COALESCE(:#${exchangeProperty.recipientLanguage}, language), friendly_name = COALESCE(:#${exchangeProperty.label}, friendly_name), updated_at = NOW() WHERE id = CAST(:#${exchangeProperty.recipientId} AS uuid) AND agency_id = CAST(:#${exchangeProperty.agencyId} AS uuid)?dataSource=#dsPostgres",
                "url" : ""
              },
              "_type" : "messagingEndpoint",
              "kameletPropertiesUrl" : "?uri=sql:UPDATE recipients SET recipient_number = COALESCE(:#${exchangeProperty.number}, recipient_number), COALESCE(:#${exchangeProperty.fingerprint}, fingerprint), language = COALESCE(:#${exchangeProperty.recipientLanguage}, language), friendly_name = COALESCE(:#${exchangeProperty.label}, friendly_name), updated_at = NOW() WHERE id = CAST(:#${exchangeProperty.recipientId} AS uuid) AND agency_id = CAST(:#${exchangeProperty.agencyId} AS uuid)?dataSource=#dsPostgres"
            }, {
              "name" : "setBody",
              "nodeId" : "fbaca51e-f790-497e-b04a-4ec0327af007",
              "description" : "Restore Body",
              "properties" : {
                "_type" : "setBody",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "expression" : "${exchangeProperty.requestBody}",
                "language" : "Simple",
                "name" : "setBody",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setBody",
              "kameletPropertiesUrl" : "?addNamespaces=false&expression=${exchangeProperty.requestBody}&language=Simple&suppressExceptions=false"
            }, {
              "name" : "setHeaders",
              "nodeId" : "b93be7bd-7fcf-4029-a521-1208ae4e4df0",
              "description" : "Set Recipient ID",
              "properties" : {
                "_type" : "setHeaders",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "headerList" : [ {
                  "headerName" : "numberOrId",
                  "headerValue" : "${exchangeProperty.recipientId}",
                  "language" : "Simple",
                  "uuid" : "70006415-6744-4b17-b330-4305b2d8e71b"
                } ],
                "name" : "setHeaders",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setHeaders",
              "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "direct",
              "nodeId" : "97c7d7cd-64b9-4597-8a78-4b5333a3d4ed",
              "description" : "to:getRecipient",
              "properties" : {
                "_type" : "direct",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "core",
                "endpointName" : "getRecipientByNumberOrId",
                "name" : "direct",
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "direct",
              "kameletPropertiesUrl" : "?endpointName=getRecipientByNumberOrId"
            }, {
              "name" : "setBody",
              "nodeId" : "76584f27-b953-4c63-a706-651ac070a4c9",
              "description" : "Set Response",
              "properties" : {
                "_type" : "setBody",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "expression" : "$.data",
                "language" : "JsonPath",
                "name" : "setBody",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setBody",
              "kameletPropertiesUrl" : "?addNamespaces=false&expression=$.data&language=JsonPath&suppressExceptions=false"
            }, {
              "name" : "dslProcessor",
              "nodeId" : "d3804ead-e6c8-4f58-b903-603d9794dfe9",
              "description" : "Render Response",
              "properties" : {
                "_type" : "dslProcessor",
                "active" : true,
                "camelGroup" : "core",
                "dsl" : ".bean('renderResponse')",
                "name" : "dslProcessor",
                "url" : ""
              },
              "_type" : "dslProcessor",
              "kameletPropertiesUrl" : "?dsl=.bean('renderResponse')"
            }, {
              "name" : "log",
              "nodeId" : "d747d405-6f46-42c2-8397-b43eeb3edf7b",
              "description" : "208.api.recip.out",
              "properties" : {
                "_type" : "log",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "component",
                "level" : "INFO",
                "logType" : "EIP",
                "loggerName" : "208.api.recip.out",
                "message" : "(${header.CamelHttpResponseCode}) ${body}",
                "multiline" : false,
                "name" : "log",
                "showAll" : false,
                "showBody" : true,
                "showBodyType" : true,
                "showCaughtException" : false,
                "showExchangeId" : false,
                "showHeaders" : false,
                "showProperties" : false,
                "showStackTrace" : false,
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "log",
              "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.recip.out&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
            }, {
              "name" : "stop",
              "nodeId" : "7ab6fe17-19bd-4082-ba4b-7153e222f999",
              "description" : "",
              "properties" : {
                "_type" : "stop",
                "camelGroup" : "misc",
                "name" : "stop",
                "url" : ""
              },
              "_type" : "stop",
              "kameletPropertiesUrl" : ""
            } ],
            "properties" : {
              "addNamespaces" : "false",
              "condition" : "${exchangeProperty.recipientId} != null",
              "language" : "Simple",
              "namespaces" : [ ],
              "suppressExceptions" : "false"
            }
          } ],
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : { }
      }, {
        "type" : "filter",
        "label" : "!number && !fingerprint",
        "route" : [ {
          "name" : "setProperties",
          "nodeId" : "8e189a2c-6faf-4184-b332-4eb8337d315a",
          "description" : "HTTP400",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Constant",
              "propertyName" : "CamelHttpResponseCode",
              "propertyValue" : "400",
              "uuid" : "711827d9-571a-48ee-b01c-aab06a3b58bd"
            }, {
              "language" : "Constant",
              "propertyName" : "error",
              "propertyValue" : "Must specify one of: number, fingerprint",
              "uuid" : "b9395dc8-a8ca-4b24-b46a-e34d9e3241c0"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?CamelHttpResponseCode=400&error=Must specify one of: number, fingerprint&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "b9853308-2f31-4955-be48-764c68420b10",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean('renderResponse')",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean('renderResponse')"
        }, {
          "name" : "log",
          "nodeId" : "ab05fb52-56f3-47f3-ae33-3e57924f0ae6",
          "description" : "208.api.create.400",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "208.api.create.400",
            "message" : "(${header.CamelHttpResponseCode}) ${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.create.400&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "stop",
          "nodeId" : "20341077-57fd-4fbf-bb0a-b9780338868f",
          "description" : "",
          "properties" : {
            "_type" : "stop",
            "camelGroup" : "misc",
            "name" : "stop",
            "url" : ""
          },
          "_type" : "stop",
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${exchangeProperty.number} == null && ${exchangeProperty.fingerprint} == null",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-2",
    "enabled" : true,
    "routeId" : 2,
    "route" : [ {
      "name" : "getRequest",
      "nodeId" : "29a354ae-6766-400a-b8ce-895a066f322c",
      "description" : "getRecipients",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/recipients",
        "method" : "get",
        "name" : "getRequest",
        "operationName" : "getRecipients",
        "produces" : "application/json",
        "requestmethod" : "GET",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/recipients&method=get&operationName=getRecipients&produces=application/json&requestmethod=GET"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "3453864d-c908-4859-ae6f-9372c86f2a31",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n    .filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n    .filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "676c5f02-169d-4223-91a0-a044234ccad6",
      "description" : "Validate Request",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n  .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}')\t\n        .stop()\n    .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n  .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}')\t\n        .stop()\n    .end()"
    }, {
      "name" : "setProperties",
      "nodeId" : "8b286536-7d8a-44f6-9059-39c3588db549",
      "description" : "Set Request Props",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Header",
          "propertyName" : "agencyId",
          "propertyValue" : "x-agency-id",
          "uuid" : "a37ed0b4-5e92-404d-82e1-93218960ac23"
        } ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?agencyId=x-agency-id&addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "1500b77b-ebd3-434d-954e-7febe290a9bf",
      "description" : "SQL Get Recipients",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"velocity:recipients.select.sql.vm?allowContextMapAll=true\")\n\t.log(LoggingLevel.OFF, 'log', '${body}')\n        \t.to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectList&useMessageBodyForSql=true\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"velocity:recipients.select.sql.vm?allowContextMapAll=true\")\n\t.log(LoggingLevel.OFF, 'log', '${body}')\n        \t.to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectList&useMessageBodyForSql=true\")"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "34f04638-47b7-4008-8562-5ff26e306378",
      "description" : "Render Response",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean(\"renderResponse\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-3",
    "enabled" : true,
    "routeId" : 3,
    "route" : [ {
      "name" : "onException",
      "nodeId" : "84f692b1-ab0f-4d3a-a405-2ab8ad49ef6c",
      "description" : "",
      "properties" : {
        "_type" : "onException",
        "active" : true,
        "asyncDelayedRedelivery" : false,
        "camelGroup" : "exception",
        "exceptionBehavior" : "Handle the exceptions",
        "exceptionList" : [ {
          "exception" : "Exception"
        } ],
        "maximumRedeliveries" : "2",
        "name" : "onException",
        "redeliveryDelay" : "1000",
        "setRedeliveryDelay" : false,
        "setRedeliveryTriesCount" : false,
        "url" : "",
        "useOriginalMessage" : false
      },
      "_type" : "onException",
      "branches" : [ {
        "type" : "onException",
        "label" : "onException",
        "route" : [ {
          "name" : "log",
          "nodeId" : "174b9054-605a-428f-8b08-ae2c2aebd7f6",
          "description" : "208.error",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "ERROR",
            "logType" : "EIP",
            "loggerName" : "208.error",
            "message" : "${exception.stacktrace}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=ERROR&logType=EIP&loggerName=208.error&message=${exception.stacktrace}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "setHeaders",
          "nodeId" : "f5b1ecee-450f-4b24-afab-702089c5314d",
          "description" : "HTTP500",
          "properties" : {
            "_type" : "setHeaders",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "headerList" : [ {
              "headerName" : "CamelHttpResponseCode",
              "headerValue" : "500",
              "language" : "Constant",
              "uuid" : "70d6472c-3bb3-4411-b2a0-a0e9d8d4703f"
            } ],
            "name" : "setHeaders",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setHeaders",
          "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "setProperties",
          "nodeId" : "395dde14-b64a-4cd6-bb5b-6e7aafad50ca",
          "description" : "Set Error",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Constant",
              "propertyName" : "error",
              "propertyValue" : "An error occurred processing request. Please try again.",
              "uuid" : "d3dab9cb-bd74-4767-bddd-2d1d6e0aa9fa"
            }, {
              "language" : "Header",
              "propertyName" : "CamelHttpResponseCode",
              "propertyValue" : "CamelHttpResponseCode",
              "uuid" : "fc733412-d6ad-4400-9fd8-89cb06db09fb"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?error=An error occurred processing request. Please try again.&CamelHttpResponseCode=CamelHttpResponseCode&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "afc86bdb-485b-4b9c-8f72-1d2c4372dbfa",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean(\"renderResponse\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
        }, {
          "name" : "stop",
          "nodeId" : "a371be27-ffc0-4869-88be-f34d933d00e7",
          "description" : "",
          "properties" : {
            "_type" : "stop",
            "camelGroup" : "misc",
            "name" : "stop",
            "url" : ""
          },
          "_type" : "stop",
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : { }
      } ],
      "kameletPropertiesUrl" : "?asyncDelayedRedelivery=false&exceptionBehavior=Handle the exceptions&maximumRedeliveries=2&redeliveryDelay=1000&setRedeliveryDelay=false&setRedeliveryTriesCount=false&useOriginalMessage=false"
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-4",
    "enabled" : true,
    "routeId" : 4,
    "route" : [ {
      "name" : "getRequest",
      "nodeId" : "59a2405a-e569-4d96-97c0-f884ebaeb27e",
      "description" : "getRecipientByNumberOrId",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/recipients/{numberOrId}",
        "method" : "get",
        "name" : "getRequest",
        "operationName" : "getRecipientByNumberOrId",
        "produces" : "application/json",
        "requestmethod" : "GET",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/recipients/{numberOrId}&method=get&operationName=getRecipientByNumberOrId&produces=application/json&requestmethod=GET"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "556ce4c0-faf6-418f-86bb-3a82474e13be",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n    .filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n    .filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "5f1ed0e9-cef5-44bd-a9b8-945e3bd78f45",
      "description" : "Validate Request",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n  .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}')\t\n        .stop()\n    .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n  .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}')\t\n        .stop()\n    .end()"
    }, {
      "name" : "setProperties",
      "nodeId" : "915854ed-ef1d-433c-9cfa-a2d4e4a0684e",
      "description" : "Set Request Props",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Header",
          "propertyName" : "recipientNumberOrId",
          "propertyValue" : "numberOrId",
          "uuid" : "4236d328-83a7-44c2-8392-9d2a93faef39"
        }, {
          "language" : "Header",
          "propertyName" : "agencyId",
          "propertyValue" : "x-agency-id",
          "uuid" : "c4599d59-40e3-46c4-89d5-e4b07999ea48"
        } ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?recipientNumberOrId=numberOrId&agencyId=x-agency-id&addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "process",
      "nodeId" : "21cd1d9f-776f-4118-8c13-439288e94eac",
      "description" : "Validate Prefix",
      "properties" : {
        "_type" : "process",
        "active" : true,
        "camelGroup" : "transform",
        "code" : "String recipientNumberOrId = (String)exchange.getProperty(\"recipientNumberOrId\");\n\nif (recipientNumberOrId.length() == 36)\n\texchange.setProperty(\"recipientId\", recipientNumberOrId);\nelse if (recipientNumberOrId.length() == 10 || recipientNumberOrId.startsWith(\"+\")) {\n\tString recipientNumber = recipientNumberOrId.replaceAll(\"-\", \"\");\n\tif (!(recipientNumberOrId.startsWith(\"+\"))) \n\t\trecipientNumber = \"+\" + (recipientNumber.length() == 10 ? \"1\" : \"\") + recipientNumber;\n\t\n\texchange.setProperty(\"recipientNumber\", recipientNumber);\n} \nelse \n\texchange.setProperty(\"fingerprint\", recipientNumberOrId);",
        "import" : "// import org.apache.camel.Message",
        "name" : "process",
        "url" : ""
      },
      "_type" : "process",
      "kameletPropertiesUrl" : "?code=String recipientNumberOrId = (String)exchange.getProperty(\"recipientNumberOrId\");\n\nif (recipientNumberOrId.length() == 36)\n\texchange.setProperty(\"recipientId\", recipientNumberOrId);\nelse if (recipientNumberOrId.length() == 10 || recipientNumberOrId.startsWith(\"+\")) {\n\tString recipientNumber = recipientNumberOrId.replaceAll(\"-\", \"\");\n\tif (!(recipientNumberOrId.startsWith(\"+\"))) \n\t\trecipientNumber = \"+\" + (recipientNumber.length() == 10 ? \"1\" : \"\") + recipientNumber;\n\t\n\texchange.setProperty(\"recipientNumber\", recipientNumber);\n} \nelse \n\texchange.setProperty(\"fingerprint\", recipientNumberOrId);&import=// import org.apache.camel.Message"
    }, {
      "name" : "direct",
      "nodeId" : "9d380223-f008-4dce-a3b0-8e727dc8c84d",
      "description" : "sql-get-recipient",
      "properties" : {
        "_type" : "direct",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "core",
        "endpointName" : "sql-get-recipient",
        "name" : "direct",
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "direct",
      "kameletPropertiesUrl" : "?endpointName=sql-get-recipient"
    }, {
      "name" : "messageFilter",
      "nodeId" : "0984b4bc-088d-448f-b9ce-2de164afce58",
      "description" : "Not Found",
      "properties" : {
        "_type" : "messageFilter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageFilter",
        "url" : ""
      },
      "_type" : "messageFilter",
      "branches" : [ {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "dslProcessor",
          "nodeId" : "1b2e607f-1096-40e7-aeb2-395ac31149d5",
          "description" : "SQL Get Geolocation",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".to(\"velocity:geolocations.select.sql.vm?allowContextMapAll=true\")\n\t.log(LoggingLevel.OFF, 'log', '${body}')\n        \t.to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectList&useMessageBodyForSql=true\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.to(\"velocity:geolocations.select.sql.vm?allowContextMapAll=true\")\n\t.log(LoggingLevel.OFF, 'log', '${body}')\n        \t.to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectList&useMessageBodyForSql=true\")"
        }, {
          "name" : "process",
          "nodeId" : "726b7162-8b9d-43ed-89c5-b2c0f09cd62c",
          "description" : "Format Response",
          "properties" : {
            "_type" : "process",
            "active" : true,
            "camelGroup" : "transform",
            "code" : "HashMap<String, Object> recipient = (HashMap)exchange.getProperty(\"recipient\");\nArrayList<HashMap<String, Object>> geolocations = (ArrayList)exchange.getIn().getBody();\nHashMap<String, Object> latestGeolocation = null;\n\nif (geolocations.size() > 0) \n\tlatestGeolocation = (HashMap)geolocations.get(0);\n\nrecipient.put(\"latest_geolocation\", latestGeolocation);\nexchange.getIn().setBody(recipient);",
            "import" : "",
            "name" : "process",
            "url" : ""
          },
          "_type" : "process",
          "kameletPropertiesUrl" : "?code=HashMap<String, Object> recipient = (HashMap)exchange.getProperty(\"recipient\");\nArrayList<HashMap<String, Object>> geolocations = (ArrayList)exchange.getIn().getBody();\nHashMap<String, Object> latestGeolocation = null;\n\nif (geolocations.size() > 0) \n\tlatestGeolocation = (HashMap)geolocations.get(0);\n\nrecipient.put(\"latest_geolocation\", latestGeolocation);\nexchange.getIn().setBody(recipient);"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "39ede2e3-2651-486b-9ca9-fb309f3373a3",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean(\"renderResponse\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
        } ],
        "properties" : { }
      }, {
        "type" : "filter",
        "label" : "filter",
        "route" : [ {
          "name" : "log",
          "nodeId" : "1b139a22-e728-47c0-9aa2-afc28b3d3534",
          "description" : "208.api.get.404",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "208.api.get.404",
            "message" : "Recipient not found",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.get.404&message=Recipient not found&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "setHeaders",
          "nodeId" : "d0c9a475-d0b2-4caa-b23e-b79c92aa90b5",
          "description" : "HTTP404",
          "properties" : {
            "_type" : "setHeaders",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "headerList" : [ {
              "headerName" : "CamelHttpResponseCode",
              "headerValue" : "404",
              "language" : "Constant",
              "uuid" : "3b2b020a-8a7a-41c2-9bd2-91f2742f3403"
            } ],
            "name" : "setHeaders",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setHeaders",
          "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "clearBody",
          "nodeId" : "8772bcdd-c6ef-4939-bb50-edad0ac6829a",
          "description" : "",
          "properties" : {
            "_type" : "clearBody",
            "camelGroup" : "core",
            "name" : "clearBody",
            "url" : ""
          },
          "_type" : "clearBody",
          "kameletPropertiesUrl" : ""
        }, {
          "name" : "stop",
          "nodeId" : "8ce9cc5e-bf4f-416c-901c-425b4aa2e91d",
          "description" : "",
          "properties" : {
            "_type" : "stop",
            "camelGroup" : "misc",
            "name" : "stop",
            "url" : ""
          },
          "_type" : "stop",
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${exchangeProperty.recipient} == null",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-5",
    "enabled" : true,
    "routeId" : 5,
    "route" : [ {
      "name" : "postRequest",
      "nodeId" : "e9cff77c-2103-40fb-8d0e-7653e48fd490",
      "description" : "importRecipient",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/recipients/import",
        "method" : "post",
        "name" : "postRequest",
        "operationName" : "importRecipient",
        "produces" : "application/json",
        "requestmethod" : "POST",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/recipients/import&method=post&operationName=importRecipient&produces=application/json&requestmethod=POST"
    }, {
      "name" : "convertBodyTo",
      "nodeId" : "5adf9fbf-8a20-4ac6-b29f-d719b2fbcd09",
      "description" : "To String",
      "properties" : {
        "_type" : "convertBodyTo",
        "active" : true,
        "camelGroup" : "transform",
        "name" : "convertBodyTo",
        "targetClass" : "String.class",
        "url" : ""
      },
      "_type" : "convertBodyTo",
      "kameletPropertiesUrl" : "?targetClass=String.class"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "fd8dcce3-188b-4c4f-b572-21172180b105",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "log",
      "nodeId" : "00e0ee5b-3e5c-4e80-a11f-f83a67066ae3",
      "description" : "208.api.import.in",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "INFO",
        "logType" : "EIP",
        "loggerName" : "208.api.import.in",
        "message" : "${body}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.import.in&message=${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "setProperties",
      "nodeId" : "afa82975-417a-4f57-860f-94f985a57e44",
      "description" : "Set Request Props",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "JsonPath",
          "propertyName" : "providerToken",
          "propertyValue" : "$.provider_token",
          "uuid" : "ffe2b640-0dda-4c44-bb1d-a10e0cac3305"
        }, {
          "language" : "Header",
          "propertyName" : "agencyId",
          "propertyValue" : "x-agency-id",
          "uuid" : "e9d1740a-0161-46fd-bc64-c4749d32a02b"
        } ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?providerToken=$.provider_token&agencyId=x-agency-id&addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "322e7224-c54e-4e40-8bc0-c31a3b99c644",
      "description" : "Remove Headers",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".removeHeaders(\"*\", \"x-*\", \"Authorization\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-*\", \"Authorization\")"
    }, {
      "name" : "messageFilter",
      "nodeId" : "6e81838c-41a1-492b-af81-5b573d7b3e8c",
      "description" : "",
      "properties" : {
        "_type" : "messageFilter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageFilter",
        "url" : ""
      },
      "_type" : "messageFilter",
      "branches" : [ {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "setHeaders",
          "nodeId" : "3c719c94-39d0-4cf8-bf0f-976cd0922c9a",
          "description" : "Set Request Operation",
          "properties" : {
            "_type" : "setHeaders",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "headerList" : [ {
              "headerName" : "x-requested-operation",
              "headerValue" : "getRsosTokenData",
              "language" : "Constant",
              "uuid" : "fa3f5bf1-2e6c-49df-b638-711db5265732"
            } ],
            "name" : "setHeaders",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setHeaders",
          "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "setBody",
          "nodeId" : "bc460a15-e0ad-445b-8b3a-dc1e3cf6ab31",
          "description" : "Set Provider Token",
          "properties" : {
            "_type" : "setBody",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "expression" : "${exchangeProperty.providerToken}",
            "language" : "Simple",
            "name" : "setBody",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setBody",
          "kameletPropertiesUrl" : "?addNamespaces=false&expression=${exchangeProperty.providerToken}&language=Simple&suppressExceptions=false"
        }, {
          "name" : "direct",
          "nodeId" : "7a9ada86-c4f1-4051-a92d-15345f5ecc2c",
          "description" : "import-rapidsos-recip",
          "properties" : {
            "_type" : "direct",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "core",
            "endpointName" : "import-rapidsos-recip",
            "name" : "direct",
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "direct",
          "kameletPropertiesUrl" : "?endpointName=import-rapidsos-recip"
        }, {
          "name" : "messageFilter",
          "nodeId" : "bf0e28d5-0c18-400d-8458-32095c8e4dbe",
          "description" : "200 OK",
          "properties" : {
            "_type" : "messageFilter",
            "active" : true,
            "camelGroup" : "routing",
            "name" : "messageFilter",
            "url" : ""
          },
          "_type" : "messageFilter",
          "branches" : [ {
            "type" : "route",
            "label" : "route",
            "route" : [ {
              "name" : "dslProcessor",
              "nodeId" : "5c5d3912-7464-44cf-a70b-37fbee912028",
              "description" : "Render Response",
              "properties" : {
                "_type" : "dslProcessor",
                "active" : true,
                "camelGroup" : "core",
                "dsl" : ".bean(\"renderResponse\")",
                "name" : "dslProcessor",
                "url" : ""
              },
              "_type" : "dslProcessor",
              "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
            }, {
              "name" : "log",
              "nodeId" : "db4e726f-7651-4234-953e-8c017d6f1317",
              "description" : "",
              "properties" : {
                "_type" : "log",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "component",
                "level" : "INFO",
                "logType" : "EIP",
                "loggerName" : "208.api.import.out",
                "message" : "(${header.CamelHttpResponseCode}) ${body}",
                "multiline" : false,
                "name" : "log",
                "showAll" : false,
                "showBody" : true,
                "showBodyType" : true,
                "showCaughtException" : false,
                "showExchangeId" : false,
                "showHeaders" : false,
                "showProperties" : false,
                "showStackTrace" : false,
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "log",
              "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.import.out&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
            } ],
            "properties" : { }
          }, {
            "type" : "filter",
            "label" : "filter",
            "route" : [ {
              "name" : "setProperties",
              "nodeId" : "4a56da00-4c1a-4aa4-a581-3626ce51e968",
              "description" : "Get Token Params",
              "properties" : {
                "_type" : "setProperties",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "name" : "setProperties",
                "namespaces" : [ ],
                "propertyList" : [ {
                  "language" : "JsonPath",
                  "propertyName" : "queryResult",
                  "propertyValue" : "$.query",
                  "uuid" : "9bc1561f-9590-403d-838d-01711384f4a3"
                }, {
                  "language" : "JsonPath",
                  "propertyName" : "providerAccountId",
                  "propertyValue" : "$.ecc_account_id",
                  "uuid" : "24ddcf85-1780-4df4-af03-d0d8b06de088"
                }, {
                  "language" : "JsonPath",
                  "propertyName" : "providerAccessToken",
                  "propertyValue" : "$.access_token",
                  "uuid" : "de65ac1d-1087-4011-ab90-64279f40b00b"
                }, {
                  "language" : "Simple",
                  "propertyName" : "x-authorized",
                  "propertyValue" : "true",
                  "uuid" : "7f2f7073-80d4-467e-8f1a-58bef1537ab2"
                }, {
                  "language" : "JsonPath",
                  "propertyName" : "geoLat",
                  "propertyValue" : "$.incident_location.latitude",
                  "uuid" : "4276f3cc-0a4f-45da-b3a4-465bd2bb18be"
                }, {
                  "language" : "JsonPath",
                  "propertyName" : "geoLng",
                  "propertyValue" : "$.incident_location.longitude",
                  "uuid" : "b155b959-4908-499a-9dd7-625c00828065"
                }, {
                  "language" : "JsonPath",
                  "propertyName" : "boundingBox",
                  "propertyValue" : "$.bounding_box",
                  "uuid" : "ab1d53e1-984c-40da-beaf-e5290f143183"
                }, {
                  "language" : "Simple",
                  "propertyName" : "tokenResponse",
                  "propertyValue" : "${body}",
                  "uuid" : "7fea5603-9347-4d23-add8-190246bb1d4d"
                }, {
                  "language" : "Header",
                  "propertyName" : "tokenResponseCode",
                  "propertyValue" : "CamelHttpResponseCode",
                  "uuid" : "609e1ff5-ec4a-418a-9938-edce7b18d2b3"
                } ],
                "suppressExceptions" : true,
                "url" : ""
              },
              "_type" : "setProperties",
              "kameletPropertiesUrl" : "?queryResult=$.query&providerAccountId=$.ecc_account_id&providerAccessToken=$.access_token&x-authorized=true&geoLat=$.incident_location.latitude&geoLng=$.incident_location.longitude&boundingBox=$.bounding_box&tokenResponse=${body}&tokenResponseCode=CamelHttpResponseCode&addNamespaces=false&suppressExceptions=true"
            }, {
              "name" : "process",
              "nodeId" : "591956ba-a1a4-4fe5-bcdd-0eb5007623c6",
              "description" : "Format Number",
              "properties" : {
                "_type" : "process",
                "active" : true,
                "camelGroup" : "transform",
                "code" : "String recipientNumber = (String)exchange.getProperty(\"queryResult\");\nif (recipientNumber != null) {\n\trecipientNumber = recipientNumber.replaceAll(\"[^\\\\d]\", \"\");\n\texchange.setProperty(\"recipientNumber\", recipientNumber);\n}",
                "import" : "import com.fasterxml.jackson.databind.ObjectMapper;",
                "name" : "process",
                "url" : ""
              },
              "_type" : "process",
              "kameletPropertiesUrl" : "?code=String recipientNumber = (String)exchange.getProperty(\"queryResult\");\nif (recipientNumber != null) {\n\trecipientNumber = recipientNumber.replaceAll(\"[^\\\\d]\", \"\");\n\texchange.setProperty(\"recipientNumber\", recipientNumber);\n}&import=import com.fasterxml.jackson.databind.ObjectMapper;"
            }, {
              "name" : "setBody",
              "nodeId" : "0b0f5b9e-fcdc-4314-a719-a6530980c39b",
              "description" : "Set Request Body",
              "properties" : {
                "_type" : "setBody",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "expression" : "{\"number\": \"${exchangeProperty.recipientNumber}\"}",
                "language" : "Simple",
                "name" : "setBody",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setBody",
              "kameletPropertiesUrl" : "?addNamespaces=false&expression={\"number\": \"${exchangeProperty.recipientNumber}\"}&language=Simple&suppressExceptions=false"
            }, {
              "name" : "direct",
              "nodeId" : "7df57f01-c62c-45cc-9ef8-8f92823bbef2",
              "description" : "createRecipient",
              "properties" : {
                "_type" : "direct",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "core",
                "endpointName" : "createRecipient",
                "name" : "direct",
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "direct",
              "kameletPropertiesUrl" : "?endpointName=createRecipient"
            }, {
              "name" : "setProperties",
              "nodeId" : "e3b9891c-f8bd-42b1-91e8-ea510f708834",
              "description" : "Get Recipient ID",
              "properties" : {
                "_type" : "setProperties",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "name" : "setProperties",
                "namespaces" : [ ],
                "propertyList" : [ {
                  "language" : "JsonPath",
                  "propertyName" : "recipientId",
                  "propertyValue" : "$.data.recipient_id",
                  "uuid" : "bfa97434-b28a-4b08-a2fd-94f8a3f86e31"
                }, {
                  "language" : "JsonPath",
                  "propertyName" : "recipientJsonResp",
                  "propertyValue" : "$.data",
                  "uuid" : "62a3b64f-cdf4-43cc-882c-2028ec5fa9ae"
                }, {
                  "language" : "Simple",
                  "propertyName" : "x-authorized",
                  "propertyValue" : "true",
                  "uuid" : "9eaef45a-1f52-42f4-a99c-1a62596fd159"
                } ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setProperties",
              "kameletPropertiesUrl" : "?recipientId=$.data.recipient_id&recipientJsonResp=$.data&x-authorized=true&addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "direct",
              "nodeId" : "0c972865-857b-447e-afb8-050bd34e2df1",
              "description" : "sql-update-token",
              "properties" : {
                "_type" : "direct",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "core",
                "endpointName" : "sql-update-token",
                "name" : "direct",
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "direct",
              "kameletPropertiesUrl" : "?endpointName=sql-update-token"
            }, {
              "name" : "setBody",
              "nodeId" : "774b0260-6461-4259-9764-106664a1ea7a",
              "description" : "Set Geo Request",
              "properties" : {
                "_type" : "setBody",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "expression" : "{\"lat\": ${exchangeProperty.geoLat}, \"lng\": ${exchangeProperty.geoLng}}",
                "language" : "Simple",
                "name" : "setBody",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setBody",
              "kameletPropertiesUrl" : "?addNamespaces=false&expression={\"lat\": ${exchangeProperty.geoLat}, \"lng\": ${exchangeProperty.geoLng}}&language=Simple&suppressExceptions=false"
            }, {
              "name" : "setHeaders",
              "nodeId" : "0f924f70-bacf-4d28-ae52-6539d5a3f07c",
              "description" : "Set Geo Request Headers",
              "properties" : {
                "_type" : "setHeaders",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "headerList" : [ {
                  "headerName" : "recipientId",
                  "headerValue" : "${exchangeProperty.recipientId}",
                  "language" : "Simple",
                  "uuid" : "08706afa-6ecb-48a4-adab-c132c607f8d8"
                }, {
                  "headerName" : "x-agency-id",
                  "headerValue" : "${exchangeProperty.agencyId}",
                  "language" : "Simple",
                  "uuid" : "f59327b2-5aae-4e60-b5ae-a88703a6c5a8"
                } ],
                "name" : "setHeaders",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setHeaders",
              "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "direct",
              "nodeId" : "b7779924-38da-427a-a190-b98a005fa086",
              "description" : "to:addRecipLocation",
              "properties" : {
                "_type" : "direct",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "core",
                "endpointName" : "addRecipientGeolocation",
                "name" : "direct",
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "direct",
              "kameletPropertiesUrl" : "?endpointName=addRecipientGeolocation"
            }, {
              "name" : "direct",
              "nodeId" : "e6a96e59-0080-4b27-b6a8-06764950fb09",
              "description" : "to:getRecipById",
              "properties" : {
                "_type" : "direct",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "core",
                "endpointName" : "getRecipientByNumberOrId",
                "name" : "direct",
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "direct",
              "kameletPropertiesUrl" : "?endpointName=getRecipientByNumberOrId"
            }, {
              "name" : "setHeaders",
              "nodeId" : "c95ee14d-d205-4ee1-b311-0ad750d847b3",
              "description" : "HTTP200",
              "properties" : {
                "_type" : "setHeaders",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "headerList" : [ {
                  "headerName" : "CamelHttpResponseCode",
                  "headerValue" : "200",
                  "language" : "Constant",
                  "uuid" : "1ea59905-95f5-401c-95c9-327f7fc77f7a"
                } ],
                "name" : "setHeaders",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setHeaders",
              "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "setBody",
              "nodeId" : "ff181f52-0538-4b7f-9e39-ec99421a5ea2",
              "description" : "Render Recipient Resp",
              "properties" : {
                "_type" : "setBody",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "expression" : "$.data",
                "language" : "JsonPath",
                "name" : "setBody",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setBody",
              "kameletPropertiesUrl" : "?addNamespaces=false&expression=$.data&language=JsonPath&suppressExceptions=false"
            } ],
            "properties" : {
              "addNamespaces" : "false",
              "condition" : "${body} != null && ${header.CamelHttpResponseCode} == 200",
              "language" : "Simple",
              "namespaces" : [ ],
              "suppressExceptions" : "false"
            }
          } ],
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : { }
      }, {
        "type" : "filter",
        "label" : "400",
        "route" : [ {
          "name" : "setProperties",
          "nodeId" : "c392d1ae-13e5-455c-8451-4c216df925d2",
          "description" : "Set Error",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Constant",
              "propertyName" : "error",
              "propertyValue" : "Invalid Request. Missing required params.",
              "uuid" : "a64c1c9a-780d-4f73-aa51-d36751ac9e64"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?error=Invalid Request. Missing required params.&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "6b8b37a6-5350-4967-8f26-ce1a446d4b74",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean(\"renderResponse\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
        }, {
          "name" : "stop",
          "nodeId" : "a53084d6-9650-4602-9b8b-66e2bc71e2c4",
          "description" : "",
          "properties" : {
            "_type" : "stop",
            "camelGroup" : "misc",
            "name" : "stop",
            "url" : ""
          },
          "_type" : "stop",
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${exchangeProperty.providerToken} == null || ${exchangeProperty.agencyId} == null",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-6",
    "enabled" : true,
    "routeId" : 6,
    "route" : [ {
      "name" : "direct",
      "nodeId" : "ee1581c8-bd8f-449c-ae9f-6b050480c192",
      "description" : "import-rapidsos-recip",
      "properties" : {
        "_type" : "direct",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "core",
        "endpointName" : "import-rapidsos-recip",
        "name" : "direct",
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "direct",
      "kameletPropertiesUrl" : "?endpointName=import-rapidsos-recip"
    }, {
      "name" : "exchangePattern",
      "nodeId" : "c2fc9932-27ad-4be6-b115-21814920b5a3",
      "description" : "InOut",
      "properties" : {
        "_type" : "exchangePattern",
        "active" : true,
        "camelGroup" : "core",
        "exchangePattern" : "InOut",
        "name" : "exchangePattern",
        "url" : ""
      },
      "_type" : "exchangePattern",
      "kameletPropertiesUrl" : "?exchangePattern=InOut"
    }, {
      "name" : "jms",
      "nodeId" : "9c733559-3e9d-4584-b251-364758d11550",
      "description" : "providers.data.rapidsos",
      "properties" : {
        "_type" : "jms",
        "active" : true,
        "advancedParameters" : [ ],
        "asyncConsumer" : false,
        "camelGroup" : "component",
        "concurrentConsumers" : "1",
        "connectionFactory" : "#pooledConnectionFactory",
        "destinationName" : "providers.data.rapidsos",
        "destinationType" : "queue",
        "exchangePattern" : "InOnly",
        "name" : "jms",
        "setConnectionFactory" : true,
        "toDynamicEndpoint" : false,
        "transacted" : false,
        "url" : ""
      },
      "_type" : "jms",
      "kameletPropertiesUrl" : "?asyncConsumer=false&concurrentConsumers=1&connectionFactory=#pooledConnectionFactory&destinationName=providers.data.rapidsos&destinationType=queue&exchangePattern=InOnly&setConnectionFactory=true&transacted=false"
    }, {
      "name" : "log",
      "nodeId" : "7762844b-8da5-4209-81c2-d8ae309dc3eb",
      "description" : "208.api.import.rsos.out",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "INFO",
        "logType" : "EIP",
        "loggerName" : "208.api.import.rsos.out",
        "message" : "TokenResp: ${body}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.import.rsos.out&message=TokenResp: ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "messageFilter",
      "nodeId" : "42330ff2-4635-4c72-b94e-23fcb450a04b",
      "description" : "",
      "properties" : {
        "_type" : "messageFilter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageFilter",
        "url" : ""
      },
      "_type" : "messageFilter",
      "branches" : [ {
        "type" : "filter",
        "label" : "not found",
        "route" : [ {
          "name" : "log",
          "nodeId" : "ec3194e5-6ed5-41e3-9d30-bcef1c043415",
          "description" : "208.api.import.rsos.404",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "WARN",
            "logType" : "EIP",
            "loggerName" : "208.api.import.rsos.404",
            "message" : "(${header.CamelHttpResponseCode}) ${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=WARN&logType=EIP&loggerName=208.api.import.rsos.404&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "setProperties",
          "nodeId" : "98977ec9-38e4-47bf-92ae-cf8743303f19",
          "description" : "Set Error",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Constant",
              "propertyName" : "error",
              "propertyValue" : "Token Not Found",
              "uuid" : "74237eaf-6489-4995-b95c-15ef1c12f511"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?error=Token Not Found&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "setHeaders",
          "nodeId" : "b5681d58-a527-4b83-8c9d-92991df960bc",
          "description" : "HTTP404",
          "properties" : {
            "_type" : "setHeaders",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "headerList" : [ {
              "headerName" : "CamelHttpResponseCode",
              "headerValue" : "404",
              "language" : "Constant",
              "uuid" : "f4cbabaf-d5e8-41ba-8dbf-68e0090d9dc9"
            } ],
            "name" : "setHeaders",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setHeaders",
          "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "c965c734-ea86-44c3-b800-b38eea7afe54",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean(\"renderResponse\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
        }, {
          "name" : "stop",
          "nodeId" : "e1df8545-eb98-49ca-a464-7a52e8251090",
          "description" : "",
          "properties" : {
            "_type" : "stop",
            "camelGroup" : "misc",
            "name" : "stop",
            "url" : ""
          },
          "_type" : "stop",
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${header.CamelHttpResponseCode} != 200",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-7",
    "enabled" : true,
    "routeId" : 7,
    "route" : [ {
      "name" : "direct",
      "nodeId" : "4a30ce83-bb94-4214-8713-ebb1ccaae7a9",
      "description" : "sql-update-token",
      "properties" : {
        "_type" : "direct",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "core",
        "endpointName" : "sql-update-token",
        "name" : "direct",
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "direct",
      "kameletPropertiesUrl" : "?endpointName=sql-update-token"
    }, {
      "name" : "log",
      "nodeId" : "f4fe29f1-08d4-41aa-9505-0ed3e46d5a03",
      "description" : "208.direct.tok.update",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "INFO",
        "logType" : "EIP",
        "loggerName" : "208.direct.tok.update",
        "message" : "${body}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.direct.tok.update&message=${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "messagingEndpoint",
      "nodeId" : "8b8bd26d-f6b6-480f-a248-7c13bac69113",
      "description" : "SQL Update Token",
      "properties" : {
        "_type" : "messagingEndpoint",
        "active" : true,
        "camelGroup" : "core",
        "name" : "messagingEndpoint",
        "toDynamicEndpoint" : false,
        "uri" : "sql:UPDATE recipients SET provider_token = :#${exchangeProperty.providerToken}, token_last_updated = NOW(), token_last_response = :#${exchangeProperty.tokenResponse}, token_last_status = :#${exchangeProperty.tokenResponseCode}, provider_access_token = :#${exchangeProperty.providerAccessToken}, updated_at = NOW() WHERE id = CAST(:#${exchangeProperty.recipientId} AS uuid)?dataSource=#dsPostgres",
        "url" : ""
      },
      "_type" : "messagingEndpoint",
      "kameletPropertiesUrl" : "?uri=sql:UPDATE recipients SET provider_token = :#${exchangeProperty.providerToken}, token_last_updated = NOW(), token_last_response = :#${exchangeProperty.tokenResponse}, token_last_status = :#${exchangeProperty.tokenResponseCode}, provider_access_token = :#${exchangeProperty.providerAccessToken}, updated_at = NOW() WHERE id = CAST(:#${exchangeProperty.recipientId} AS uuid)?dataSource=#dsPostgres"
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-8",
    "enabled" : true,
    "routeId" : 8,
    "route" : [ {
      "name" : "direct",
      "nodeId" : "368fa8c7-cfbe-42e5-909e-f7ced5eb5376",
      "description" : "process-geography",
      "properties" : {
        "_type" : "direct",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "core",
        "endpointName" : "process-geography",
        "name" : "direct",
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "direct",
      "kameletPropertiesUrl" : "?endpointName=process-geography"
    }, {
      "name" : "setBody",
      "nodeId" : "053d8b1c-4541-4394-8c69-d1a6b4545ed4",
      "description" : "Clear Body",
      "properties" : {
        "_type" : "setBody",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "expression" : "\"\"",
        "language" : "Simple",
        "name" : "setBody",
        "namespaces" : [ ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setBody",
      "kameletPropertiesUrl" : "?addNamespaces=false&expression=\"\"&language=Simple&suppressExceptions=false"
    }, {
      "name" : "process",
      "nodeId" : "a491ab6d-ed0f-45ec-b78e-66645b11027f",
      "description" : "Set GIS Request",
      "properties" : {
        "_type" : "process",
        "active" : true,
        "camelGroup" : "transform",
        "code" : "Object geoLat = exchange.getProperty(\"lat\");\nObject geoLng = exchange.getProperty(\"lng\");\nString address = (String)exchange.getProperty(\"address\");\n\nHashMap<String, Object> gisRequest = new HashMap<String, Object>();\n\nif (geoLat != null && geoLng != null) {\n\tgisRequest.put(\"lat\", geoLat);\n\tgisRequest.put(\"lng\", geoLng);\n} \n\nif (address != null)\n\tgisRequest.put(\"address\", address);\n\nif (!gisRequest.isEmpty()) {\n\tObjectMapper mapper = new ObjectMapper();\n\texchange.getIn().setBody(mapper.writeValueAsString(gisRequest));\n}",
        "import" : "import com.fasterxml.jackson.databind.ObjectMapper;",
        "name" : "process",
        "url" : ""
      },
      "_type" : "process",
      "kameletPropertiesUrl" : "?code=Object geoLat = exchange.getProperty(\"lat\");\nObject geoLng = exchange.getProperty(\"lng\");\nString address = (String)exchange.getProperty(\"address\");\n\nHashMap<String, Object> gisRequest = new HashMap<String, Object>();\n\nif (geoLat != null && geoLng != null) {\n\tgisRequest.put(\"lat\", geoLat);\n\tgisRequest.put(\"lng\", geoLng);\n} \n\nif (address != null)\n\tgisRequest.put(\"address\", address);\n\nif (!gisRequest.isEmpty()) {\n\tObjectMapper mapper = new ObjectMapper();\n\texchange.getIn().setBody(mapper.writeValueAsString(gisRequest));\n}&import=import com.fasterxml.jackson.databind.ObjectMapper;"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "fcb29be1-5041-4e32-a955-601c5903c5e3",
      "description" : "Remove Headers",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".removeHeaders(\"*\", \"x-*\", \"Authorization\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-*\", \"Authorization\")"
    }, {
      "name" : "messageFilter",
      "nodeId" : "0d603989-a039-4157-ae9c-d5afcfc08350",
      "description" : "",
      "properties" : {
        "_type" : "messageFilter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageFilter",
        "url" : ""
      },
      "_type" : "messageFilter",
      "branches" : [ {
        "type" : "filter",
        "label" : "valid && !update",
        "route" : [ {
          "name" : "log",
          "nodeId" : "327fefb7-a24e-4f45-986c-dfac3a6bcca4",
          "description" : "geo.add.process.in",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "208.api.recip.geo.add.process.in",
            "message" : "${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.recip.geo.add.process.in&message=${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "exchangePattern",
          "nodeId" : "d9b0d0bf-51ce-4151-a9aa-21d3f091c4d1",
          "description" : "InOut",
          "properties" : {
            "_type" : "exchangePattern",
            "active" : true,
            "camelGroup" : "core",
            "exchangePattern" : "InOut",
            "name" : "exchangePattern",
            "url" : ""
          },
          "_type" : "exchangePattern",
          "kameletPropertiesUrl" : "?exchangePattern=InOut"
        }, {
          "name" : "jms",
          "nodeId" : "9a4184fd-6fd7-48f0-bb39-36245790bdef",
          "description" : "providers.gis.google",
          "properties" : {
            "_type" : "jms",
            "active" : true,
            "advancedParameters" : [ ],
            "asyncConsumer" : false,
            "camelGroup" : "component",
            "concurrentConsumers" : "1",
            "connectionFactory" : "#pooledConnectionFactory",
            "destinationName" : "providers.gis.google",
            "destinationType" : "queue",
            "exchangePattern" : "InOnly",
            "name" : "jms",
            "setConnectionFactory" : true,
            "toDynamicEndpoint" : false,
            "transacted" : false,
            "url" : ""
          },
          "_type" : "jms",
          "kameletPropertiesUrl" : "?asyncConsumer=false&concurrentConsumers=1&connectionFactory=#pooledConnectionFactory&destinationName=providers.gis.google&destinationType=queue&exchangePattern=InOnly&setConnectionFactory=true&transacted=false"
        }, {
          "name" : "setProperties",
          "nodeId" : "9cb20871-1079-4429-9989-d1b951e17a59",
          "description" : "Get GIS Response",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "JsonPath",
              "propertyName" : "gisAddress",
              "propertyValue" : "$.[0]",
              "uuid" : "626c9a70-20be-454f-9bdb-2dcad5286930"
            }, {
              "language" : "Simple",
              "propertyName" : "formattedAddress",
              "propertyValue" : "${exchangeProperty.gisAddress[formattedAddress]}",
              "uuid" : "db993ecb-39d8-4680-9421-98b65a9df3d6"
            }, {
              "language" : "Simple",
              "propertyName" : "geoLat",
              "propertyValue" : "${exchangeProperty.gisAddress[geometry][location][lat]}",
              "uuid" : "711b3406-ec0e-40ae-bd46-21b949719a64"
            }, {
              "language" : "Simple",
              "propertyName" : "geoLng",
              "propertyValue" : "${exchangeProperty.gisAddress[geometry][location][lng]}",
              "uuid" : "398b38cc-0824-4343-8cf8-8e9a319349b3"
            } ],
            "suppressExceptions" : true,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?gisAddress=$.[0]&formattedAddress=${exchangeProperty.gisAddress[formattedAddress]}&geoLat=${exchangeProperty.gisAddress[geometry][location][lat]}&geoLng=${exchangeProperty.gisAddress[geometry][location][lng]}&addNamespaces=false&suppressExceptions=true"
        }, {
          "name" : "log",
          "nodeId" : "a47319f9-e9b7-452d-8606-f437acb50cb0",
          "description" : "geo.add.process.out",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "api.recip.geo.add.process.out",
            "message" : "(${header.CamelHttpResponseCode}) ${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=api.recip.geo.add.process.out&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${body} && ${exchangeProperty.geolocationId} == null",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-11",
    "enabled" : true,
    "routeId" : 9,
    "route" : [ {
      "name" : "seda",
      "nodeId" : "cff446e9-b635-4364-9955-e271e4d3c59d",
      "description" : "enqueue-event",
      "properties" : {
        "_type" : "seda",
        "active" : true,
        "advancedParameters" : [ ],
        "blockWhenFull" : false,
        "camelGroup" : "core",
        "concurrentConsumers" : "10",
        "endpointName" : "enqueue-event",
        "limitConcurrentConsumers" : true,
        "multipleConsumers" : false,
        "name" : "seda",
        "pollTimeout" : "1000",
        "size" : "1000",
        "specifyMaximumCapacitySize" : false,
        "timeout" : "30000",
        "toDynamicEndpoint" : false,
        "url" : "",
        "waitForTaskToComplete" : "IfReplyExpected"
      },
      "_type" : "seda",
      "kameletPropertiesUrl" : "?blockWhenFull=false&concurrentConsumers=10&endpointName=enqueue-event&limitConcurrentConsumers=true&multipleConsumers=false&pollTimeout=1000&size=1000&specifyMaximumCapacitySize=false&timeout=30000&waitForTaskToComplete=IfReplyExpected"
    }, {
      "name" : "exchangePattern",
      "nodeId" : "df6e92cc-5edd-4dc1-bf28-1aeb10b14cb4",
      "description" : "InOnly",
      "properties" : {
        "_type" : "exchangePattern",
        "active" : true,
        "camelGroup" : "core",
        "exchangePattern" : "InOnly",
        "name" : "exchangePattern",
        "url" : ""
      },
      "_type" : "exchangePattern",
      "kameletPropertiesUrl" : "?exchangePattern=InOnly"
    }, {
      "name" : "setHeaders",
      "nodeId" : "8923660c-a61e-4c0c-b765-954dc4d82113",
      "description" : "Set Source System",
      "properties" : {
        "_type" : "setHeaders",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "headerList" : [ {
          "headerName" : "x-source-system",
          "headerValue" : "${exchangeProperty.sourceSystem}",
          "language" : "Simple",
          "uuid" : "83307376-acfe-4d25-9443-e47ab1d8e214"
        } ],
        "name" : "setHeaders",
        "namespaces" : [ ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setHeaders",
      "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "log",
      "nodeId" : "ccc82c92-e735-4550-bf7e-36fea27305ad",
      "description" : "208.seda.io.in",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "OFF",
        "logType" : "EIP",
        "loggerName" : "208.seda.io.in",
        "message" : "Enqueuing Event ${body}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=OFF&logType=EIP&loggerName=208.seda.io.in&message=Enqueuing Event ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "jms",
      "nodeId" : "0e5466bd-49fb-4b99-bd5f-5fdc621311c6",
      "description" : "Emit IO Event",
      "properties" : {
        "_type" : "jms",
        "active" : true,
        "advancedParameters" : [ ],
        "asyncConsumer" : false,
        "camelGroup" : "component",
        "concurrentConsumers" : "1",
        "connectionFactory" : "#pooledConnectionFactory",
        "destinationName" : "io.event",
        "destinationType" : "queue",
        "exchangePattern" : "InOnly",
        "name" : "jms",
        "setConnectionFactory" : true,
        "toDynamicEndpoint" : false,
        "transacted" : false,
        "url" : ""
      },
      "_type" : "jms",
      "kameletPropertiesUrl" : "?asyncConsumer=false&concurrentConsumers=1&connectionFactory=#pooledConnectionFactory&destinationName=io.event&destinationType=queue&exchangePattern=InOnly&setConnectionFactory=true&transacted=false"
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-12",
    "enabled" : true,
    "routeId" : 10,
    "route" : [ {
      "name" : "putRequest",
      "nodeId" : "716521de-fef9-4b23-afe9-d5eabdf796d7",
      "description" : "updateRecipient",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/recipients/{numberOrId}",
        "method" : "put",
        "name" : "putRequest",
        "operationName" : "updateRecipient",
        "produces" : "application/json",
        "requestmethod" : "PUT",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/recipients/{numberOrId}&method=put&operationName=updateRecipient&produces=application/json&requestmethod=PUT"
    }, {
      "name" : "convertBodyTo",
      "nodeId" : "a42924a6-8434-4a93-abdc-e7d808a8950c",
      "description" : "",
      "properties" : {
        "_type" : "convertBodyTo",
        "active" : true,
        "camelGroup" : "transform",
        "name" : "convertBodyTo",
        "targetClass" : "String.class",
        "url" : ""
      },
      "_type" : "convertBodyTo",
      "kameletPropertiesUrl" : "?targetClass=String.class"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "673adf50-2401-4025-8c4c-ee97f3ce9221",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "2745b350-689f-44ed-98d7-a01025f36011",
      "description" : "Validate Request",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".log(LoggingLevel.INFO, 'log', '${body}')\n.to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n  .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}')\t\n        .stop()\n    .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.log(LoggingLevel.INFO, 'log', '${body}')\n.to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n  .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}')\t\n        .stop()\n    .end()"
    }, {
      "name" : "log",
      "nodeId" : "c2a3a343-cceb-4d34-9ebc-1ae3d7da59d1",
      "description" : "208.api.put.in",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "INFO",
        "logType" : "EIP",
        "loggerName" : "208.api.put.in",
        "message" : "${exchangeProperty.numberOrId} ${body}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.put.in&message=${exchangeProperty.numberOrId} ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "setProperties",
      "nodeId" : "92347a8e-eae8-4760-b5b4-fc168e5df587",
      "description" : "Set Input Props",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Header",
          "propertyName" : "recipientNumberOrId",
          "propertyValue" : "numberOrId",
          "uuid" : "d1c07538-caf3-468b-a7c5-7ed84e62e414"
        }, {
          "language" : "JsonPath",
          "propertyName" : "label",
          "propertyValue" : "$.label",
          "uuid" : "d11401d4-8982-4f11-8c35-76db1ab99b11"
        }, {
          "language" : "JsonPath",
          "propertyName" : "number",
          "propertyValue" : "$.number",
          "uuid" : "143f9023-1e38-4ad8-b855-788538eac7ea"
        }, {
          "language" : "JsonPath",
          "propertyName" : "language",
          "propertyValue" : "$.language",
          "uuid" : "c74776e5-b911-4867-adda-823d6a1c2d33"
        }, {
          "language" : "Header",
          "propertyName" : "agencyId",
          "propertyValue" : "x-agency-id",
          "uuid" : "63f4f20c-1003-4ddf-9a71-f866f22be073"
        } ],
        "suppressExceptions" : true,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?recipientNumberOrId=numberOrId&label=$.label&number=$.number&language=$.language&agencyId=x-agency-id&addNamespaces=false&suppressExceptions=true"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "6d992b1c-f5d1-4747-b711-fb029adeaa81",
      "description" : "Remove Headers",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".removeHeaders(\"*\", \"x-*\", \"Authorization\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-*\", \"Authorization\")"
    }, {
      "name" : "direct",
      "nodeId" : "6c8f5947-65fa-41fe-b5fd-d3040378f2f6",
      "description" : "sql-get-recipient",
      "properties" : {
        "_type" : "direct",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "core",
        "endpointName" : "sql-get-recipient",
        "name" : "direct",
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "direct",
      "kameletPropertiesUrl" : "?endpointName=sql-get-recipient"
    }, {
      "name" : "messageFilter",
      "nodeId" : "c0478e58-4a92-4266-9c71-d74bfa296aad",
      "description" : "Recipient?",
      "properties" : {
        "_type" : "messageFilter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageFilter",
        "url" : ""
      },
      "_type" : "messageFilter",
      "branches" : [ {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "process",
          "nodeId" : "9a7a6776-76ec-424f-a8f0-c3a69e66786b",
          "description" : "Validate",
          "properties" : {
            "_type" : "process",
            "active" : true,
            "camelGroup" : "transform",
            "code" : "String number = (String)exchange.getProperty(\"number\");\nif (number != null) {\n\tnumber = number.replaceAll(\"[^\\\\d]\", \"\");\n\n\tif (number.length() == 10)\n\t\tnumber = \"1\" + number;\n\n\texchange.setProperty(\"number\", \"+\" + number);\n}\n\nString recipientLanguage = (String)exchange.getProperty(\"recipientLanguage\");\nString language = (String)exchange.getProperty(\"language\");\nif (language != null) {\n\tif (language.trim().equals(\"\"))\n\t\trecipientLanguage = null;\n\telse\n\t\trecipientLanguage = language;\n\t\n\t// Temporary fix to browser-based language dialect codes like en-US\n\tif (recipientLanguage != null && recipientLanguage.length() > 2)\n\t\trecipientLanguage = recipientLanguage.substring(0, 2);\n\t\n\texchange.setProperty(\"recipientLanguage\", recipientLanguage);\n}",
            "import" : "// import org.apache.camel.Message",
            "name" : "process",
            "url" : ""
          },
          "_type" : "process",
          "kameletPropertiesUrl" : "?code=String number = (String)exchange.getProperty(\"number\");\nif (number != null) {\n\tnumber = number.replaceAll(\"[^\\\\d]\", \"\");\n\n\tif (number.length() == 10)\n\t\tnumber = \"1\" + number;\n\n\texchange.setProperty(\"number\", \"+\" + number);\n}\n\nString recipientLanguage = (String)exchange.getProperty(\"recipientLanguage\");\nString language = (String)exchange.getProperty(\"language\");\nif (language != null) {\n\tif (language.trim().equals(\"\"))\n\t\trecipientLanguage = null;\n\telse\n\t\trecipientLanguage = language;\n\t\n\t// Temporary fix to browser-based language dialect codes like en-US\n\tif (recipientLanguage != null && recipientLanguage.length() > 2)\n\t\trecipientLanguage = recipientLanguage.substring(0, 2);\n\t\n\texchange.setProperty(\"recipientLanguage\", recipientLanguage);\n}&import=// import org.apache.camel.Message"
        }, {
          "name" : "log",
          "nodeId" : "fb2f1bd3-577f-4fda-b962-8347a2b2077a",
          "description" : "",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "log",
            "message" : "*** UPDATE recipients SET recipient_number = COALESCE(:#${exchangeProperty.number}, recipient_number), language = :#${exchangeProperty.recipientLanguage}, friendly_name = COALESCE(:#${exchangeProperty.label}, friendly_name), updated_at = NOW() WHERE id = CAST(:#${exchangeProperty.recipientId} AS uuid) AND agency_id = CAST(:#${exchangeProperty.agencyId} AS uuid)",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=log&message=*** UPDATE recipients SET recipient_number = COALESCE(:#${exchangeProperty.number}, recipient_number), language = :#${exchangeProperty.recipientLanguage}, friendly_name = COALESCE(:#${exchangeProperty.label}, friendly_name), updated_at = NOW() WHERE id = CAST(:#${exchangeProperty.recipientId} AS uuid) AND agency_id = CAST(:#${exchangeProperty.agencyId} AS uuid)&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "messagingEndpoint",
          "nodeId" : "4e69d4a9-a66a-4e6c-aefb-c9aca86599dd",
          "description" : "SQL Update Recipient",
          "properties" : {
            "_type" : "messagingEndpoint",
            "active" : true,
            "camelGroup" : "core",
            "name" : "messagingEndpoint",
            "toDynamicEndpoint" : false,
            "uri" : "sql:UPDATE recipients SET recipient_number = COALESCE(:#${exchangeProperty.number}, recipient_number), language = :#${exchangeProperty.recipientLanguage}, friendly_name = COALESCE(:#${exchangeProperty.label}, friendly_name), updated_at = NOW() WHERE id = CAST(:#${exchangeProperty.recipientId} AS uuid) AND agency_id = CAST(:#${exchangeProperty.agencyId} AS uuid)?dataSource=#dsPostgres",
            "url" : ""
          },
          "_type" : "messagingEndpoint",
          "kameletPropertiesUrl" : "?uri=sql:UPDATE recipients SET recipient_number = COALESCE(:#${exchangeProperty.number}, recipient_number), language = :#${exchangeProperty.recipientLanguage}, friendly_name = COALESCE(:#${exchangeProperty.label}, friendly_name), updated_at = NOW() WHERE id = CAST(:#${exchangeProperty.recipientId} AS uuid) AND agency_id = CAST(:#${exchangeProperty.agencyId} AS uuid)?dataSource=#dsPostgres"
        }, {
          "name" : "setHeaders",
          "nodeId" : "94d2746a-1a75-4703-88b8-dd8ee1fdeb72",
          "description" : "Set Recipient ID",
          "properties" : {
            "_type" : "setHeaders",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "headerList" : [ {
              "headerName" : "numberOrId",
              "headerValue" : "${exchangeProperty.recipientId}",
              "language" : "Simple",
              "uuid" : "52a34e5a-5cd9-42d8-be13-3dff606269cb"
            }, {
              "headerName" : "x-authorized",
              "headerValue" : "true",
              "language" : "Simple",
              "uuid" : "20db7121-9e4b-4401-86f2-1b26aef863f8"
            } ],
            "name" : "setHeaders",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setHeaders",
          "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "direct",
          "nodeId" : "1b4e3eab-125f-487a-9e76-2fb374179526",
          "description" : "getRecipientByNumberOrId",
          "properties" : {
            "_type" : "direct",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "core",
            "endpointName" : "getRecipientByNumberOrId",
            "name" : "direct",
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "direct",
          "kameletPropertiesUrl" : "?endpointName=getRecipientByNumberOrId"
        }, {
          "name" : "setBody",
          "nodeId" : "88b24e10-a4e6-4296-a3e5-91416c2f991b",
          "description" : "Set Response",
          "properties" : {
            "_type" : "setBody",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "expression" : "$.data",
            "language" : "JsonPath",
            "name" : "setBody",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setBody",
          "kameletPropertiesUrl" : "?addNamespaces=false&expression=$.data&language=JsonPath&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "9574de14-16ee-4585-821a-6737a14b52a1",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean(\"renderResponse\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
        }, {
          "name" : "log",
          "nodeId" : "79a76298-cfec-4218-b28d-4fc9a597b9bf",
          "description" : "208.api.put.out",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "208.api.put.out",
            "message" : "(${header.CamelHttpResponseCode}) ${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.put.out&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "seda",
          "nodeId" : "bd71a460-a6ce-475c-8092-dcb3f880f633",
          "description" : "enqueue-event",
          "properties" : {
            "_type" : "seda",
            "active" : true,
            "advancedParameters" : [ ],
            "blockWhenFull" : false,
            "camelGroup" : "core",
            "concurrentConsumers" : "1",
            "endpointName" : "enqueue-event",
            "limitConcurrentConsumers" : true,
            "multipleConsumers" : false,
            "name" : "seda",
            "pollTimeout" : "1000",
            "size" : "1000",
            "specifyMaximumCapacitySize" : false,
            "timeout" : "30000",
            "toDynamicEndpoint" : false,
            "url" : "",
            "waitForTaskToComplete" : "Never"
          },
          "_type" : "seda",
          "kameletPropertiesUrl" : "?blockWhenFull=false&concurrentConsumers=1&endpointName=enqueue-event&limitConcurrentConsumers=true&multipleConsumers=false&pollTimeout=1000&size=1000&specifyMaximumCapacitySize=false&timeout=30000&waitForTaskToComplete=Never"
        } ],
        "properties" : { }
      }, {
        "type" : "filter",
        "label" : "filter",
        "route" : [ {
          "name" : "log",
          "nodeId" : "0ad7bf6a-87b6-4498-9714-cfec8c30b186",
          "description" : "208.api.put.404",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "208.api.put.404",
            "message" : "Recipient not found",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.put.404&message=Recipient not found&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "setHeaders",
          "nodeId" : "1e652844-7bf8-4c31-b0d4-55afa291e695",
          "description" : "HTTP404",
          "properties" : {
            "_type" : "setHeaders",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "headerList" : [ {
              "headerName" : "CamelHttpResponseCode",
              "headerValue" : "404",
              "language" : "Constant",
              "uuid" : "cf96bce8-8c58-4e64-a29f-12a7179db530"
            } ],
            "name" : "setHeaders",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setHeaders",
          "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "clearBody",
          "nodeId" : "c24f11d4-77ee-4d9e-8d7c-336e0d0fd1c9",
          "description" : "",
          "properties" : {
            "_type" : "clearBody",
            "camelGroup" : "core",
            "name" : "clearBody",
            "url" : ""
          },
          "_type" : "clearBody",
          "kameletPropertiesUrl" : ""
        }, {
          "name" : "stop",
          "nodeId" : "0e05e38a-3a13-470a-8f59-96751fcb25b4",
          "description" : "",
          "properties" : {
            "_type" : "stop",
            "camelGroup" : "misc",
            "name" : "stop",
            "url" : ""
          },
          "_type" : "stop",
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${exchangeProperty.recipient} == null",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-13",
    "enabled" : true,
    "routeId" : 11,
    "route" : [ {
      "name" : "direct",
      "nodeId" : "0bd78569-6984-4946-8cbb-8310850271ca",
      "description" : "sql-get-recipient",
      "properties" : {
        "_type" : "direct",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "core",
        "endpointName" : "sql-get-recipient",
        "name" : "direct",
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "direct",
      "kameletPropertiesUrl" : "?endpointName=sql-get-recipient"
    }, {
      "name" : "process",
      "nodeId" : "73fb4ef1-2f9e-4b49-baea-542e17891179",
      "description" : "Parse Number or ID",
      "properties" : {
        "_type" : "process",
        "active" : true,
        "camelGroup" : "transform",
        "code" : "String recipientNumberOrId = (String)exchange.getProperty(\"recipientNumberOrId\");\nif (recipientNumberOrId == null) \n\trecipientNumberOrId = (String)exchange.getProperty(\"number\");\nif (recipientNumberOrId == null)\n\trecipientNumberOrId = (String)exchange.getProperty(\"fingerprint\");\n\nSystem.out.println(\"recipientNumberOrId: \" + recipientNumberOrId);\nif (recipientNumberOrId != null) {\n\tif (recipientNumberOrId.length() == 36)\n\t\texchange.setProperty(\"recipientId\", recipientNumberOrId);\n\telse if (recipientNumberOrId.length() == 10 || recipientNumberOrId.startsWith(\"+\")) {\n\t\tString recipientNumber = recipientNumberOrId.replaceAll(\"-\", \"\");\n\t\tif (!(recipientNumberOrId.startsWith(\"+\"))) \n\t\t\trecipientNumber = \"+\" + (recipientNumber.length() == 10 ? \"1\" : \"\") + recipientNumber;\n\n\t\texchange.setProperty(\"recipientNumber\", recipientNumber);\n\t}\n\telse \n\t\texchange.setProperty(\"fingerprint\", recipientNumberOrId);\n}\n\nSystem.out.println(\"recipientId: \" + exchange.getProperty(\"recipientId\"));\nSystem.out.println(\"recipientNumber: \" + exchange.getProperty(\"recipientNumber\"));\nSystem.out.println(\"fingerprint: \" + exchange.getProperty(\"fingerprint\"));",
        "import" : "// import org.apache.camel.Message",
        "name" : "process",
        "url" : ""
      },
      "_type" : "process",
      "kameletPropertiesUrl" : "?code=String recipientNumberOrId = (String)exchange.getProperty(\"recipientNumberOrId\");\nif (recipientNumberOrId == null) \n\trecipientNumberOrId = (String)exchange.getProperty(\"number\");\nif (recipientNumberOrId == null)\n\trecipientNumberOrId = (String)exchange.getProperty(\"fingerprint\");\n\nSystem.out.println(\"recipientNumberOrId: \" + recipientNumberOrId);\nif (recipientNumberOrId != null) {\n\tif (recipientNumberOrId.length() == 36)\n\t\texchange.setProperty(\"recipientId\", recipientNumberOrId);\n\telse if (recipientNumberOrId.length() == 10 || recipientNumberOrId.startsWith(\"+\")) {\n\t\tString recipientNumber = recipientNumberOrId.replaceAll(\"-\", \"\");\n\t\tif (!(recipientNumberOrId.startsWith(\"+\"))) \n\t\t\trecipientNumber = \"+\" + (recipientNumber.length() == 10 ? \"1\" : \"\") + recipientNumber;\n\n\t\texchange.setProperty(\"recipientNumber\", recipientNumber);\n\t}\n\telse \n\t\texchange.setProperty(\"fingerprint\", recipientNumberOrId);\n}\n\nSystem.out.println(\"recipientId: \" + exchange.getProperty(\"recipientId\"));\nSystem.out.println(\"recipientNumber: \" + exchange.getProperty(\"recipientNumber\"));\nSystem.out.println(\"fingerprint: \" + exchange.getProperty(\"fingerprint\"));&import=// import org.apache.camel.Message"
    }, {
      "name" : "messageFilter",
      "nodeId" : "4367c37f-d5ea-4fcc-a190-51a1bb760b96",
      "description" : "",
      "properties" : {
        "_type" : "messageFilter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageFilter",
        "url" : ""
      },
      "_type" : "messageFilter",
      "branches" : [ {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "dslProcessor",
          "nodeId" : "0474adf4-00e9-4522-86a1-162302fc2cf1",
          "description" : "SQL Get Recipient",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".to(\"velocity:recipients.select.sql.vm?allowContextMapAll=true\")\n\t.log(LoggingLevel.INFO, '208.direct.sql.get', '${body}')\n        \t.to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectList&useMessageBodyForSql=true\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.to(\"velocity:recipients.select.sql.vm?allowContextMapAll=true\")\n\t.log(LoggingLevel.INFO, '208.direct.sql.get', '${body}')\n        \t.to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectList&useMessageBodyForSql=true\")"
        }, {
          "name" : "log",
          "nodeId" : "4091c640-43c8-4c38-8c6e-deb444e0e6fe",
          "description" : "",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "log",
            "message" : "${header.CamelSqlRowCount} ${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=log&message=${header.CamelSqlRowCount} ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "messageFilter",
          "nodeId" : "b59fc6ee-4581-434e-b44a-ab523bd4b314",
          "description" : "Exists?",
          "properties" : {
            "_type" : "messageFilter",
            "active" : true,
            "camelGroup" : "routing",
            "name" : "messageFilter",
            "url" : ""
          },
          "_type" : "messageFilter",
          "branches" : [ {
            "type" : "filter",
            "label" : "RowCount > 0",
            "route" : [ {
              "name" : "setProperties",
              "nodeId" : "ffef2d27-0f20-427f-a43e-6c43672997db",
              "description" : "Set Recipient",
              "properties" : {
                "_type" : "setProperties",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "name" : "setProperties",
                "namespaces" : [ ],
                "propertyList" : [ {
                  "language" : "Simple",
                  "propertyName" : "recipient",
                  "propertyValue" : "${body[0]}",
                  "uuid" : "960e1c1c-8d9c-46d7-b94d-1b15ca59a817"
                }, {
                  "language" : "Simple",
                  "propertyName" : "recipientId",
                  "propertyValue" : "${exchangeProperty.recipient[recipient_id]}",
                  "uuid" : "6e9f6558-81de-4a6e-8cfa-ab99515e1db7"
                }, {
                  "language" : "",
                  "propertyName" : "recipientLanguage",
                  "propertyValue" : "${exchangeProperty.recipient[language]}",
                  "uuid" : "afeffbf0-a5a2-456d-a24b-1706a3a22591"
                } ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setProperties",
              "kameletPropertiesUrl" : "?recipient=${body[0]}&recipientId=${exchangeProperty.recipient[recipient_id]}&recipientLanguage=${exchangeProperty.recipient[language]}&addNamespaces=false&suppressExceptions=false"
            } ],
            "properties" : {
              "addNamespaces" : "false",
              "condition" : "${header.CamelSqlRowCount} > 0",
              "language" : "Simple",
              "namespaces" : [ ],
              "suppressExceptions" : "false"
            }
          } ],
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : { }
      }, {
        "type" : "filter",
        "label" : "filter",
        "route" : [ {
          "name" : "throwException",
          "nodeId" : "de5df4b5-ff7b-4dcd-b6cc-4ee1a130de2b",
          "description" : "queryKey is null",
          "properties" : {
            "_type" : "throwException",
            "active" : true,
            "camelGroup" : "exception",
            "exception" : "new UnsupportedOperationException(\"Can't lookup recipient without specifying a key\")",
            "name" : "throwException",
            "url" : ""
          },
          "_type" : "throwException",
          "kameletPropertiesUrl" : "?exception=new UnsupportedOperationException(\"Can't lookup recipient without specifying a key\")"
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${exchangeProperty.recipientNumber} == null && ${exchangeProperty.recipientId} == null && ${exchangeProperty.fingerprint} == null",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-14",
    "enabled" : true,
    "routeId" : 12,
    "route" : [ {
      "name" : "getRequest",
      "nodeId" : "500ec7e6-bf5a-46d1-be9c-7e9c410f0ef6",
      "description" : "getRecipientLocationById",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/recipients/{numberOrId}/geolocations/{locationId}",
        "method" : "get",
        "name" : "getRequest",
        "operationName" : "getRecipientLocationById",
        "produces" : "application/json",
        "requestmethod" : "GET",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/recipients/{numberOrId}/geolocations/{locationId}&method=get&operationName=getRecipientLocationById&produces=application/json&requestmethod=GET"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "fd9aaf9e-a8d5-4b63-be99-8459235f27a5",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "0c713f04-24bf-4e12-9c03-3c8fced56de0",
      "description" : "Validate Request",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".log(LoggingLevel.INFO, 'log', '${body}')\n.to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n  .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}')\t\n        .stop()\n    .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.log(LoggingLevel.INFO, 'log', '${body}')\n.to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n  .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}')\t\n        .stop()\n    .end()"
    }, {
      "name" : "log",
      "nodeId" : "b2d168f0-d1a2-4a89-b558-ea74b4f513ba",
      "description" : "208.api.geo.get.id.in",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "INFO",
        "logType" : "EIP",
        "loggerName" : "208.api.geo.get.id.in",
        "message" : "GET ${header.CamelHttpPath}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.geo.get.id.in&message=GET ${header.CamelHttpPath}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "setProperties",
      "nodeId" : "03037b4f-2405-41b6-b26d-46875c3301a5",
      "description" : "Get Input Props",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Header",
          "propertyName" : "recipientNumberOrId",
          "propertyValue" : "numberOrId",
          "uuid" : "a7464833-6699-4247-ab46-175e5f22eef4"
        }, {
          "language" : "Header",
          "propertyName" : "agencyId",
          "propertyValue" : "x-agency-id",
          "uuid" : "b877e48e-ae08-44f4-9c51-13398e1103fb"
        }, {
          "language" : "Header",
          "propertyName" : "locationId",
          "propertyValue" : "locationId",
          "uuid" : "9b1043f4-c0a0-4ec5-b39e-a9f9a0a98ccb"
        } ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?recipientNumberOrId=numberOrId&agencyId=x-agency-id&locationId=locationId&addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "885975cc-ab7d-411a-96a1-78885ccedfcf",
      "description" : "Remove Headers",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".removeHeaders(\"*\", \"x-*\", \"Authorization\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-*\", \"Authorization\")"
    }, {
      "name" : "direct",
      "nodeId" : "0a7da02e-213e-47b4-9017-d39fa00e9dca",
      "description" : "sql-get-recipient",
      "properties" : {
        "_type" : "direct",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "core",
        "endpointName" : "sql-get-recipient",
        "name" : "direct",
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "direct",
      "kameletPropertiesUrl" : "?endpointName=sql-get-recipient"
    }, {
      "name" : "messageFilter",
      "nodeId" : "7fc4da15-0608-467d-be02-dd5d8cf51535",
      "description" : "Exists?",
      "properties" : {
        "_type" : "messageFilter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageFilter",
        "url" : ""
      },
      "_type" : "messageFilter",
      "branches" : [ {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "dslProcessor",
          "nodeId" : "c97cbb47-81b5-4c2a-b3f9-870417532043",
          "description" : "SQL Get Location",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".to(\"velocity:geolocations.select.sql.vm?allowContextMapAll=true\")\n\t.log(LoggingLevel.OFF, 'log', '${body}')\n        \t.to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectOne&useMessageBodyForSql=true\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.to(\"velocity:geolocations.select.sql.vm?allowContextMapAll=true\")\n\t.log(LoggingLevel.OFF, 'log', '${body}')\n        \t.to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectOne&useMessageBodyForSql=true\")"
        }, {
          "name" : "messageFilter",
          "nodeId" : "8f4a5a7b-e7af-4aee-8359-30a39c9dc91b",
          "description" : "Not Found?",
          "properties" : {
            "_type" : "messageFilter",
            "active" : true,
            "camelGroup" : "routing",
            "name" : "messageFilter",
            "url" : ""
          },
          "_type" : "messageFilter",
          "branches" : [ {
            "type" : "filter",
            "label" : "RowCount == 0",
            "route" : [ {
              "name" : "setProperties",
              "nodeId" : "f873d8ba-9baf-4385-8d2e-53773efdd2cb",
              "description" : "Set Error",
              "properties" : {
                "_type" : "setProperties",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "name" : "setProperties",
                "namespaces" : [ ],
                "propertyList" : [ {
                  "language" : "Constant",
                  "propertyName" : "error",
                  "propertyValue" : "Location not found.",
                  "uuid" : "2b6e6616-362d-46df-b39a-4cfd86803f4d"
                }, {
                  "language" : "Constant",
                  "propertyName" : "CamelHttpResponseCode",
                  "propertyValue" : "404",
                  "uuid" : "cf1b91c8-359b-479b-bdf7-b2f87d7c4ffc"
                } ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setProperties",
              "kameletPropertiesUrl" : "?error=Location not found.&CamelHttpResponseCode=404&addNamespaces=false&suppressExceptions=false"
            } ],
            "properties" : {
              "addNamespaces" : "false",
              "condition" : "${header.CamelSqlRowCount} == 0",
              "language" : "Simple",
              "namespaces" : [ ],
              "suppressExceptions" : "false"
            }
          }, {
            "type" : "route",
            "label" : "route",
            "route" : [ {
              "name" : "dslProcessor",
              "nodeId" : "63417744-1eb8-4c56-bc38-8cbb6508b43a",
              "description" : "Render Response",
              "properties" : {
                "_type" : "dslProcessor",
                "active" : true,
                "camelGroup" : "core",
                "dsl" : ".bean('renderResponse')",
                "name" : "dslProcessor",
                "url" : ""
              },
              "_type" : "dslProcessor",
              "kameletPropertiesUrl" : "?dsl=.bean('renderResponse')"
            }, {
              "name" : "log",
              "nodeId" : "36085213-80e1-4917-a3ad-fd755ecfd4eb",
              "description" : "208.api.geo.get.id.out",
              "properties" : {
                "_type" : "log",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "component",
                "level" : "INFO",
                "logType" : "EIP",
                "loggerName" : "208.api.geo.get.id.out",
                "message" : "(${header.CamelHttpResponseCode}) ${body}",
                "multiline" : false,
                "name" : "log",
                "showAll" : false,
                "showBody" : true,
                "showBodyType" : true,
                "showCaughtException" : false,
                "showExchangeId" : false,
                "showHeaders" : false,
                "showProperties" : false,
                "showStackTrace" : false,
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "log",
              "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.geo.get.id.out&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
            } ],
            "properties" : { }
          } ],
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : { }
      }, {
        "type" : "filter",
        "label" : "RowCount==0",
        "route" : [ {
          "name" : "setProperties",
          "nodeId" : "be7fcabe-f26e-4d68-a41c-0379d9b95baf",
          "description" : "Set Error",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Constant",
              "propertyName" : "CamelHttpResponseCode",
              "propertyValue" : "404",
              "uuid" : "c3b500fe-bd38-48c5-8534-2ff9079a539a"
            }, {
              "language" : "Constant",
              "propertyName" : "error",
              "propertyValue" : "Recipient not found.",
              "uuid" : "b50fd6ae-7584-424d-a2e1-95bf167336a7"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?CamelHttpResponseCode=404&error=Recipient not found.&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "9925d57a-6b3d-4185-9221-640471bf650c",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean('renderResponse')",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean('renderResponse')"
        }, {
          "name" : "stop",
          "nodeId" : "e1eaca51-257d-41d8-a059-e5541a90411d",
          "description" : "",
          "properties" : {
            "_type" : "stop",
            "camelGroup" : "misc",
            "name" : "stop",
            "url" : ""
          },
          "_type" : "stop",
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${header.CamelSqlRowCount} == 0",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-9",
    "enabled" : true,
    "routeId" : 13,
    "route" : [ {
      "name" : "getRequest",
      "nodeId" : "d9738600-d334-4f0f-bff8-14d9d0f4f6fe",
      "description" : "getRecipientGeolocations",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/recipients/{numberOrId}/geolocations",
        "method" : "get",
        "name" : "getRequest",
        "operationName" : "getRecipientGeolocations",
        "produces" : "application/json",
        "requestmethod" : "GET",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/recipients/{numberOrId}/geolocations&method=get&operationName=getRecipientGeolocations&produces=application/json&requestmethod=GET"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "c17b0c8a-262f-4f72-9417-ef748e59b5c3",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "7bed8a5b-cffd-48d8-909c-82f3868210ea",
      "description" : "Validate Request",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n  .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}')\t\n        .stop()\n    .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n  .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}')\t\n        .stop()\n    .end()"
    }, {
      "name" : "setProperties",
      "nodeId" : "99d247a9-eebe-4189-a2a3-cbdc948f1e46",
      "description" : "Get Request Params",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Header",
          "propertyName" : "CamelHttpQuery",
          "propertyValue" : "CamelHttpQuery",
          "uuid" : "1592dda9-d10f-47ea-b3b9-49821ba5e3ef"
        }, {
          "language" : "Header",
          "propertyName" : "recipientNumberOrId",
          "propertyValue" : "numberOrId",
          "uuid" : "5d3b267e-e5a0-42ae-9f2f-657c01ba271d"
        }, {
          "language" : "Header",
          "propertyName" : "agencyId",
          "propertyValue" : "x-agency-id",
          "uuid" : "b263f45c-39ef-442f-99d0-098902eab0ed"
        }, {
          "language" : "Header",
          "propertyName" : "limit",
          "propertyValue" : "limit",
          "uuid" : "dd8c8c74-5016-47a1-9b5d-5377a05ca44a"
        }, {
          "language" : "Header",
          "propertyName" : "offset",
          "propertyValue" : "offset",
          "uuid" : "324506d6-678b-4884-aacc-8da657480fad"
        } ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?CamelHttpQuery=CamelHttpQuery&recipientNumberOrId=numberOrId&agencyId=x-agency-id&limit=limit&offset=offset&addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "direct",
      "nodeId" : "75d821cd-7839-4efa-a74a-01c79d570ea1",
      "description" : "sql-get-recipient",
      "properties" : {
        "_type" : "direct",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "core",
        "endpointName" : "sql-get-recipient",
        "name" : "direct",
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "direct",
      "kameletPropertiesUrl" : "?endpointName=sql-get-recipient"
    }, {
      "name" : "messageFilter",
      "nodeId" : "00ba1d15-ef7d-43d6-8a58-8e663d4281d3",
      "description" : "Exists?",
      "properties" : {
        "_type" : "messageFilter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageFilter",
        "url" : ""
      },
      "_type" : "messageFilter",
      "branches" : [ {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "dslProcessor",
          "nodeId" : "164dd8b3-e66d-4f51-bc9d-b88d5bc2d930",
          "description" : "SQL Get Geolocations",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".to(\"velocity:geolocations.select.sql.vm?allowContextMapAll=true\")\n\t.log(LoggingLevel.OFF, 'log', '${body}')\n        \t.to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectList&useMessageBodyForSql=true\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.to(\"velocity:geolocations.select.sql.vm?allowContextMapAll=true\")\n\t.log(LoggingLevel.OFF, 'log', '${body}')\n        \t.to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectList&useMessageBodyForSql=true\")"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "f9dec71a-b057-451f-8e34-79969bf809b2",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean('renderResponse')",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean('renderResponse')"
        } ],
        "properties" : { }
      }, {
        "type" : "filter",
        "label" : "RowCount==0",
        "route" : [ {
          "name" : "setProperties",
          "nodeId" : "1e8bdbf4-a7fa-4b68-8d75-a36743ea44a6",
          "description" : "Set Error",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Constant",
              "propertyName" : "CamelHttpResponseCode",
              "propertyValue" : "404",
              "uuid" : "423de107-65e7-42d0-ad46-989539d3ce84"
            }, {
              "language" : "Constant",
              "propertyName" : "error",
              "propertyValue" : "Recipient not found.",
              "uuid" : "970f3b10-cf90-46c6-88b4-8e348e6649ca"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?CamelHttpResponseCode=404&error=Recipient not found.&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "369a9a79-93ea-4350-9d90-5c2e1b3a4a30",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean('renderResponse')",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean('renderResponse')"
        }, {
          "name" : "stop",
          "nodeId" : "e72b1ebe-09ac-4e72-8b44-8de835790626",
          "description" : "",
          "properties" : {
            "_type" : "stop",
            "camelGroup" : "misc",
            "name" : "stop",
            "url" : ""
          },
          "_type" : "stop",
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${header.CamelSqlRowCount} == 0",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-10",
    "enabled" : true,
    "routeId" : 14,
    "route" : [ {
      "name" : "postRequest",
      "nodeId" : "226d2ead-fee4-4d3e-b761-0d7c509cec8b",
      "description" : "addRecipientGeolocation",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/recipients/{numberOrId}/geolocations",
        "method" : "post",
        "name" : "postRequest",
        "operationName" : "addRecipientGeolocation",
        "produces" : "application/json",
        "requestmethod" : "POST",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/recipients/{numberOrId}/geolocations&method=post&operationName=addRecipientGeolocation&produces=application/json&requestmethod=POST"
    }, {
      "name" : "convertBodyTo",
      "nodeId" : "543db915-e51d-4de9-a81e-55dde0ec94d4",
      "description" : "To String",
      "properties" : {
        "_type" : "convertBodyTo",
        "active" : true,
        "camelGroup" : "transform",
        "name" : "convertBodyTo",
        "targetClass" : "String.class",
        "url" : ""
      },
      "_type" : "convertBodyTo",
      "kameletPropertiesUrl" : "?targetClass=String.class"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "a4ba2c3b-9594-4085-a47e-1b16ffdf156e",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "229534ed-c37e-4999-a0ce-f0995c7aa341",
      "description" : "Validate Request",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n  .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}')\t\n        .stop()\n    .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n  .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}')\t\n        .stop()\n    .end()"
    }, {
      "name" : "log",
      "nodeId" : "3168acc6-1cf4-4e87-9fa6-d12a7e621bf9",
      "description" : "208.api.geo.in",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "INFO",
        "logType" : "EIP",
        "loggerName" : "208.api.geo.in",
        "message" : "${body}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.geo.in&message=${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "setProperties",
      "nodeId" : "c18a6e1e-61ee-44a1-932e-7ae0035fbdd5",
      "description" : "Get Request Props",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "JsonPath",
          "propertyName" : "address",
          "propertyValue" : "$.address",
          "uuid" : "17b1ab2f-68fa-4bc7-886e-2fc632a3b9dc"
        }, {
          "language" : "JsonPath",
          "propertyName" : "lat",
          "propertyValue" : "$.lat",
          "uuid" : "c11d2b62-8f3f-44a9-8bc6-5ba60f4e7f1d"
        }, {
          "language" : "JsonPath",
          "propertyName" : "lng",
          "propertyValue" : "$.lng",
          "uuid" : "09d89e42-b7dd-4b1b-97e3-43a4cd0ed1fd"
        }, {
          "language" : "Header",
          "propertyName" : "recipientNumberOrId",
          "propertyValue" : "numberOrId",
          "uuid" : "71a0d4c9-31ae-4c90-a06f-dd59375cb4f9"
        }, {
          "language" : "Header",
          "propertyName" : "agencyId",
          "propertyValue" : "x-agency-id",
          "uuid" : "45f5cbc3-9094-490c-89f1-56a236998fa6"
        }, {
          "language" : "JsonPath",
          "propertyName" : "altitude",
          "propertyValue" : "$.altitude",
          "uuid" : "ec5c8a06-c50c-4e30-a8d2-c7ce096446a1"
        }, {
          "language" : "JsonPath",
          "propertyName" : "altitudeAccuracy",
          "propertyValue" : "$.altitude_accuracy",
          "uuid" : "9ecac4f5-3962-434f-a50d-0a3e0385a854"
        }, {
          "language" : "JsonPath",
          "propertyName" : "latlngAccuracy",
          "propertyValue" : "$.latlng_accuracy",
          "uuid" : "08be57aa-7a08-4403-8617-cb1be5f8671c"
        }, {
          "language" : "JsonPath",
          "propertyName" : "$.latlngUncertainty",
          "propertyValue" : "latlng_uncertainty",
          "uuid" : "c1651058-9634-4632-adc0-45a24038c70c"
        }, {
          "language" : "JsonPath",
          "propertyName" : "hat",
          "propertyValue" : "$.hat",
          "uuid" : "b4c8383a-6535-434d-9580-574909ce8574"
        }, {
          "language" : "JsonPath",
          "propertyName" : "hatAccuracy",
          "propertyValue" : "$.hat_accuracy",
          "uuid" : "1c6a2ed8-3139-4138-a157-002cb0169edb"
        }, {
          "language" : "Header",
          "propertyName" : "sourceSystem",
          "propertyValue" : "x-source-system",
          "uuid" : "7fa66a13-3d0b-4c6f-889c-3e7d7698ca60"
        }, {
          "language" : "JsonPath",
          "propertyName" : "geolocationId",
          "propertyValue" : "$.geolocation_id",
          "uuid" : "acbd63a3-8ae5-4329-b460-e88b002938c2"
        } ],
        "suppressExceptions" : true,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?address=$.address&lat=$.lat&lng=$.lng&recipientNumberOrId=numberOrId&agencyId=x-agency-id&altitude=$.altitude&altitudeAccuracy=$.altitude_accuracy&latlngAccuracy=$.latlng_accuracy&$.latlngUncertainty=latlng_uncertainty&hat=$.hat&hatAccuracy=$.hat_accuracy&sourceSystem=x-source-system&geolocationId=$.geolocation_id&addNamespaces=false&suppressExceptions=true"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "c2113724-eb2c-427d-922e-2c4e23c867c8",
      "description" : "Remove Headers",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".removeHeaders(\"*\", \"x-*\", \"Authorization\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-*\", \"Authorization\")"
    }, {
      "name" : "messageFilter",
      "nodeId" : "d0bd2877-efc0-45e2-9d05-4422dfa323b4",
      "description" : "400",
      "properties" : {
        "_type" : "messageFilter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageFilter",
        "url" : ""
      },
      "_type" : "messageFilter",
      "branches" : [ {
        "type" : "filter",
        "label" : "filter",
        "route" : [ {
          "name" : "setProperties",
          "nodeId" : "50acc690-4126-485b-aac2-c1a62ba3e32c",
          "description" : "Set Error",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Simple",
              "propertyName" : "error",
              "propertyValue" : "Missing required data - Must provider either lat/lng coordinates or formatted address.",
              "uuid" : "55cc043e-8f0b-44e0-ad30-93a4c92c5f24"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?error=Missing required data - Must provider either lat/lng coordinates or formatted address.&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "abe80f2a-7bf3-40f1-a2bd-a2ded9fd9fbe",
          "description" : "Render Error",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean('renderResponse')",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean('renderResponse')"
        }, {
          "name" : "stop",
          "nodeId" : "3ab0e00c-e467-4ea9-8399-7f63d51c5c55",
          "description" : "",
          "properties" : {
            "_type" : "stop",
            "camelGroup" : "misc",
            "name" : "stop",
            "url" : ""
          },
          "_type" : "stop",
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${exchangeProperty.lat} == null && ${exchangeProperty.lng} == null",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      }, {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "direct",
          "nodeId" : "17720803-c7ba-4784-b2f4-ad47b0a63667",
          "description" : "sql-get-recipient",
          "properties" : {
            "_type" : "direct",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "core",
            "endpointName" : "sql-get-recipient",
            "name" : "direct",
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "direct",
          "kameletPropertiesUrl" : "?endpointName=sql-get-recipient"
        }, {
          "name" : "messageFilter",
          "nodeId" : "3d7001b0-1a4f-4deb-9477-7cfe1c45029e",
          "description" : "Recip Exists?",
          "properties" : {
            "_type" : "messageFilter",
            "active" : true,
            "camelGroup" : "routing",
            "name" : "messageFilter",
            "url" : ""
          },
          "_type" : "messageFilter",
          "branches" : [ {
            "type" : "route",
            "label" : "route",
            "route" : [ {
              "name" : "messagingEndpoint",
              "nodeId" : "02553da0-72e3-477d-8b3b-0f92d3100f27",
              "description" : "SQL Get Last Geolocation",
              "properties" : {
                "_type" : "messagingEndpoint",
                "active" : true,
                "camelGroup" : "core",
                "name" : "messagingEndpoint",
                "toDynamicEndpoint" : false,
                "uri" : "sql:SELECT id, ST_Distance(g.geog, CAST( ST_SetSRID(ST_Point( :#${exchangeProperty.lat}, :#${exchangeProperty.lng}), 4326) AS geography)) AS st_distance, hat FROM geolocations g WHERE recipient_id = CAST(:#${exchangeProperty.recipientId} AS uuid) ORDER BY created_at DESC LIMIT 1?dataSource=#dsPostgres&OutputType=SelectOne",
                "url" : ""
              },
              "_type" : "messagingEndpoint",
              "kameletPropertiesUrl" : "?uri=sql:SELECT id, ST_Distance(g.geog, CAST( ST_SetSRID(ST_Point( :#${exchangeProperty.lat}, :#${exchangeProperty.lng}), 4326) AS geography)) AS st_distance, hat FROM geolocations g WHERE recipient_id = CAST(:#${exchangeProperty.recipientId} AS uuid) ORDER BY created_at DESC LIMIT 1?dataSource=#dsPostgres&OutputType=SelectOne"
            }, {
              "name" : "messageRouter",
              "nodeId" : "e498c5af-bfd1-4856-ad2c-2509b399a1ee",
              "description" : "Check Last Geog",
              "properties" : {
                "_type" : "messageRouter",
                "active" : true,
                "camelGroup" : "routing",
                "name" : "messageRouter",
                "url" : ""
              },
              "_type" : "messageRouter",
              "branches" : [ {
                "type" : "when",
                "label" : "not changed && !update",
                "route" : [ {
                  "name" : "setHeaders",
                  "nodeId" : "aa5f78f2-c467-46f2-9085-43b0ae588866",
                  "description" : "HTTP304",
                  "properties" : {
                    "_type" : "setHeaders",
                    "active" : true,
                    "addNamespaces" : false,
                    "camelGroup" : "core",
                    "headerList" : [ {
                      "headerName" : "CamelHttpResponseCode",
                      "headerValue" : "304",
                      "language" : "Constant",
                      "uuid" : "e7e6ef04-93be-42e2-a0f5-208fc7a0fc16"
                    } ],
                    "name" : "setHeaders",
                    "namespaces" : [ ],
                    "suppressExceptions" : false,
                    "url" : ""
                  },
                  "_type" : "setHeaders",
                  "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
                }, {
                  "name" : "setBody",
                  "nodeId" : "7a17c775-d32a-4de1-aa16-2c894c9181dc",
                  "description" : "Clear Body",
                  "properties" : {
                    "_type" : "setBody",
                    "active" : true,
                    "addNamespaces" : false,
                    "camelGroup" : "core",
                    "expression" : "\"\"",
                    "language" : "Simple",
                    "name" : "setBody",
                    "namespaces" : [ ],
                    "suppressExceptions" : false,
                    "url" : ""
                  },
                  "_type" : "setBody",
                  "kameletPropertiesUrl" : "?addNamespaces=false&expression=\"\"&language=Simple&suppressExceptions=false"
                } ],
                "properties" : {
                  "addNamespaces" : "false",
                  "condition" : "${header.CamelSqlRowCount} == 1 && ${body[st_distance]} < 1 && ${exchangeProperty.geolocationId} == null",
                  "language" : "Simple",
                  "namespaces" : [ ],
                  "suppressExceptions" : "false"
                }
              }, {
                "type" : "otherwise",
                "label" : "otherwise",
                "route" : [ {
                  "name" : "direct",
                  "nodeId" : "a3644436-a146-4872-8d63-c031cc617f09",
                  "description" : "process-geography",
                  "properties" : {
                    "_type" : "direct",
                    "active" : true,
                    "advancedParameters" : [ ],
                    "camelGroup" : "core",
                    "endpointName" : "process-geography",
                    "name" : "direct",
                    "toDynamicEndpoint" : false,
                    "url" : ""
                  },
                  "_type" : "direct",
                  "kameletPropertiesUrl" : "?endpointName=process-geography"
                }, {
                  "name" : "setProperties",
                  "nodeId" : "ff3a0033-933e-45e2-81b2-3ed43d2e5ecf",
                  "description" : "Set Geography",
                  "properties" : {
                    "_type" : "setProperties",
                    "active" : true,
                    "addNamespaces" : false,
                    "camelGroup" : "core",
                    "name" : "setProperties",
                    "namespaces" : [ ],
                    "propertyList" : [ {
                      "language" : "Simple",
                      "propertyName" : "geogPoint",
                      "propertyValue" : "SRID=4326;POINT(${exchangeProperty.lng} ${exchangeProperty.lat})",
                      "uuid" : "29d8df64-48b8-444d-8a0c-26dd3756e529"
                    }, {
                      "language" : "Simple",
                      "propertyName" : "normalizedAddress",
                      "propertyValue" : "${exchangeProperty.formattedAddress}",
                      "uuid" : "5b0c740f-7eb1-42b0-ac4c-05796505b6a1"
                    } ],
                    "suppressExceptions" : false,
                    "url" : ""
                  },
                  "_type" : "setProperties",
                  "kameletPropertiesUrl" : "?geogPoint=SRID=4326;POINT(${exchangeProperty.lng} ${exchangeProperty.lat})&normalizedAddress=${exchangeProperty.formattedAddress}&addNamespaces=false&suppressExceptions=false"
                }, {
                  "name" : "log",
                  "nodeId" : "e02992fe-880d-4129-8bd2-811273e16a04",
                  "description" : "geo.sql.in",
                  "properties" : {
                    "_type" : "log",
                    "active" : true,
                    "advancedParameters" : [ ],
                    "camelGroup" : "component",
                    "level" : "INFO",
                    "logType" : "EIP",
                    "loggerName" : "208.api.geo.sql.in",
                    "message" : "GEOG ${exchangeProperty.geogPoint} ADDR ${exchangeProperty.normalizedAddress} HAT ${exchangeProperty.hat}",
                    "multiline" : false,
                    "name" : "log",
                    "showAll" : false,
                    "showBody" : true,
                    "showBodyType" : true,
                    "showCaughtException" : false,
                    "showExchangeId" : false,
                    "showHeaders" : false,
                    "showProperties" : false,
                    "showStackTrace" : false,
                    "toDynamicEndpoint" : false,
                    "url" : ""
                  },
                  "_type" : "log",
                  "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.geo.sql.in&message=GEOG ${exchangeProperty.geogPoint} ADDR ${exchangeProperty.normalizedAddress} HAT ${exchangeProperty.hat}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
                }, {
                  "name" : "messageRouter",
                  "nodeId" : "34700716-e584-4958-a9d1-08f1fedc7faf",
                  "description" : "new || update",
                  "properties" : {
                    "_type" : "messageRouter",
                    "active" : true,
                    "camelGroup" : "routing",
                    "name" : "messageRouter",
                    "url" : ""
                  },
                  "_type" : "messageRouter",
                  "branches" : [ {
                    "type" : "route",
                    "label" : "route",
                    "route" : [ {
                      "name" : "setHeaders",
                      "nodeId" : "ee08a3ae-a5c9-401d-be2f-ec75e421734a",
                      "description" : "Set Location ID",
                      "properties" : {
                        "_type" : "setHeaders",
                        "active" : true,
                        "addNamespaces" : false,
                        "camelGroup" : "core",
                        "headerList" : [ {
                          "headerName" : "numberOrId",
                          "headerValue" : "${body[0][recipient_id]}",
                          "language" : "Simple",
                          "uuid" : "ffc1c36e-300d-455f-aac7-8eba36671448"
                        }, {
                          "headerName" : "locationId",
                          "headerValue" : "${body[0][geolocation_id]}",
                          "language" : "Simple",
                          "uuid" : "cc77cb1c-5603-4259-a3a2-7d48e212e43d"
                        }, {
                          "headerName" : "x-agency-id",
                          "headerValue" : "${exchangeProperty.agencyId}",
                          "language" : "Simple",
                          "uuid" : "e429b55e-6246-423f-ac14-5e248c5f9860"
                        } ],
                        "name" : "setHeaders",
                        "namespaces" : [ ],
                        "suppressExceptions" : false,
                        "url" : ""
                      },
                      "_type" : "setHeaders",
                      "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
                    }, {
                      "name" : "direct",
                      "nodeId" : "9b224abf-fc2c-406e-a826-ad395f8da7d4",
                      "description" : "getRecipientLocationById",
                      "properties" : {
                        "_type" : "direct",
                        "active" : true,
                        "advancedParameters" : [ ],
                        "camelGroup" : "core",
                        "endpointName" : "getRecipientLocationById",
                        "name" : "direct",
                        "toDynamicEndpoint" : false,
                        "url" : ""
                      },
                      "_type" : "direct",
                      "kameletPropertiesUrl" : "?endpointName=getRecipientLocationById"
                    }, {
                      "name" : "setBody",
                      "nodeId" : "54db6f3a-b05a-4ce3-9d03-70cc7c2ce32d",
                      "description" : "Get SQL Result",
                      "properties" : {
                        "_type" : "setBody",
                        "active" : true,
                        "addNamespaces" : false,
                        "camelGroup" : "core",
                        "expression" : "$.data",
                        "language" : "JsonPath",
                        "name" : "setBody",
                        "namespaces" : [ ],
                        "suppressExceptions" : false,
                        "url" : ""
                      },
                      "_type" : "setBody",
                      "kameletPropertiesUrl" : "?addNamespaces=false&expression=$.data&language=JsonPath&suppressExceptions=false"
                    }, {
                      "name" : "log",
                      "nodeId" : "4c664970-df79-4964-bb5e-5a905ccc332b",
                      "description" : "geo.sql.out",
                      "properties" : {
                        "_type" : "log",
                        "active" : true,
                        "advancedParameters" : [ ],
                        "camelGroup" : "component",
                        "level" : "INFO",
                        "logType" : "EIP",
                        "loggerName" : "208.api.geo.sql.out",
                        "message" : "${body}",
                        "multiline" : false,
                        "name" : "log",
                        "showAll" : false,
                        "showBody" : true,
                        "showBodyType" : true,
                        "showCaughtException" : false,
                        "showExchangeId" : false,
                        "showHeaders" : false,
                        "showProperties" : false,
                        "showStackTrace" : false,
                        "toDynamicEndpoint" : false,
                        "url" : ""
                      },
                      "_type" : "log",
                      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.geo.sql.out&message=${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
                    }, {
                      "name" : "process",
                      "nodeId" : "6efef545-bef4-494c-b52f-ae95b97ceaf7",
                      "description" : "Format Response",
                      "properties" : {
                        "_type" : "process",
                        "active" : true,
                        "camelGroup" : "transform",
                        "code" : "HashMap<String, Object> geoResult = (HashMap)exchange.getIn().getBody();\nif (geoResult.get(\"agency_id\") == null && exchange.getProperty(\"agencyId\") != null) {\n\tgeoResult.put(\"agency_id\", (String)exchange.getProperty(\"agencyId\"));\n\texchange.getIn().setBody(geoResult);\n}",
                        "import" : "// import org.apache.camel.Message",
                        "name" : "process",
                        "url" : ""
                      },
                      "_type" : "process",
                      "kameletPropertiesUrl" : "?code=HashMap<String, Object> geoResult = (HashMap)exchange.getIn().getBody();\nif (geoResult.get(\"agency_id\") == null && exchange.getProperty(\"agencyId\") != null) {\n\tgeoResult.put(\"agency_id\", (String)exchange.getProperty(\"agencyId\"));\n\texchange.getIn().setBody(geoResult);\n}&import=// import org.apache.camel.Message"
                    }, {
                      "name" : "setHeaders",
                      "nodeId" : "8ca218dd-a0eb-4c3e-941c-e93113dd5603",
                      "description" : "HTTP201",
                      "properties" : {
                        "_type" : "setHeaders",
                        "active" : true,
                        "addNamespaces" : false,
                        "camelGroup" : "core",
                        "headerList" : [ {
                          "headerName" : "CamelHttpResponseCode",
                          "headerValue" : "201",
                          "language" : "Constant",
                          "uuid" : "6aedb42f-5b86-4f07-bba4-30619397378e"
                        } ],
                        "name" : "setHeaders",
                        "namespaces" : [ ],
                        "suppressExceptions" : false,
                        "url" : ""
                      },
                      "_type" : "setHeaders",
                      "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
                    }, {
                      "name" : "dslProcessor",
                      "nodeId" : "3c16804a-affc-4caa-9368-1b5a0836430f",
                      "description" : "Render Response",
                      "properties" : {
                        "_type" : "dslProcessor",
                        "active" : true,
                        "camelGroup" : "core",
                        "dsl" : ".bean('renderResponse')",
                        "name" : "dslProcessor",
                        "url" : ""
                      },
                      "_type" : "dslProcessor",
                      "kameletPropertiesUrl" : "?dsl=.bean('renderResponse')"
                    }, {
                      "name" : "seda",
                      "nodeId" : "ae7ed2ab-2185-4dbf-880c-5398448187f7",
                      "description" : "enqueue-event",
                      "properties" : {
                        "_type" : "seda",
                        "active" : true,
                        "advancedParameters" : [ ],
                        "blockWhenFull" : false,
                        "camelGroup" : "core",
                        "concurrentConsumers" : "1",
                        "endpointName" : "enqueue-event",
                        "limitConcurrentConsumers" : true,
                        "multipleConsumers" : false,
                        "name" : "seda",
                        "pollTimeout" : "1000",
                        "size" : "1000",
                        "specifyMaximumCapacitySize" : false,
                        "timeout" : "30000",
                        "toDynamicEndpoint" : false,
                        "url" : "",
                        "waitForTaskToComplete" : "Never"
                      },
                      "_type" : "seda",
                      "kameletPropertiesUrl" : "?blockWhenFull=false&concurrentConsumers=1&endpointName=enqueue-event&limitConcurrentConsumers=true&multipleConsumers=false&pollTimeout=1000&size=1000&specifyMaximumCapacitySize=false&timeout=30000&waitForTaskToComplete=Never"
                    } ],
                    "properties" : { }
                  }, {
                    "type" : "when",
                    "label" : "update",
                    "route" : [ {
                      "name" : "messagingEndpoint",
                      "nodeId" : "f6cd54ea-5920-4dab-88b6-225e76974fb8",
                      "description" : "SQL Update Geoloc",
                      "properties" : {
                        "_type" : "messagingEndpoint",
                        "active" : true,
                        "camelGroup" : "core",
                        "name" : "messagingEndpoint",
                        "toDynamicEndpoint" : false,
                        "uri" : "sql:UPDATE geolocations SET hat = :#${exchangeProperty.hat}, hat_accuracy = :#${exchangeProperty.hatAccuracy}, updated_at = NOW() WHERE id = CAST(:#${exchangeProperty.geolocationId} AS uuid) RETURNING id AS geolocation_id, recipient_id, ST_X(geog::geometry) AS lng, ST_Y(geog::geometry) AS lat, latlng_accuracy, latlng_uncertainty, normalized_address, altitude, altitude_accuracy, hat, hat_accuracy, created_at, updated_at?dataSource=#dsPostgres",
                        "url" : ""
                      },
                      "_type" : "messagingEndpoint",
                      "kameletPropertiesUrl" : "?uri=sql:UPDATE geolocations SET hat = :#${exchangeProperty.hat}, hat_accuracy = :#${exchangeProperty.hatAccuracy}, updated_at = NOW() WHERE id = CAST(:#${exchangeProperty.geolocationId} AS uuid) RETURNING id AS geolocation_id, recipient_id, ST_X(geog::geometry) AS lng, ST_Y(geog::geometry) AS lat, latlng_accuracy, latlng_uncertainty, normalized_address, altitude, altitude_accuracy, hat, hat_accuracy, created_at, updated_at?dataSource=#dsPostgres"
                    } ],
                    "properties" : {
                      "addNamespaces" : "false",
                      "condition" : "${exchangeProperty.geolocationId} != null",
                      "language" : "Simple",
                      "namespaces" : [ ],
                      "suppressExceptions" : "false"
                    }
                  }, {
                    "type" : "otherwise",
                    "label" : "create",
                    "route" : [ {
                      "name" : "dslProcessor",
                      "nodeId" : "3c61e158-c1b9-45f2-8f21-dcdad7ff85dd",
                      "description" : "SQL Add Geoloc",
                      "properties" : {
                        "_type" : "dslProcessor",
                        "active" : true,
                        "camelGroup" : "core",
                        "dsl" : ".to(\"sql:classpath:geolocations.insert.sql?dataSource=#dsPostgres\")",
                        "name" : "dslProcessor",
                        "url" : ""
                      },
                      "_type" : "dslProcessor",
                      "kameletPropertiesUrl" : "?dsl=.to(\"sql:classpath:geolocations.insert.sql?dataSource=#dsPostgres\")"
                    } ],
                    "properties" : { }
                  } ],
                  "kameletPropertiesUrl" : ""
                } ],
                "properties" : { }
              } ],
              "kameletPropertiesUrl" : ""
            } ],
            "properties" : { }
          }, {
            "type" : "filter",
            "label" : "RowCount==0",
            "route" : [ {
              "name" : "setBody",
              "nodeId" : "4cb6abf3-cf3b-4dcd-bcef-cd6a3cee83e9",
              "description" : "Set Recipient JSON",
              "properties" : {
                "_type" : "setBody",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "expression" : "{\"number\": \"${exchangeProperty.recipientNumberOrId}\"}",
                "language" : "Simple",
                "name" : "setBody",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setBody",
              "kameletPropertiesUrl" : "?addNamespaces=false&expression={\"number\": \"${exchangeProperty.recipientNumberOrId}\"}&language=Simple&suppressExceptions=false"
            }, {
              "name" : "direct",
              "nodeId" : "3382e8e2-ba15-4995-af0f-82a92f790e31",
              "description" : "Create Recipient",
              "properties" : {
                "_type" : "direct",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "core",
                "endpointName" : "createRecipient",
                "name" : "direct",
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "direct",
              "kameletPropertiesUrl" : "?endpointName=createRecipient"
            }, {
              "name" : "setProperties",
              "nodeId" : "ea2e0d49-68e7-47f9-87ce-0ce72ec3b105",
              "description" : "Set Recip ID",
              "properties" : {
                "_type" : "setProperties",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "name" : "setProperties",
                "namespaces" : [ ],
                "propertyList" : [ {
                  "language" : "JsonPath",
                  "propertyName" : "recipientId",
                  "propertyValue" : "$.data.recipient_id",
                  "uuid" : "1f33ce2f-5f42-44bb-a0c2-dfb4bdea869a"
                } ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setProperties",
              "kameletPropertiesUrl" : "?recipientId=$.data.recipient_id&addNamespaces=false&suppressExceptions=false"
            } ],
            "properties" : {
              "addNamespaces" : "false",
              "condition" : "${header.CamelSqlRowCount} == 0",
              "language" : "Simple",
              "namespaces" : [ ],
              "suppressExceptions" : "false"
            }
          } ],
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : { }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-15",
    "enabled" : true,
    "routeId" : 15,
    "route" : [ {
      "name" : "putRequest",
      "nodeId" : "67336feb-1593-43fc-b9e6-372b6ec57e48",
      "description" : "updateRecipientLanguage",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/recipients/{numberOrId}/dialect/{language}",
        "method" : "put",
        "name" : "putRequest",
        "operationName" : "updateRecipientLanguage",
        "produces" : "application/json",
        "requestmethod" : "PUT",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/recipients/{numberOrId}/dialect/{language}&method=put&operationName=updateRecipientLanguage&produces=application/json&requestmethod=PUT"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "95ae0116-aba8-433c-b61b-a8b4e040f679",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "106ea894-02a4-4a00-8d79-9dc74380b6ed",
      "description" : "Validate Request",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n  .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}')\t\n        .stop()\n    .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n  .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}')\t\n        .stop()\n    .end()"
    }, {
      "name" : "setProperties",
      "nodeId" : "62bf4fc2-d999-4dc4-993e-53b45b847b07",
      "description" : "Set Input Params",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Header",
          "propertyName" : "agencyId",
          "propertyValue" : "x-agency-id",
          "uuid" : "4c6a9288-ee48-437a-a9d6-4ecccde8b05f"
        }, {
          "language" : "Header",
          "propertyName" : "recipientId",
          "propertyValue" : "recipientId",
          "uuid" : "5639d7ce-1166-417e-a624-b2731c7c4d8e"
        }, {
          "language" : "Header",
          "propertyName" : "language",
          "propertyValue" : "language",
          "uuid" : "60d43cb5-b6f6-45ca-9865-9ec4efd1d4a4"
        } ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?agencyId=x-agency-id&recipientId=recipientId&language=language&addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "log",
      "nodeId" : "6ce45730-d580-4af6-9531-35aec27ef039",
      "description" : "208.api.recip.lang.in",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "INFO",
        "logType" : "EIP",
        "loggerName" : "208.api.recip.lang.in",
        "message" : "PUT ${header.CamelHttpPath}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.recip.lang.in&message=PUT ${header.CamelHttpPath}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "direct",
      "nodeId" : "e5c26d41-c96c-46cd-9d3d-3e849ef73ca8",
      "description" : "Get Recipient",
      "properties" : {
        "_type" : "direct",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "core",
        "endpointName" : "getRecipientByNumberOrId",
        "name" : "direct",
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "direct",
      "kameletPropertiesUrl" : "?endpointName=getRecipientByNumberOrId"
    }, {
      "name" : "messageFilter",
      "nodeId" : "7602f9a4-35bc-4691-9993-ab0e1bb82720",
      "description" : "Exists?",
      "properties" : {
        "_type" : "messageFilter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageFilter",
        "url" : ""
      },
      "_type" : "messageFilter",
      "branches" : [ {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "dslProcessor",
          "nodeId" : "2dec60a2-ca31-4556-ae84-467c50be04b1",
          "description" : "Remove Headers",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".removeHeaders(\"*\", \"x-*\", \"Authorization\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-*\", \"Authorization\")"
        }, {
          "name" : "setProperties",
          "nodeId" : "e6ffdc01-bd28-4ecb-b9c5-ccea92fae33c",
          "description" : "Get Current Language",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "JsonPath",
              "propertyName" : "currentLanguage",
              "propertyValue" : "$.data.language",
              "uuid" : "8054d904-c3d6-4b5f-8c1e-d855d692dc69"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?currentLanguage=$.data.language&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "messagingEndpoint",
          "nodeId" : "618264fc-8554-49e3-94d0-4cdf97c96122",
          "description" : "SQL Validate Language",
          "properties" : {
            "_type" : "messagingEndpoint",
            "active" : true,
            "camelGroup" : "core",
            "name" : "messagingEndpoint",
            "toDynamicEndpoint" : false,
            "uri" : "sql:SELECT code FROM dialects WHERE code = :#${exchangeProperty.language} AND active IS TRUE LIMIT 1?dataSource=#dsPostgres&OutputType=SelectOne",
            "url" : ""
          },
          "_type" : "messagingEndpoint",
          "kameletPropertiesUrl" : "?uri=sql:SELECT code FROM dialects WHERE code = :#${exchangeProperty.language} AND active IS TRUE LIMIT 1?dataSource=#dsPostgres&OutputType=SelectOne"
        }, {
          "name" : "messageRouter",
          "nodeId" : "273d10e1-7465-4a09-b7ea-bfa4baca86f8",
          "description" : "",
          "properties" : {
            "_type" : "messageRouter",
            "active" : true,
            "camelGroup" : "routing",
            "name" : "messageRouter",
            "url" : ""
          },
          "_type" : "messageRouter",
          "branches" : [ {
            "type" : "route",
            "label" : "route",
            "route" : [ {
              "name" : "messagingEndpoint",
              "nodeId" : "ce515bb2-a554-4438-859a-999be1fbadf5",
              "description" : "SQL Update Lang",
              "properties" : {
                "_type" : "messagingEndpoint",
                "active" : true,
                "camelGroup" : "core",
                "name" : "messagingEndpoint",
                "toDynamicEndpoint" : false,
                "uri" : "sql:UPDATE recipients SET language = :#${exchangeProperty.language} WHERE id = CAST(:#${exchangeProperty.recipientId} AS uuid) AND agency_id = CAST(:#${exchangeProperty.agencyId} AS uuid)?dataSource=#dsPostgres",
                "url" : ""
              },
              "_type" : "messagingEndpoint",
              "kameletPropertiesUrl" : "?uri=sql:UPDATE recipients SET language = :#${exchangeProperty.language} WHERE id = CAST(:#${exchangeProperty.recipientId} AS uuid) AND agency_id = CAST(:#${exchangeProperty.agencyId} AS uuid)?dataSource=#dsPostgres"
            }, {
              "name" : "setHeaders",
              "nodeId" : "ea679d7a-f99b-4ae6-aff7-ac33118479e3",
              "description" : "Set Recipient ID",
              "properties" : {
                "_type" : "setHeaders",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "headerList" : [ {
                  "headerName" : "numberOrId",
                  "headerValue" : "${exchangeProperty.recipientId}",
                  "language" : "Simple",
                  "uuid" : "7ad4b287-26eb-499d-984f-c6e3c2ec7d87"
                } ],
                "name" : "setHeaders",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setHeaders",
              "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "direct",
              "nodeId" : "6d0e512f-90d4-4b78-abe1-7351105fab7f",
              "description" : "Get Recipient",
              "properties" : {
                "_type" : "direct",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "core",
                "endpointName" : "getRecipientByNumberOrId",
                "name" : "direct",
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "direct",
              "kameletPropertiesUrl" : "?endpointName=getRecipientByNumberOrId"
            }, {
              "name" : "setBody",
              "nodeId" : "b151636b-d784-45d3-b6f7-f4b7a82fa489",
              "description" : "Set JSON Response",
              "properties" : {
                "_type" : "setBody",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "expression" : "$.data",
                "language" : "JsonPath",
                "name" : "setBody",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setBody",
              "kameletPropertiesUrl" : "?addNamespaces=false&expression=$.data&language=JsonPath&suppressExceptions=false"
            }, {
              "name" : "dslProcessor",
              "nodeId" : "4343a277-e972-49dd-8052-b2ca350a069f",
              "description" : "Render Response",
              "properties" : {
                "_type" : "dslProcessor",
                "active" : true,
                "camelGroup" : "core",
                "dsl" : ".bean('renderResponse')",
                "name" : "dslProcessor",
                "url" : ""
              },
              "_type" : "dslProcessor",
              "kameletPropertiesUrl" : "?dsl=.bean('renderResponse')"
            }, {
              "name" : "log",
              "nodeId" : "29efe810-724e-4e5a-90b0-745530af80b4",
              "description" : "208.api.lang.out",
              "properties" : {
                "_type" : "log",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "component",
                "level" : "INFO",
                "logType" : "EIP",
                "loggerName" : "208.api.lang.out",
                "message" : "(${header.CamelHttpResponseCode}) ${body}",
                "multiline" : false,
                "name" : "log",
                "showAll" : false,
                "showBody" : true,
                "showBodyType" : true,
                "showCaughtException" : false,
                "showExchangeId" : false,
                "showHeaders" : false,
                "showProperties" : false,
                "showStackTrace" : false,
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "log",
              "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.lang.out&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
            }, {
              "name" : "seda",
              "nodeId" : "a2443d68-5a79-48f0-88ba-9f452385f99a",
              "description" : "enqueue-event",
              "properties" : {
                "_type" : "seda",
                "active" : true,
                "advancedParameters" : [ ],
                "blockWhenFull" : false,
                "camelGroup" : "core",
                "concurrentConsumers" : "1",
                "endpointName" : "enqueue-event",
                "limitConcurrentConsumers" : true,
                "multipleConsumers" : false,
                "name" : "seda",
                "pollTimeout" : "1000",
                "size" : "1000",
                "specifyMaximumCapacitySize" : false,
                "timeout" : "30000",
                "toDynamicEndpoint" : false,
                "url" : "",
                "waitForTaskToComplete" : "Never"
              },
              "_type" : "seda",
              "kameletPropertiesUrl" : "?blockWhenFull=false&concurrentConsumers=1&endpointName=enqueue-event&limitConcurrentConsumers=true&multipleConsumers=false&pollTimeout=1000&size=1000&specifyMaximumCapacitySize=false&timeout=30000&waitForTaskToComplete=Never"
            } ],
            "properties" : { }
          }, {
            "type" : "when",
            "label" : "rowcount==0",
            "route" : [ {
              "name" : "setProperties",
              "nodeId" : "10a92d03-b449-4c9e-a4f7-efd17f175fd1",
              "description" : "Set Error",
              "properties" : {
                "_type" : "setProperties",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "name" : "setProperties",
                "namespaces" : [ ],
                "propertyList" : [ {
                  "language" : "Simple",
                  "propertyName" : "error",
                  "propertyValue" : "Language ${exchangeProperty.language} not found",
                  "uuid" : "528b6ea3-c23a-4854-86e8-8dd76d53a829"
                } ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setProperties",
              "kameletPropertiesUrl" : "?error=Language ${exchangeProperty.language} not found&addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "direct",
              "nodeId" : "bc3f850e-a20f-4864-86bf-a76adaee4051",
              "description" : "http-404",
              "properties" : {
                "_type" : "direct",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "core",
                "endpointName" : "http-404",
                "name" : "direct",
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "direct",
              "kameletPropertiesUrl" : "?endpointName=http-404"
            } ],
            "properties" : {
              "addNamespaces" : "false",
              "condition" : "${header.CamelSqlRowCount} == 0",
              "language" : "Simple",
              "namespaces" : [ ],
              "suppressExceptions" : "false"
            }
          }, {
            "type" : "when",
            "label" : "304",
            "route" : [ {
              "name" : "setHeaders",
              "nodeId" : "29a6bfaa-8f71-45e2-a0c3-8555eb657fef",
              "description" : "HTTP304",
              "properties" : {
                "_type" : "setHeaders",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "headerList" : [ {
                  "headerName" : "CamelHttpResponseCode",
                  "headerValue" : "304",
                  "language" : "Constant",
                  "uuid" : "0df56085-a800-4a83-9d3e-f8fe21e3c07d"
                } ],
                "name" : "setHeaders",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setHeaders",
              "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "clearBody",
              "nodeId" : "85ec05f2-c358-4c6e-8149-884affc0bf8e",
              "description" : "",
              "properties" : {
                "_type" : "clearBody",
                "camelGroup" : "core",
                "name" : "clearBody",
                "url" : ""
              },
              "_type" : "clearBody",
              "kameletPropertiesUrl" : ""
            }, {
              "name" : "stop",
              "nodeId" : "1d081d18-c26c-49b7-b351-14ed0b8350f3",
              "description" : "",
              "properties" : {
                "_type" : "stop",
                "camelGroup" : "misc",
                "name" : "stop",
                "url" : ""
              },
              "_type" : "stop",
              "kameletPropertiesUrl" : ""
            } ],
            "properties" : {
              "addNamespaces" : "false",
              "condition" : "${exchangeProperty.currentLanguage} == ${exchangeProperty.language}",
              "language" : "Simple",
              "namespaces" : [ ],
              "suppressExceptions" : "false"
            }
          } ],
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : { }
      }, {
        "type" : "filter",
        "label" : "404",
        "route" : [ {
          "name" : "setProperties",
          "nodeId" : "7a6b2223-0869-485c-8ccf-0909162fe700",
          "description" : "Set Error",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Constant",
              "propertyName" : "error",
              "propertyValue" : "Recipient Not Found",
              "uuid" : "1be5775c-4328-486b-a3c8-917391794bde"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?error=Recipient Not Found&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "direct",
          "nodeId" : "608f3a27-afb2-4fbb-b393-09a6f49fc763",
          "description" : "http-404",
          "properties" : {
            "_type" : "direct",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "core",
            "endpointName" : "http-404",
            "name" : "direct",
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "direct",
          "kameletPropertiesUrl" : "?endpointName=http-404"
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${header.CamelHttpResponseCode} == 404",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-16",
    "enabled" : true,
    "routeId" : 16,
    "route" : [ {
      "name" : "direct",
      "nodeId" : "c5c0d959-ff1f-43e9-9682-fa1db47e4a61",
      "description" : "http-404",
      "properties" : {
        "_type" : "direct",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "core",
        "endpointName" : "http-404",
        "name" : "direct",
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "direct",
      "kameletPropertiesUrl" : "?endpointName=http-404"
    }, {
      "name" : "setHeaders",
      "nodeId" : "dd16f253-6188-4243-89f2-76bc015684fb",
      "description" : "HTTP404",
      "properties" : {
        "_type" : "setHeaders",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "headerList" : [ {
          "headerName" : "CamelHttpResponseCode",
          "headerValue" : "404",
          "language" : "Constant",
          "uuid" : "94b6cdf1-6a13-4929-a9eb-a90ae10cfb87"
        } ],
        "name" : "setHeaders",
        "namespaces" : [ ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setHeaders",
      "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "424bd3e3-009e-481c-9472-2cceb373fd7d",
      "description" : "Render Response",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('renderResponse')",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('renderResponse')"
    }, {
      "name" : "log",
      "nodeId" : "5d95c24f-dbec-4828-9a56-24df558e11c4",
      "description" : "208.api.lang.404",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "INFO",
        "logType" : "EIP",
        "loggerName" : "208.api.lang.404",
        "message" : "(${header.CamelHttpResponseCode}) ${body}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=208.api.lang.404&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "stop",
      "nodeId" : "a6753dd3-8513-4e55-94a4-a9bd70dc1d55",
      "description" : "",
      "properties" : {
        "_type" : "stop",
        "camelGroup" : "misc",
        "name" : "stop",
        "url" : ""
      },
      "_type" : "stop",
      "kameletPropertiesUrl" : ""
    } ]
  } ],
  "traits" : [ {
    "name" : "health",
    "configuration" : {
      "enabled" : true,
      "livenessProbeEnabled" : true,
      "readinessProbeEnabled" : true
    }
  } ],
  "id" : "31219292-f0c8-4ba0-ab29-182ec56c2656",
  "name" : "r208-recipients-api",
  "description" : "Recipients API",
  "createdAt" : "2023-10-04T18:05:08.140049785",
  "updatedAt" : "2023-10-04T18:05:08.140050479",
  "createdBy" : "612c1b37-217d-49f9-b344-54b8af760f6a",
  "updatedBy" : "612c1b37-217d-49f9-b344-54b8af760f6a"
}