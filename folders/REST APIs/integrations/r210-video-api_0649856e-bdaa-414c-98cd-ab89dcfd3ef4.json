{
  "revision" : 833,
  "compression" : false,
  "dataAnalyzer" : true,
  "replicas" : 1,
  "openApiUuid" : "fbd20cea-454b-4c64-a8cc-26ed7c971175",
  "currentProfileUuid" : "62c1cde5-30f6-41d5-8c08-26ffb86e3053",
  "parameterGroupUuids" : [ "e1d81a6a-655e-42ff-8288-6b0891abe7b0", "3dacce84-b8c8-4759-8bfa-355c8cf6acd6", "ca06b01a-b205-4b2b-9e9d-9f49614e7e94", "c9a8ecf3-391c-4a06-bdc0-68a1a504fdd9", "351ac858-4e6b-4902-9090-0be62c4dc9e0", "83d26985-9100-4993-8115-ced44d1fe3fd" ],
  "repoResourceUuids" : [ "07e34d9c-7cea-4532-94e6-7da0f6bddeb3", "2d21c0b9-a829-4420-84e6-67d34aaf6026", "0d41f9ca-58b0-434f-a68e-5855e59f3249", "fedc2ba8-c348-4a92-a89c-844badda8f1f", "05649865-0c5a-4bfd-bddb-046f69383940", "a1057428-1531-40a8-a129-ed27382e947f", "3b5aa833-0eaa-4cb9-8ce8-ca97eac74110", "71e48dda-80e9-4034-af48-cf39a9a10938", "60b1161c-74ee-4cd8-96a1-0055c90271c1", "9fb5f9ac-54fb-4ea4-b9d6-a3f95d92021b", "55882383-5e69-44b0-a3ac-12785e306303", "f50d9293-f6bf-47b6-b21e-4cfda6eee3c4", "1872a943-2a9b-4513-8739-06e95090b977", "38657aaf-c7a4-4a04-9321-bb750c2e67b5", "bedce8c4-3d73-4efa-9812-02c3b99902c8", "e859d27c-054e-489d-96ef-1338b179fde7", "262f29f1-88a5-47d1-8bd0-87649ed20bc9", "eddb9cf2-828c-4bf6-a038-93128340a0c2", "17e7ca54-4247-4e9c-ba30-d078e3ac407a", "ba2f528b-dc7e-4639-81e6-08d74ed54b93", "1e6a1bf6-e377-40be-9daf-d287ece428e0" ],
  "routeDefinitions" : [ {
    "id" : null,
    "camelRouteId" : "route-1",
    "enabled" : true,
    "routeId" : 1,
    "route" : [ {
      "name" : "postRequest",
      "nodeId" : "b8db9807-ef09-4f0e-b333-f5ba7d131eb7",
      "description" : "createVideoRoom",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/videorooms",
        "method" : "post",
        "name" : "postRequest",
        "operationName" : "createVideoRoom",
        "produces" : "application/json",
        "requestmethod" : "POST",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/videorooms&method=post&operationName=createVideoRoom&produces=application/json&requestmethod=POST"
    }, {
      "name" : "convertBodyTo",
      "nodeId" : "967ba4d4-3b38-4d5e-9986-9a405a01dd12",
      "description" : "To String",
      "properties" : {
        "_type" : "convertBodyTo",
        "active" : true,
        "camelGroup" : "transform",
        "name" : "convertBodyTo",
        "targetClass" : "String.class",
        "url" : ""
      },
      "_type" : "convertBodyTo",
      "kameletPropertiesUrl" : "?targetClass=String.class"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "8892db99-4866-4b7b-9d93-84ae88366745",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "2562230e-2330-403c-b2ef-c5b98b66ebfa",
      "description" : "Validate Request",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean(\"validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n    .bean('renderResponse')\n    .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    .stop()\n    .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean(\"validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n    .bean('renderResponse')\n    .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    .stop()\n    .end()"
    }, {
      "name" : "log",
      "nodeId" : "73db12d4-1e20-4f0f-a2c5-12d4d1866f51",
      "description" : "210.api.create.in",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "INFO",
        "logType" : "EIP",
        "loggerName" : "210.api.create.in",
        "message" : "${body}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.api.create.in&message=${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "setProperties",
      "nodeId" : "2968977f-6d1e-499e-bd15-b04692cf84f2",
      "description" : "Get Input Params",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "JsonPath",
          "propertyName" : "roomName",
          "propertyValue" : "$.room_name",
          "uuid" : "df0397bf-30b3-4d79-9136-e8e87b50a99c"
        }, {
          "language" : "JsonPath",
          "propertyName" : "conversationId",
          "propertyValue" : "$.conversation_id",
          "uuid" : "34cdef2d-bc71-4164-a5b9-246b8926eda9"
        }, {
          "language" : "Header",
          "propertyName" : "agencyId",
          "propertyValue" : "x-agency-id",
          "uuid" : "b1737fc1-4cc8-4e3e-8352-7f0c5db30b8d"
        }, {
          "language" : "Simple",
          "propertyName" : "x-authorized",
          "propertyValue" : "true",
          "uuid" : "d084b3d3-e94b-4f25-ad53-1043a5c2e8f4"
        }, {
          "language" : "Constant",
          "propertyName" : "provider",
          "propertyValue" : "twilio",
          "uuid" : "cc5e1de9-13da-4d96-9370-0dbfe64e301e"
        }, {
          "language" : "JsonPath",
          "propertyName" : "record",
          "propertyValue" : "$.record",
          "uuid" : "a7996430-d1c3-4c01-a74c-9d4a377f7be4"
        }, {
          "language" : "JsonPath",
          "propertyName" : "transcribe",
          "propertyValue" : "$.transcription",
          "uuid" : "d3ddb8f5-2af8-4d9c-8d9c-8b6d33756e36"
        } ],
        "suppressExceptions" : true,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?roomName=$.room_name&conversationId=$.conversation_id&agencyId=x-agency-id&x-authorized=true&provider=twilio&record=$.record&transcribe=$.transcription&addNamespaces=false&suppressExceptions=true"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "0323de1e-2628-401b-910f-d9e43f68f452",
      "description" : "Remove Headers",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".removeHeaders(\"*\",\"x-*\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\",\"x-*\")"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "c202d3b9-b91d-4800-8566-c8c0a853ed4f",
      "description" : "SQL Create Video Room",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"sql:classpath:video_rooms.insert.sql?dataSource=#dsPostgres\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"sql:classpath:video_rooms.insert.sql?dataSource=#dsPostgres\")"
    }, {
      "name" : "setProperties",
      "nodeId" : "0f0b5837-4754-4cb3-ada5-5b97bc9c5b90",
      "description" : "Set Room ID",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Simple",
          "propertyName" : "roomId",
          "propertyValue" : "${body[0][room_id]}",
          "uuid" : "f71a1810-dd42-49da-80c1-b740928290f2"
        } ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?roomId=${body[0][room_id]}&addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "log",
      "nodeId" : "d1a4badf-f54c-407b-98c0-61bd4b6b9dd0",
      "description" : "210.api.create.sql.out",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "INFO",
        "logType" : "EIP",
        "loggerName" : "210.api.create.sql.out",
        "message" : "(${header.CamelSqlRowCount}) ${body}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.api.create.sql.out&message=(${header.CamelSqlRowCount}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "messageRouter",
      "nodeId" : "8497b07d-acdd-498a-a522-19e7f2e56cfc",
      "description" : "",
      "properties" : {
        "_type" : "messageRouter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageRouter",
        "url" : ""
      },
      "_type" : "messageRouter",
      "branches" : [ {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "dslProcessor",
          "nodeId" : "5a855acb-b45b-4d8f-a9e2-e50998e0838a",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean(\"renderResponse\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
        }, {
          "name" : "seda",
          "nodeId" : "74a56c8e-8b67-451e-a703-1ec9a2ed4563",
          "description" : "publish-event",
          "properties" : {
            "_type" : "seda",
            "active" : true,
            "advancedParameters" : [ ],
            "blockWhenFull" : false,
            "camelGroup" : "core",
            "concurrentConsumers" : "1",
            "endpointName" : "publish-event",
            "limitConcurrentConsumers" : true,
            "multipleConsumers" : false,
            "name" : "seda",
            "pollTimeout" : "1000",
            "size" : "1000",
            "specifyMaximumCapacitySize" : false,
            "timeout" : "30000",
            "toDynamicEndpoint" : false,
            "url" : "",
            "waitForTaskToComplete" : "Never"
          },
          "_type" : "seda",
          "kameletPropertiesUrl" : "?blockWhenFull=false&concurrentConsumers=1&endpointName=publish-event&limitConcurrentConsumers=true&multipleConsumers=false&pollTimeout=1000&size=1000&specifyMaximumCapacitySize=false&timeout=30000&waitForTaskToComplete=Never"
        }, {
          "name" : "log",
          "nodeId" : "5ecc2e16-eb2c-4676-a253-76dc4503e211",
          "description" : "210.api.create.out",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "210.api.create.out",
            "message" : "(${header.CamelHttpResponseCode}) ${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.api.create.out&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        } ],
        "properties" : { }
      }, {
        "type" : "otherwise",
        "label" : "otherwise",
        "route" : [ {
          "name" : "setBody",
          "nodeId" : "b57b2276-27ac-4441-93e8-fcb75e3ec96b",
          "description" : "Set Error Message",
          "properties" : {
            "_type" : "setBody",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "expression" : "$.data.error",
            "language" : "JsonPath",
            "name" : "setBody",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setBody",
          "kameletPropertiesUrl" : "?addNamespaces=false&expression=$.data.error&language=JsonPath&suppressExceptions=false"
        } ],
        "properties" : { }
      }, {
        "type" : "when",
        "label" : "OK",
        "route" : [ {
          "name" : "process",
          "nodeId" : "9785f29a-cc1b-4846-86f6-460d84885316",
          "description" : "Set Video Request",
          "properties" : {
            "_type" : "process",
            "active" : true,
            "camelGroup" : "transform",
            "code" : "ObjectMapper jackson = new ObjectMapper();\n\nHashMap<String, Object> request = new HashMap<String, Object>() {{\n\tput(\"room_id\", (String)exchange.getProperty(\"roomId\"));\n\tput(\"room_name\", (String)exchange.getProperty(\"roomName\"))\n\tput(\"record\", (Boolean)exchange.getProperty(\"record\"));\n}};\n\nexchange.getIn().setBody(jackson.writeValueAsString(request));",
            "import" : "import com.fasterxml.jackson.databind.ObjectMapper;",
            "name" : "process",
            "url" : ""
          },
          "_type" : "process",
          "kameletPropertiesUrl" : "?code=ObjectMapper jackson = new ObjectMapper();\n\nHashMap<String, Object> request = new HashMap<String, Object>() {{\n\tput(\"room_id\", (String)exchange.getProperty(\"roomId\"));\n\tput(\"room_name\", (String)exchange.getProperty(\"roomName\"))\n\tput(\"record\", (Boolean)exchange.getProperty(\"record\"));\n}};\n\nexchange.getIn().setBody(jackson.writeValueAsString(request));&import=import com.fasterxml.jackson.databind.ObjectMapper;"
        }, {
          "name" : "setBody",
          "nodeId" : "30b0ff60-df78-4fca-b770-9dc04c55ce21",
          "description" : "Set JMS Request",
          "properties" : {
            "_type" : "setBody",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "expression" : "{\"room_id\": \"${exchangeProperty.roomId}\", \"room_name\": \"${exchangeProperty.roomName}\", \"record\": \"${exchangeProperty.record}\"}",
            "language" : "Simple",
            "name" : "setBody",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setBody",
          "kameletPropertiesUrl" : "?addNamespaces=false&expression={\"room_id\": \"${exchangeProperty.roomId}\", \"room_name\": \"${exchangeProperty.roomName}\", \"record\": \"${exchangeProperty.record}\"}&language=Simple&suppressExceptions=false"
        }, {
          "name" : "setHeaders",
          "nodeId" : "bb5a2f45-2f3c-44df-9505-d957fb08c25c",
          "description" : "Set JMS Dest & Room ID",
          "properties" : {
            "_type" : "setHeaders",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "headerList" : [ {
              "headerName" : "roomId",
              "headerValue" : "${exchangeProperty.roomId}",
              "language" : "Simple",
              "uuid" : "d6c13181-06ab-4b88-b1b0-ae1cac97dc6e"
            }, {
              "headerName" : "CamelJmsDestinationName",
              "headerValue" : "providers.video.${exchangeProperty.provider}",
              "language" : "Simple",
              "uuid" : "d67ab4a3-c3dc-40d9-bd09-db9191603abb"
            }, {
              "headerName" : "x-requested-operation",
              "headerValue" : "create-room",
              "language" : "Constant",
              "uuid" : "267f8c9a-a6c2-4d90-bf04-6caf01dc3a7e"
            } ],
            "name" : "setHeaders",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setHeaders",
          "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "exchangePattern",
          "nodeId" : "dfa07768-5b12-4e8b-9860-8021dabb860a",
          "description" : "InOut",
          "properties" : {
            "_type" : "exchangePattern",
            "active" : true,
            "camelGroup" : "core",
            "exchangePattern" : "InOut",
            "name" : "exchangePattern",
            "url" : ""
          },
          "_type" : "exchangePattern",
          "kameletPropertiesUrl" : "?exchangePattern=InOut"
        }, {
          "name" : "log",
          "nodeId" : "f314e49b-41b0-4978-9709-25709457443f",
          "description" : "210.api.create.jms.in",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "210.api.create.jms.in",
            "message" : "${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.api.create.jms.in&message=${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "jms",
          "nodeId" : "05c030a2-bd0b-475d-81a2-8bd9c284b2ca",
          "description" : "providers.{prvdr}.video",
          "properties" : {
            "_type" : "jms",
            "active" : true,
            "advancedParameters" : [ ],
            "asyncConsumer" : false,
            "camelGroup" : "component",
            "concurrentConsumers" : "1",
            "connectionFactory" : "#pooledConnectionFactory",
            "destinationName" : "queue.dummy",
            "destinationType" : "queue",
            "exchangePattern" : "InOnly",
            "name" : "jms",
            "setConnectionFactory" : true,
            "toDynamicEndpoint" : false,
            "transacted" : false,
            "url" : ""
          },
          "_type" : "jms",
          "kameletPropertiesUrl" : "?asyncConsumer=false&concurrentConsumers=1&connectionFactory=#pooledConnectionFactory&destinationName=queue.dummy&destinationType=queue&exchangePattern=InOnly&setConnectionFactory=true&transacted=false"
        }, {
          "name" : "log",
          "nodeId" : "130a42f8-a80a-4509-9525-e04e1fdda1ba",
          "description" : "210.api.create.jms.out",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "210.api.create.jms.out",
            "message" : "(${header.CamelHttpResponseCode}) ${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.api.create.jms.out&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "setProperties",
          "nodeId" : "26e93484-bc9d-4bc8-8742-40d612057abf",
          "description" : "Get Provider Params",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "JsonPath",
              "propertyName" : "resourceId",
              "propertyValue" : "$.resource_id",
              "uuid" : "2d5d963b-193c-4208-b055-41003f60d7c4"
            }, {
              "language" : "JsonPath",
              "propertyName" : "resourceUrl",
              "propertyValue" : "$.resource_url",
              "uuid" : "4ac1d6f6-4283-4723-9e2b-291f602adebc"
            }, {
              "language" : "JsonPath",
              "propertyName" : "status",
              "propertyValue" : "$.status",
              "uuid" : "deac1607-7269-4ec0-8787-fc496ae91c4e"
            }, {
              "language" : "JsonPath",
              "propertyName" : "metadata",
              "propertyValue" : "$",
              "uuid" : "8f988e0d-915b-45ad-9e84-796315a1a11f"
            }, {
              "language" : "JsonPath",
              "propertyName" : "errorCode",
              "propertyValue" : "$.error_code",
              "uuid" : "57252f3e-0d9a-4255-a629-1100bfa327d1"
            }, {
              "language" : "JsonPath",
              "propertyName" : "errorMessage",
              "propertyValue" : "$.error_message",
              "uuid" : "8d9807e1-0248-4668-8cfa-96e07c137a99"
            }, {
              "language" : "Header",
              "propertyName" : "CamelHttpResponseCode",
              "propertyValue" : "CamelHttpResponseCode",
              "uuid" : "24e663b9-58ae-4be3-b92e-6ba7e3e3ac5a"
            } ],
            "suppressExceptions" : true,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?resourceId=$.resource_id&resourceUrl=$.resource_url&status=$.status&metadata=$&errorCode=$.error_code&errorMessage=$.error_message&CamelHttpResponseCode=CamelHttpResponseCode&addNamespaces=false&suppressExceptions=true"
        }, {
          "name" : "messagingEndpoint",
          "nodeId" : "f2a4ba61-712f-408f-88c5-26a4de2196fb",
          "description" : "SQL Update Room",
          "properties" : {
            "_type" : "messagingEndpoint",
            "active" : true,
            "camelGroup" : "core",
            "name" : "messagingEndpoint",
            "toDynamicEndpoint" : false,
            "uri" : "sql:UPDATE video_rooms SET status = :#${exchangeProperty.status}, metadata = CAST(:#${exchangeProperty.metadata} AS json), resource_id = :#${exchangeProperty.resourceId}, resource_url = :#${exchangeProperty.resourceUrl}, error_code = :#${exchangeProperty.errorCode}, error_message = :#${exchangeProperty.errorMessage}, updated_at = NOW() WHERE id = CAST(:#${exchangeProperty.roomId} AS uuid)?dataSource=#dsPostgres",
            "url" : ""
          },
          "_type" : "messagingEndpoint",
          "kameletPropertiesUrl" : "?uri=sql:UPDATE video_rooms SET status = :#${exchangeProperty.status}, metadata = CAST(:#${exchangeProperty.metadata} AS json), resource_id = :#${exchangeProperty.resourceId}, resource_url = :#${exchangeProperty.resourceUrl}, error_code = :#${exchangeProperty.errorCode}, error_message = :#${exchangeProperty.errorMessage}, updated_at = NOW() WHERE id = CAST(:#${exchangeProperty.roomId} AS uuid)?dataSource=#dsPostgres"
        }, {
          "name" : "direct",
          "nodeId" : "17df1ef3-8d00-4e12-8df3-ac9668c66fbb",
          "description" : "Get Video Room",
          "properties" : {
            "_type" : "direct",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "core",
            "endpointName" : "getVideoRoomById",
            "name" : "direct",
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "direct",
          "kameletPropertiesUrl" : "?endpointName=getVideoRoomById"
        }, {
          "name" : "setBody",
          "nodeId" : "7b57e7b5-1b0e-4c2b-b1e7-2e460199a145",
          "description" : "Get Response",
          "properties" : {
            "_type" : "setBody",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "expression" : "$.data",
            "language" : "JsonPath",
            "name" : "setBody",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setBody",
          "kameletPropertiesUrl" : "?addNamespaces=false&expression=$.data&language=JsonPath&suppressExceptions=false"
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${exchangeProperty.roomId} != null",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-2",
    "enabled" : true,
    "routeId" : 2,
    "route" : [ {
      "name" : "getRequest",
      "nodeId" : "b67b1bb2-84e5-48dd-aa5c-d5b13e4e2ada",
      "description" : "getVideoRoomById",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/videorooms/{roomId}",
        "method" : "get",
        "name" : "getRequest",
        "operationName" : "getVideoRoomById",
        "produces" : "application/json",
        "requestmethod" : "GET",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/videorooms/{roomId}&method=get&operationName=getVideoRoomById&produces=application/json&requestmethod=GET"
    }, {
      "name" : "setProperties",
      "nodeId" : "e068ac77-30ab-47d9-9801-3249f465bce6",
      "description" : "Get Input Params",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Header",
          "propertyName" : "xAccessToken",
          "propertyValue" : "x-access-token",
          "uuid" : "e95925ac-1790-4bf3-bd9b-337f1b5a9f8b"
        }, {
          "language" : "Header",
          "propertyName" : "roomId",
          "propertyValue" : "roomId",
          "uuid" : "8e690e74-2bb9-47aa-8b9e-f0ae17fbf931"
        } ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?xAccessToken=x-access-token&roomId=roomId&addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "messageRouter",
      "nodeId" : "d695423e-867c-4a8f-ac87-3ae9637c4864",
      "description" : "Token Type",
      "properties" : {
        "_type" : "messageRouter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageRouter",
        "url" : ""
      },
      "_type" : "messageRouter",
      "branches" : [ {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "dslProcessor",
          "nodeId" : "4f1bf647-a81c-42d9-b550-b2fe9244ff09",
          "description" : "Remove Headers",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".removeHeaders(\"*\", \"x-*\", \"Authorization\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-*\", \"Authorization\")"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "7a28d100-5405-4a5b-8c03-25aa12b29d26",
          "description" : "SQL Get Video Room",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".to(\"velocity:video_rooms.select.sql.vm?allowContextMapAll=true\")\n.log(LoggingLevel.OFF, '210.api.get.sql.in', '${body}')\n.to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectOne&useMessageBodyForSql=true\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.to(\"velocity:video_rooms.select.sql.vm?allowContextMapAll=true\")\n.log(LoggingLevel.OFF, '210.api.get.sql.in', '${body}')\n.to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectOne&useMessageBodyForSql=true\")"
        }, {
          "name" : "messageFilter",
          "nodeId" : "acbad0e9-9cfb-4ed3-92f2-01c6218c5ca0",
          "description" : "",
          "properties" : {
            "_type" : "messageFilter",
            "active" : true,
            "camelGroup" : "routing",
            "name" : "messageFilter",
            "url" : ""
          },
          "_type" : "messageFilter",
          "branches" : [ {
            "type" : "route",
            "label" : "route",
            "route" : [ {
              "name" : "setProperties",
              "nodeId" : "5b4aad89-31af-4d30-9dfa-a1801b88eb50",
              "description" : "Store Video Room",
              "properties" : {
                "_type" : "setProperties",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "name" : "setProperties",
                "namespaces" : [ ],
                "propertyList" : [ {
                  "language" : "Simple",
                  "propertyName" : "videoRoom",
                  "propertyValue" : "${body}",
                  "uuid" : "e3cfd54c-f965-4bc1-9b99-284c7a41b5e1"
                } ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setProperties",
              "kameletPropertiesUrl" : "?videoRoom=${body}&addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "setHeaders",
              "nodeId" : "96d81830-ee18-4448-b6d2-cdac61ac9731",
              "description" : "Set x-partic-status",
              "properties" : {
                "_type" : "setHeaders",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "headerList" : [ {
                  "headerName" : "participantStatus",
                  "headerValue" : "connected",
                  "language" : "Constant",
                  "uuid" : "e5da0d71-484e-482f-ac5e-f99df6085fca"
                } ],
                "name" : "setHeaders",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setHeaders",
              "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "direct",
              "nodeId" : "6bbc2b8c-7e9a-4929-815a-6fc016805d63",
              "description" : "getParticipants",
              "properties" : {
                "_type" : "direct",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "core",
                "endpointName" : "getVideoRoomParticipants",
                "name" : "direct",
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "direct",
              "kameletPropertiesUrl" : "?endpointName=getVideoRoomParticipants"
            }, {
              "name" : "setProperties",
              "nodeId" : "72897818-94e6-4d10-b262-7f79247409c4",
              "description" : "Get Participants",
              "properties" : {
                "_type" : "setProperties",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "name" : "setProperties",
                "namespaces" : [ ],
                "propertyList" : [ {
                  "language" : "JsonPath",
                  "propertyName" : "connectedParticipants",
                  "propertyValue" : "$.data",
                  "uuid" : "1fea741f-9803-4206-a2c0-b16d308ca466"
                } ],
                "suppressExceptions" : true,
                "url" : ""
              },
              "_type" : "setProperties",
              "kameletPropertiesUrl" : "?connectedParticipants=$.data&addNamespaces=false&suppressExceptions=true"
            }, {
              "name" : "process",
              "nodeId" : "1da93d2f-c628-424c-9839-358646db191d",
              "description" : "Parse Response",
              "properties" : {
                "_type" : "process",
                "active" : true,
                "camelGroup" : "transform",
                "code" : "Object participants = exchange.getProperty(\"connectedParticipants\");\nHashMap<String, Object> videoRoom = (HashMap)exchange.getProperty(\"videoRoom\");\nvideoRoom.put(\"participants\", participants);\nexchange.getIn().setBody(videoRoom);",
                "import" : "import com.fasterxml.jackson.databind.ObjectMapper;",
                "name" : "process",
                "url" : ""
              },
              "_type" : "process",
              "kameletPropertiesUrl" : "?code=Object participants = exchange.getProperty(\"connectedParticipants\");\nHashMap<String, Object> videoRoom = (HashMap)exchange.getProperty(\"videoRoom\");\nvideoRoom.put(\"participants\", participants);\nexchange.getIn().setBody(videoRoom);&import=import com.fasterxml.jackson.databind.ObjectMapper;"
            }, {
              "name" : "dslProcessor",
              "nodeId" : "59965a90-5342-441c-831f-44d18cf598d3",
              "description" : "Render Response",
              "properties" : {
                "_type" : "dslProcessor",
                "active" : true,
                "camelGroup" : "core",
                "dsl" : ".bean(\"renderResponse\")",
                "name" : "dslProcessor",
                "url" : ""
              },
              "_type" : "dslProcessor",
              "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
            }, {
              "name" : "log",
              "nodeId" : "6939fe75-f857-484d-a3bb-ed1ba39d5795",
              "description" : "210.api.video.out",
              "properties" : {
                "_type" : "log",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "component",
                "level" : "INFO",
                "logType" : "EIP",
                "loggerName" : "210.api.video.out",
                "message" : "(${header.CamelHttpResponseCode}) ${body}",
                "multiline" : false,
                "name" : "log",
                "showAll" : false,
                "showBody" : true,
                "showBodyType" : true,
                "showCaughtException" : false,
                "showExchangeId" : false,
                "showHeaders" : false,
                "showProperties" : false,
                "showStackTrace" : false,
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "log",
              "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.api.video.out&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
            } ],
            "properties" : { }
          }, {
            "type" : "filter",
            "label" : "rowcount==0",
            "route" : [ {
              "name" : "setHeaders",
              "nodeId" : "5a6d840a-015d-4288-a484-ea84289b076d",
              "description" : "HTTP404",
              "properties" : {
                "_type" : "setHeaders",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "headerList" : [ {
                  "headerName" : "CamelHttpResponseCode",
                  "headerValue" : "404",
                  "language" : "Constant",
                  "uuid" : "ff11c0c0-2744-4efc-938e-871541adedf8"
                } ],
                "name" : "setHeaders",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setHeaders",
              "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "setBody",
              "nodeId" : "e015406d-0c9c-4fdb-9d33-292ede7ae276",
              "description" : "Clear Body",
              "properties" : {
                "_type" : "setBody",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "expression" : "constant('')",
                "language" : "GroovyDsl",
                "name" : "setBody",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setBody",
              "kameletPropertiesUrl" : "?addNamespaces=false&expression=constant('')&language=GroovyDsl&suppressExceptions=false"
            }, {
              "name" : "stop",
              "nodeId" : "ddf8a007-00b9-489c-bcbd-c2667d15da76",
              "description" : "",
              "properties" : {
                "_type" : "stop",
                "camelGroup" : "misc",
                "name" : "stop",
                "url" : ""
              },
              "_type" : "stop",
              "kameletPropertiesUrl" : ""
            } ],
            "properties" : {
              "addNamespaces" : "false",
              "condition" : "${header.CamelSqlRowCount} == 0",
              "language" : "Simple",
              "namespaces" : [ ],
              "suppressExceptions" : "false"
            }
          } ],
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : { }
      }, {
        "type" : "when",
        "label" : "x-access-token",
        "route" : [ {
          "name" : "setProperties",
          "nodeId" : "837ca92f-0c3a-49f8-840a-0e315082ec3c",
          "description" : "Set Operation ID",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Constant",
              "propertyName" : "x-operation-id",
              "propertyValue" : "getVideoRoomById",
              "uuid" : "218da5a6-9c0b-4282-b6fc-551d32af4384"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?x-operation-id=getVideoRoomById&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "e53a5660-a026-47da-94b9-eda858ac348b",
          "description" : "Remove Headers",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".removeHeaders(\"*\", \"x-*\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-*\")"
        }, {
          "name" : "messagingEndpoint",
          "nodeId" : "6385d6a9-d26b-4db3-8595-be828b1a78a7",
          "description" : "SQL Validate Token",
          "properties" : {
            "_type" : "messagingEndpoint",
            "active" : true,
            "camelGroup" : "core",
            "name" : "messagingEndpoint",
            "toDynamicEndpoint" : false,
            "uri" : "sql:SELECT token FROM tokens WHERE access_token = :#${exchangeProperty.xAccessToken} AND expires_at >= NOW()?dataSource=#dsPostgres&OutputType=SelectOne",
            "url" : ""
          },
          "_type" : "messagingEndpoint",
          "kameletPropertiesUrl" : "?uri=sql:SELECT token FROM tokens WHERE access_token = :#${exchangeProperty.xAccessToken} AND expires_at >= NOW()?dataSource=#dsPostgres&OutputType=SelectOne"
        }, {
          "name" : "messageFilter",
          "nodeId" : "010aa10a-5987-41a6-aaf4-94d3a432834d",
          "description" : "",
          "properties" : {
            "_type" : "messageFilter",
            "active" : true,
            "camelGroup" : "routing",
            "name" : "messageFilter",
            "url" : ""
          },
          "_type" : "messageFilter",
          "branches" : [ {
            "type" : "filter",
            "label" : "!token",
            "route" : [ {
              "name" : "log",
              "nodeId" : "17247860-3d47-46a4-9449-0157ff216912",
              "description" : "210.api.get.401",
              "properties" : {
                "_type" : "log",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "component",
                "level" : "WARN",
                "logType" : "EIP",
                "loggerName" : "210.api.get.401",
                "message" : "Invalid Token",
                "multiline" : false,
                "name" : "log",
                "showAll" : false,
                "showBody" : true,
                "showBodyType" : true,
                "showCaughtException" : false,
                "showExchangeId" : false,
                "showHeaders" : false,
                "showProperties" : false,
                "showStackTrace" : false,
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "log",
              "kameletPropertiesUrl" : "?level=WARN&logType=EIP&loggerName=210.api.get.401&message=Invalid Token&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
            }, {
              "name" : "setHeaders",
              "nodeId" : "c997f6a6-e062-4199-b90e-3c6cea8c0e92",
              "description" : "HTTP 401",
              "properties" : {
                "_type" : "setHeaders",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "headerList" : [ {
                  "headerName" : "CamelHttpResponseCode",
                  "headerValue" : "401",
                  "language" : "Constant",
                  "uuid" : "289f5291-a21b-4926-9dae-79a282c97abe"
                } ],
                "name" : "setHeaders",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setHeaders",
              "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "setBody",
              "nodeId" : "bf5520f5-2fd5-484a-beb8-a19cdde78f27",
              "description" : "Clear Body",
              "properties" : {
                "_type" : "setBody",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "expression" : "constant('')",
                "language" : "GroovyDsl",
                "name" : "setBody",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setBody",
              "kameletPropertiesUrl" : "?addNamespaces=false&expression=constant('')&language=GroovyDsl&suppressExceptions=false"
            }, {
              "name" : "stop",
              "nodeId" : "e6b9a595-879c-4bee-a984-59ba21a0a984",
              "description" : "",
              "properties" : {
                "_type" : "stop",
                "camelGroup" : "misc",
                "name" : "stop",
                "url" : ""
              },
              "_type" : "stop",
              "kameletPropertiesUrl" : ""
            } ],
            "properties" : {
              "addNamespaces" : "false",
              "condition" : "${header.CamelSqlRowCount} == 0 || ${body} == null",
              "language" : "Simple",
              "namespaces" : [ ],
              "suppressExceptions" : "false"
            }
          } ],
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${exchangeProperty.xAccessToken} != null && ${exchangeProperty.xAccessToken.length()} < 50",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      }, {
        "type" : "otherwise",
        "label" : "otherwise",
        "route" : [ {
          "name" : "dslProcessor",
          "nodeId" : "b066328d-1304-4ad0-9195-58e78f834045",
          "description" : "Validate JWT",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "d661080b-6275-49eb-925c-21d774189132",
          "description" : "Validate Request",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n\t.log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n\t.stop()\n  .end()",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.to(\"bean:validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n\t.bean('renderResponse')\n\t.log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n\t.stop()\n  .end()"
        } ],
        "properties" : { }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-3",
    "enabled" : true,
    "routeId" : 3,
    "route" : [ {
      "name" : "getRequest",
      "nodeId" : "210412d9-c4e4-4586-a444-946a1cd2c408",
      "description" : "getVideoRooms",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/videorooms",
        "method" : "get",
        "name" : "getRequest",
        "operationName" : "getVideoRooms",
        "produces" : "application/json",
        "requestmethod" : "GET",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/videorooms&method=get&operationName=getVideoRooms&produces=application/json&requestmethod=GET"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "0064e47f-346f-421b-85fe-1dcf6b192764",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "81a13509-9bb1-4389-8b24-c0512ee3edc9",
      "description" : "Validate Request",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean(\"validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n    .bean('renderResponse')\n    .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    .stop()\n    .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean(\"validateRequest\")\n.filter().simple('${header.CamelHttpResponseCode} >= 400')\n    .bean('renderResponse')\n    .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    .stop()\n    .end()"
    }, {
      "name" : "setProperties",
      "nodeId" : "a607d445-5be5-4627-8ce8-af729db9eddd",
      "description" : "Get Input Params",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Header",
          "propertyName" : "agencyId",
          "propertyValue" : "x-agency-id",
          "uuid" : "cd1a0298-eddf-4119-9780-1cc8ae009f18"
        } ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?agencyId=x-agency-id&addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "75837f5a-c920-431a-88c4-9ab5ff741d33",
      "description" : "SQL Get Video Rooms",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"velocity:video_rooms.select.sql.vm?allowContextMapAll=true\")\n.log(LoggingLevel.INFO, 'log', '${body}')\n.to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectList&useMessageBodyForSql=true\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"velocity:video_rooms.select.sql.vm?allowContextMapAll=true\")\n.log(LoggingLevel.INFO, 'log', '${body}')\n.to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectList&useMessageBodyForSql=true\")"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "48664f2a-9f86-44a9-bfc4-30e265eeb364",
      "description" : "Render Response",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean(\"renderResponse\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-5",
    "enabled" : true,
    "routeId" : 4,
    "route" : [ {
      "name" : "onException",
      "nodeId" : "c6222865-977e-4c86-a564-4728e7a6b80b",
      "description" : "",
      "properties" : {
        "_type" : "onException",
        "active" : true,
        "asyncDelayedRedelivery" : false,
        "camelGroup" : "exception",
        "exceptionBehavior" : "Handle the exceptions",
        "exceptionList" : [ {
          "exception" : "Exception"
        } ],
        "maximumRedeliveries" : "2",
        "name" : "onException",
        "redeliveryDelay" : "1000",
        "setRedeliveryDelay" : false,
        "setRedeliveryTriesCount" : false,
        "url" : "",
        "useOriginalMessage" : false
      },
      "_type" : "onException",
      "branches" : [ {
        "type" : "onException",
        "label" : "onException",
        "route" : [ {
          "name" : "log",
          "nodeId" : "edda3511-95ab-4b68-82c2-01ab71337c28",
          "description" : "210.err",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "ERROR",
            "logType" : "EIP",
            "loggerName" : "210.err",
            "message" : "${exception.stacktrace}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=ERROR&logType=EIP&loggerName=210.err&message=${exception.stacktrace}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "setHeaders",
          "nodeId" : "4813e039-52c1-438c-ac96-917dc617b68b",
          "description" : "HTTP500",
          "properties" : {
            "_type" : "setHeaders",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "headerList" : [ {
              "headerName" : "CamelHttpResponseCode",
              "headerValue" : "500",
              "language" : "Constant",
              "uuid" : "de1ce606-1abc-4bcc-b617-a70928656b10"
            } ],
            "name" : "setHeaders",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setHeaders",
          "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "setProperties",
          "nodeId" : "5c928995-b7bf-44fc-b764-60c046676040",
          "description" : "Set Error",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Simple",
              "propertyName" : "error",
              "propertyValue" : "${exception.message}",
              "uuid" : "06ea8526-eb2d-4d0b-b972-ddc722e23ebc"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?error=${exception.message}&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "fee3a985-f34d-487a-bba7-d96dd55e1363",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean(\"renderResponse\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
        }, {
          "name" : "stop",
          "nodeId" : "aa682ddb-65ea-4500-9b28-37e6be014138",
          "description" : "",
          "properties" : {
            "_type" : "stop",
            "camelGroup" : "misc",
            "name" : "stop",
            "url" : ""
          },
          "_type" : "stop",
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : { }
      } ],
      "kameletPropertiesUrl" : "?asyncDelayedRedelivery=false&exceptionBehavior=Handle the exceptions&maximumRedeliveries=2&redeliveryDelay=1000&setRedeliveryDelay=false&setRedeliveryTriesCount=false&useOriginalMessage=false"
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-5-64a0e900",
    "enabled" : true,
    "routeId" : 5,
    "route" : [ {
      "name" : "jms",
      "nodeId" : "1ac6cb46-9ed7-45a8-ae45-ca6aea62350f",
      "description" : "video.status",
      "properties" : {
        "_type" : "jms",
        "active" : true,
        "advancedParameters" : [ ],
        "asyncConsumer" : false,
        "camelGroup" : "component",
        "concurrentConsumers" : "10",
        "connectionFactory" : "#pooledConnectionFactory",
        "destinationName" : "video.status",
        "destinationType" : "queue",
        "exchangePattern" : "InOnly",
        "name" : "jms",
        "setConnectionFactory" : true,
        "toDynamicEndpoint" : false,
        "transacted" : false,
        "url" : ""
      },
      "_type" : "jms",
      "kameletPropertiesUrl" : "?asyncConsumer=false&concurrentConsumers=10&connectionFactory=#pooledConnectionFactory&destinationName=video.status&destinationType=queue&exchangePattern=InOnly&setConnectionFactory=true&transacted=false"
    }, {
      "name" : "convertBodyTo",
      "nodeId" : "fa9bff17-f7d2-44e5-a1e0-64bdc094e831",
      "description" : "To String",
      "properties" : {
        "_type" : "convertBodyTo",
        "active" : true,
        "camelGroup" : "transform",
        "name" : "convertBodyTo",
        "targetClass" : "String.class",
        "url" : ""
      },
      "_type" : "convertBodyTo",
      "kameletPropertiesUrl" : "?targetClass=String.class"
    }, {
      "name" : "log",
      "nodeId" : "60e7d27d-b1c3-4201-a160-146de038e762",
      "description" : "in",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "INFO",
        "logType" : "EIP",
        "loggerName" : "api.video.jmsstatus.in",
        "message" : "${body}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=api.video.jmsstatus.in&message=${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "setProperties",
      "nodeId" : "95f9d4a3-8bd4-4480-9e23-981ebb6260b2",
      "description" : "Get Input Params",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "JsonPath",
          "propertyName" : "roomId",
          "propertyValue" : "$.room_id",
          "uuid" : "0da2b095-79a3-4fb3-a692-888b7fe43649"
        }, {
          "language" : "JsonPath",
          "propertyName" : "status",
          "propertyValue" : "$.status",
          "uuid" : "f1288a39-0071-43ab-87ac-58e5e9b969a4"
        }, {
          "language" : "JsonPath",
          "propertyName" : "resourceId",
          "propertyValue" : "resource_id",
          "uuid" : "eaa96afd-c450-4249-be48-38b7589871c2"
        }, {
          "language" : "JsonPath",
          "propertyName" : "duration",
          "propertyValue" : "$.duration",
          "uuid" : "9dead002-23a6-4fa7-ba71-8df7106cbfdf"
        }, {
          "language" : "JsonPath",
          "propertyName" : "callbackEvent",
          "propertyValue" : "$.callback_event",
          "uuid" : "c2296639-2189-4cfc-8441-c0132a8ba7bb"
        }, {
          "language" : "Simple",
          "propertyName" : "requestBody",
          "propertyValue" : "${body}",
          "uuid" : "bd2c698c-1469-4e8a-8fa6-c4b8f584e5e2"
        } ],
        "suppressExceptions" : true,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?roomId=$.room_id&status=$.status&resourceId=resource_id&duration=$.duration&callbackEvent=$.callback_event&requestBody=${body}&addNamespaces=false&suppressExceptions=true"
    }, {
      "name" : "setHeaders",
      "nodeId" : "1628bfcc-aa0e-47ba-ae99-77ab5cdf8c8d",
      "description" : "Set JMS Headers",
      "properties" : {
        "_type" : "setHeaders",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "headerList" : [ {
          "headerName" : "CamelJmsDestinationName",
          "headerValue" : "updateVideoStatus",
          "language" : "Constant",
          "uuid" : "0fe1ffca-5628-43e3-840f-7575f3f4ad5f"
        } ],
        "name" : "setHeaders",
        "namespaces" : [ ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setHeaders",
      "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "messageFilter",
      "nodeId" : "94e35271-ad5e-4359-9ffb-68b681ecaa60",
      "description" : "room-ended",
      "properties" : {
        "_type" : "messageFilter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageFilter",
        "url" : ""
      },
      "_type" : "messageFilter",
      "branches" : [ {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "messagingEndpoint",
          "nodeId" : "734f6e25-be0e-4186-840d-6d6828a1266a",
          "description" : "SQL Update Status",
          "properties" : {
            "_type" : "messagingEndpoint",
            "active" : true,
            "camelGroup" : "core",
            "name" : "messagingEndpoint",
            "toDynamicEndpoint" : false,
            "uri" : "sql:UPDATE video_rooms SET status = COALESCE(:#${exchangeProperty.status}, status), duration = COALESCE(CAST(:#${exchangeProperty.duration} AS integer), duration), updated_at = NOW() WHERE id = CAST(:#${exchangeProperty.roomId} AS uuid) RETURNING agency_id, conversation_id?dataSource=#dsPostgres",
            "url" : ""
          },
          "_type" : "messagingEndpoint",
          "kameletPropertiesUrl" : "?uri=sql:UPDATE video_rooms SET status = COALESCE(:#${exchangeProperty.status}, status), duration = COALESCE(CAST(:#${exchangeProperty.duration} AS integer), duration), updated_at = NOW() WHERE id = CAST(:#${exchangeProperty.roomId} AS uuid) RETURNING agency_id, conversation_id?dataSource=#dsPostgres"
        }, {
          "name" : "setProperties",
          "nodeId" : "f0138ffa-bc24-48fd-8185-12ed491d470c",
          "description" : "Get Agency & Convo ID",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Simple",
              "propertyName" : "agencyId",
              "propertyValue" : "${body[0][agency_id]}",
              "uuid" : "a1c6e966-77bd-44a4-b33c-3bb2d97463b4"
            }, {
              "language" : "Simple",
              "propertyName" : "conversationId",
              "propertyValue" : "${body[0][conversation_id]}",
              "uuid" : "90ff8693-0ea0-493b-b2b8-7aa093362977"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?agencyId=${body[0][agency_id]}&conversationId=${body[0][conversation_id]}&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "process",
          "nodeId" : "dd083859-2a0a-46aa-b1a7-c1b272c9c061",
          "description" : "Update Status JSON",
          "properties" : {
            "_type" : "process",
            "active" : true,
            "camelGroup" : "transform",
            "code" : "ObjectMapper mapper = new ObjectMapper();\nHashMap<String, Object> videoStatus = mapper.readValue((String)exchange.getProperty(\"requestBody\"), HashMap.class);\n\nString agencyId = (String)exchange.getProperty(\"agencyId\");\nString conversationId = (String)exchange.getProperty(\"conversationId\");\n\nvideoStatus.put(\"agency_id\", agencyId);\nvideoStatus.put(\"conversation_id\", conversationId);\n\nHashMap<String, Object> responseJson = new HashMap<String, Object>() {{\n\tput(\"requestId\", (String)exchange.getExchangeId());\n\tput(\"apiOperation\", \"updateVideoStatus\");\n\tput(\"objectType\", \"VideoStatus\");\n\tput(\"data\", videoStatus);\n}};\n\nexchange.getIn().setBody(mapper.writeValueAsString(responseJson));",
            "import" : "import com.fasterxml.jackson.databind.ObjectMapper;",
            "name" : "process",
            "url" : ""
          },
          "_type" : "process",
          "kameletPropertiesUrl" : "?code=ObjectMapper mapper = new ObjectMapper();\nHashMap<String, Object> videoStatus = mapper.readValue((String)exchange.getProperty(\"requestBody\"), HashMap.class);\n\nString agencyId = (String)exchange.getProperty(\"agencyId\");\nString conversationId = (String)exchange.getProperty(\"conversationId\");\n\nvideoStatus.put(\"agency_id\", agencyId);\nvideoStatus.put(\"conversation_id\", conversationId);\n\nHashMap<String, Object> responseJson = new HashMap<String, Object>() {{\n\tput(\"requestId\", (String)exchange.getExchangeId());\n\tput(\"apiOperation\", \"updateVideoStatus\");\n\tput(\"objectType\", \"VideoStatus\");\n\tput(\"data\", videoStatus);\n}};\n\nexchange.getIn().setBody(mapper.writeValueAsString(responseJson));&import=import com.fasterxml.jackson.databind.ObjectMapper;"
        }, {
          "name" : "seda",
          "nodeId" : "ccd2dd51-2fa1-47c8-a477-9f3b05041efb",
          "description" : "publish-event",
          "properties" : {
            "_type" : "seda",
            "active" : true,
            "advancedParameters" : [ ],
            "blockWhenFull" : false,
            "camelGroup" : "core",
            "concurrentConsumers" : "1",
            "endpointName" : "publish-event",
            "limitConcurrentConsumers" : true,
            "multipleConsumers" : false,
            "name" : "seda",
            "pollTimeout" : "1000",
            "size" : "1000",
            "specifyMaximumCapacitySize" : false,
            "timeout" : "30000",
            "toDynamicEndpoint" : false,
            "url" : "",
            "waitForTaskToComplete" : "Never"
          },
          "_type" : "seda",
          "kameletPropertiesUrl" : "?blockWhenFull=false&concurrentConsumers=1&endpointName=publish-event&limitConcurrentConsumers=true&multipleConsumers=false&pollTimeout=1000&size=1000&specifyMaximumCapacitySize=false&timeout=30000&waitForTaskToComplete=Never"
        } ],
        "properties" : { }
      }, {
        "type" : "filter",
        "label" : "filter",
        "route" : [ {
          "name" : "setProperties",
          "nodeId" : "c53606f6-7b6c-4d7a-90b6-273f0ddded30",
          "description" : "",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Constant",
              "propertyName" : "status",
              "propertyValue" : "closed",
              "uuid" : "e8f39847-7b22-466b-bc9a-4ae89817ac58"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?status=closed&addNamespaces=false&suppressExceptions=false"
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${header.foo} == \"bar\"",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-6",
    "enabled" : true,
    "routeId" : 6,
    "route" : [ {
      "name" : "putRequest",
      "nodeId" : "b14b1689-c548-4e9e-87a2-c6063a4983d8",
      "description" : "updateVideoRoom",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/videorooms/{roomId}",
        "method" : "put",
        "name" : "putRequest",
        "operationName" : "updateVideoRoom",
        "produces" : "application/json",
        "requestmethod" : "PUT",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/videorooms/{roomId}&method=put&operationName=updateVideoRoom&produces=application/json&requestmethod=PUT"
    }, {
      "name" : "convertBodyTo",
      "nodeId" : "8fff4081-31fd-47df-9d8a-431abd45d575",
      "description" : "To String",
      "properties" : {
        "_type" : "convertBodyTo",
        "active" : true,
        "camelGroup" : "transform",
        "name" : "convertBodyTo",
        "targetClass" : "String.class",
        "url" : ""
      },
      "_type" : "convertBodyTo",
      "kameletPropertiesUrl" : "?targetClass=String.class"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "636a1dd9-cb2a-459c-b0e3-3602e85fcab9",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "log",
      "nodeId" : "8566762b-ef79-4279-870b-6592f7492cf3",
      "description" : "210.api.update.in",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "INFO",
        "logType" : "EIP",
        "loggerName" : "210.api.update.in",
        "message" : "${body}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.api.update.in&message=${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "d8aa76b1-41cc-44be-ad7a-8902a7088d0d",
      "description" : "Validate Request",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"bean:validateRequest\")\n    .filter().simple('${header.CamelHttpResponseCode} >= 400')\n    \t.bean('renderResponse')\n    \t.log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    \t.stop()\n      .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"bean:validateRequest\")\n    .filter().simple('${header.CamelHttpResponseCode} >= 400')\n    \t.bean('renderResponse')\n    \t.log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    \t.stop()\n      .end()"
    }, {
      "name" : "setProperties",
      "nodeId" : "41d6e67f-2a43-4ec8-b205-caa7caaa5179",
      "description" : "Get Input Params",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Header",
          "propertyName" : "roomId",
          "propertyValue" : "roomId",
          "uuid" : "3601037f-f3e7-4477-98f6-286cddec63f7"
        }, {
          "language" : "JsonPath",
          "propertyName" : "status",
          "propertyValue" : "$.status",
          "uuid" : "fb1b489d-156b-4a96-8d2e-41f73bca001c"
        }, {
          "language" : "JsonPath",
          "propertyName" : "resourceUrl",
          "propertyValue" : "$.resource_url",
          "uuid" : "ef9a96c2-50a1-4cc0-877e-d2e727e75bb2"
        }, {
          "language" : "JsonPath",
          "propertyName" : "resourceId",
          "propertyValue" : "$.resource_id",
          "uuid" : "5219e067-efcd-4d04-a506-deac893c9afb"
        }, {
          "language" : "JsonPath",
          "propertyName" : "metadata",
          "propertyValue" : "$.metadata",
          "uuid" : "968724f8-dbfb-4be7-a92b-9bdc1c5429e0"
        }, {
          "language" : "Simple",
          "propertyName" : "x-authorized",
          "propertyValue" : "true",
          "uuid" : "fde06112-9605-4d5f-a019-779bffe1a03e"
        } ],
        "suppressExceptions" : true,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?roomId=roomId&status=$.status&resourceUrl=$.resource_url&resourceId=$.resource_id&metadata=$.metadata&x-authorized=true&addNamespaces=false&suppressExceptions=true"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "3006aa0b-65d7-40e9-ab96-0ae8e5ef6e00",
      "description" : "Remove Headers",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".removeHeaders(\"*\", \"x-*\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-*\")"
    }, {
      "name" : "messagingEndpoint",
      "nodeId" : "0e34545d-6f25-4d82-904d-e162e9d58b66",
      "description" : "SQL Update VideoRoom",
      "properties" : {
        "_type" : "messagingEndpoint",
        "active" : true,
        "camelGroup" : "core",
        "name" : "messagingEndpoint",
        "toDynamicEndpoint" : false,
        "uri" : "sql:UPDATE video_rooms SET status = COALESCE(:#${exchangeProperty.status}, status), metadata = COALESCE(CAST(:#${exchangeProperty.metadata} AS json), metadata), resource_id = COALESCE(:#${exchangeProperty.resourceId}, resource_id), resource_url = COALESCE(:#${exchangeProperty.resourceUrl}, resource_url), updated_at = NOW() WHERE id = CAST(:#${exchangeProperty.roomId} AS uuid)?dataSource=#dsPostgres",
        "url" : ""
      },
      "_type" : "messagingEndpoint",
      "kameletPropertiesUrl" : "?uri=sql:UPDATE video_rooms SET status = COALESCE(:#${exchangeProperty.status}, status), metadata = COALESCE(CAST(:#${exchangeProperty.metadata} AS json), metadata), resource_id = COALESCE(:#${exchangeProperty.resourceId}, resource_id), resource_url = COALESCE(:#${exchangeProperty.resourceUrl}, resource_url), updated_at = NOW() WHERE id = CAST(:#${exchangeProperty.roomId} AS uuid)?dataSource=#dsPostgres"
    }, {
      "name" : "messageFilter",
      "nodeId" : "fc75614e-0b3e-4f7b-a34a-0e2f9e5f1c38",
      "description" : "",
      "properties" : {
        "_type" : "messageFilter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageFilter",
        "url" : ""
      },
      "_type" : "messageFilter",
      "branches" : [ {
        "type" : "filter",
        "label" : "rowcount==0",
        "route" : [ {
          "name" : "setProperties",
          "nodeId" : "eb73d420-a363-493b-b747-de64535e0fb2",
          "description" : "Set Error",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Constant",
              "propertyName" : "error",
              "propertyValue" : "Error updating video room",
              "uuid" : "1088b47e-3375-43ee-a7b4-3ede44dcd23f"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?error=Error updating video room&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "ec7a895b-9104-4a45-ac21-8fff8f1441e1",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean(\"renderResponse\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
        }, {
          "name" : "log",
          "nodeId" : "ce673d81-7c60-460e-9120-041cfc5db943",
          "description" : "err",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "api.video.update.err",
            "message" : "(${header.CamelHttpResponseCode}) ${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=api.video.update.err&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "stop",
          "nodeId" : "8412d4ee-559b-4764-ab7d-6670a505d235",
          "description" : "",
          "properties" : {
            "_type" : "stop",
            "camelGroup" : "misc",
            "name" : "stop",
            "url" : ""
          },
          "_type" : "stop",
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${header.CamelSqlUpdateCount} == 0",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      }, {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "log",
          "nodeId" : "b6ebb5e7-9fc1-4ade-a5fc-7bd1b38be3fe",
          "description" : "out",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "api.video.update.out",
            "message" : "${header.CamelHttpResponseCode}) ${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=api.video.update.out&message=${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "setHeaders",
          "nodeId" : "3913f526-fb14-43c3-abc0-1bec2425a173",
          "description" : "Set Room ID",
          "properties" : {
            "_type" : "setHeaders",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "headerList" : [ {
              "headerName" : "roomId",
              "headerValue" : "${exchangeProperty.roomId}",
              "language" : "Simple",
              "uuid" : "59bd3df2-39dc-4eb9-827f-ff6d73be0a04"
            }, {
              "headerName" : "CamelJmsDestinationName",
              "headerValue" : "updateVideoRoom",
              "language" : "Constant",
              "uuid" : "1aae605a-a777-440b-94cf-1cfd0d7a43db"
            } ],
            "name" : "setHeaders",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setHeaders",
          "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "direct",
          "nodeId" : "624c50f9-24ca-4cab-a61d-b814df438981",
          "description" : "getVideoRoomById",
          "properties" : {
            "_type" : "direct",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "core",
            "endpointName" : "getVideoRoomById",
            "name" : "direct",
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "direct",
          "kameletPropertiesUrl" : "?endpointName=getVideoRoomById"
        }, {
          "name" : "setBody",
          "nodeId" : "b8aff403-5b3a-4f33-8d60-5c173e6ba271",
          "description" : "Set JSON Response",
          "properties" : {
            "_type" : "setBody",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "expression" : "$.data",
            "language" : "JsonPath",
            "name" : "setBody",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setBody",
          "kameletPropertiesUrl" : "?addNamespaces=false&expression=$.data&language=JsonPath&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "e573cdfe-c899-49fa-b76e-9a5f2747f52e",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean(\"renderResponse\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
        }, {
          "name" : "seda",
          "nodeId" : "96fed0f9-1e92-4cdf-8294-658a0cbcb7fd",
          "description" : "publish-event",
          "properties" : {
            "_type" : "seda",
            "active" : true,
            "advancedParameters" : [ ],
            "blockWhenFull" : false,
            "camelGroup" : "core",
            "concurrentConsumers" : "1",
            "endpointName" : "publish-event",
            "limitConcurrentConsumers" : true,
            "multipleConsumers" : false,
            "name" : "seda",
            "pollTimeout" : "1000",
            "size" : "1000",
            "specifyMaximumCapacitySize" : false,
            "timeout" : "30000",
            "toDynamicEndpoint" : false,
            "url" : "",
            "waitForTaskToComplete" : "Never"
          },
          "_type" : "seda",
          "kameletPropertiesUrl" : "?blockWhenFull=false&concurrentConsumers=1&endpointName=publish-event&limitConcurrentConsumers=true&multipleConsumers=false&pollTimeout=1000&size=1000&specifyMaximumCapacitySize=false&timeout=30000&waitForTaskToComplete=Never"
        } ],
        "properties" : { }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-7",
    "enabled" : true,
    "routeId" : 7,
    "route" : [ {
      "name" : "seda",
      "nodeId" : "5466ff24-4684-43a0-88bb-859d6912c400",
      "description" : "publish-event",
      "properties" : {
        "_type" : "seda",
        "active" : true,
        "advancedParameters" : [ ],
        "blockWhenFull" : false,
        "camelGroup" : "core",
        "concurrentConsumers" : "10",
        "endpointName" : "publish-event",
        "limitConcurrentConsumers" : true,
        "multipleConsumers" : false,
        "name" : "seda",
        "pollTimeout" : "1000",
        "size" : "1000",
        "specifyMaximumCapacitySize" : false,
        "timeout" : "30000",
        "toDynamicEndpoint" : false,
        "url" : "",
        "waitForTaskToComplete" : "IfReplyExpected"
      },
      "_type" : "seda",
      "kameletPropertiesUrl" : "?blockWhenFull=false&concurrentConsumers=10&endpointName=publish-event&limitConcurrentConsumers=true&multipleConsumers=false&pollTimeout=1000&size=1000&specifyMaximumCapacitySize=false&timeout=30000&waitForTaskToComplete=IfReplyExpected"
    }, {
      "name" : "log",
      "nodeId" : "edaf32fd-b368-4374-9065-8e46956c7aba",
      "description" : "210.seda.io.event",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "INFO",
        "logType" : "EIP",
        "loggerName" : "210.seda.io.event",
        "message" : "Enqueuing Event: ${body}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.seda.io.event&message=Enqueuing Event: ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "02a66e0e-acd1-479d-9ae5-dfe2269fd338",
      "description" : "Remove JMS Header",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".removeHeader(\"CamelJmsDestinationName\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.removeHeader(\"CamelJmsDestinationName\")"
    }, {
      "name" : "exchangePattern",
      "nodeId" : "39db2c9e-b967-487d-8abf-e0a3e995a4a8",
      "description" : "InOnly",
      "properties" : {
        "_type" : "exchangePattern",
        "active" : true,
        "camelGroup" : "core",
        "exchangePattern" : "InOnly",
        "name" : "exchangePattern",
        "url" : ""
      },
      "_type" : "exchangePattern",
      "kameletPropertiesUrl" : "?exchangePattern=InOnly"
    }, {
      "name" : "jms",
      "nodeId" : "2e6206b9-aeb2-47ec-9092-42df9a844b20",
      "description" : "Emit IO Event",
      "properties" : {
        "_type" : "jms",
        "active" : true,
        "advancedParameters" : [ ],
        "asyncConsumer" : false,
        "camelGroup" : "component",
        "concurrentConsumers" : "1",
        "connectionFactory" : "#pooledConnectionFactory",
        "destinationName" : "io.event",
        "destinationType" : "queue",
        "exchangePattern" : "InOnly",
        "name" : "jms",
        "setConnectionFactory" : true,
        "toDynamicEndpoint" : false,
        "transacted" : false,
        "url" : ""
      },
      "_type" : "jms",
      "kameletPropertiesUrl" : "?asyncConsumer=false&concurrentConsumers=1&connectionFactory=#pooledConnectionFactory&destinationName=io.event&destinationType=queue&exchangePattern=InOnly&setConnectionFactory=true&transacted=false"
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-9",
    "enabled" : true,
    "routeId" : 8,
    "route" : [ {
      "name" : "deleteRequest",
      "nodeId" : "065d0bc3-4513-42de-b7f7-fbc644be33fc",
      "description" : "closeVideoRoom",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/videorooms/{roomId}",
        "method" : "delete",
        "name" : "deleteRequest",
        "operationName" : "closeVideoRoom",
        "produces" : "application/json",
        "requestmethod" : "DELETE",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/videorooms/{roomId}&method=delete&operationName=closeVideoRoom&produces=application/json&requestmethod=DELETE"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "6fd952ec-1509-40ab-af16-0fce8e73a625",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "915e7868-266a-4361-827e-6bb09fc65766",
      "description" : "Validate Request",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"bean:validateRequest\")\n    .filter().simple('${header.CamelHttpResponseCode} >= 400')\n    \t.bean('renderResponse')\n    \t.log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    \t.stop()\n      .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"bean:validateRequest\")\n    .filter().simple('${header.CamelHttpResponseCode} >= 400')\n    \t.bean('renderResponse')\n    \t.log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    \t.stop()\n      .end()"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "0408c22b-5cd3-4d2f-8bd1-ef8a9a72e318",
      "description" : "Remove Headers",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".removeHeaders(\"*\", \"x-*\", \"roomId\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-*\", \"roomId\")"
    }, {
      "name" : "messagingEndpoint",
      "nodeId" : "802d0bc9-d35c-4a78-a2cb-dfa8357bccb7",
      "description" : "SQL Get Video Room",
      "properties" : {
        "_type" : "messagingEndpoint",
        "active" : true,
        "camelGroup" : "core",
        "name" : "messagingEndpoint",
        "toDynamicEndpoint" : false,
        "uri" : "sql:SELECT status, resource_id, provider FROM video_rooms WHERE id = CAST(:#${header.roomId} AS uuid)?dataSource=#dsPostgres&OutputType=SelectOne",
        "url" : ""
      },
      "_type" : "messagingEndpoint",
      "kameletPropertiesUrl" : "?uri=sql:SELECT status, resource_id, provider FROM video_rooms WHERE id = CAST(:#${header.roomId} AS uuid)?dataSource=#dsPostgres&OutputType=SelectOne"
    }, {
      "name" : "log",
      "nodeId" : "3102d1fe-5a89-4b9c-9d35-5dbea0c425db",
      "description" : "210.api.video.close.in",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "INFO",
        "logType" : "EIP",
        "loggerName" : "210.api.video.close.in",
        "message" : "${body}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.api.video.close.in&message=${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "setProperties",
      "nodeId" : "524889cc-c415-403e-bd2e-f9989f4c4cf2",
      "description" : "Get Input Params",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Header",
          "propertyName" : "roomId",
          "propertyValue" : "roomId",
          "uuid" : "4b35f0f8-1876-43b4-99e3-9f71d1c285ab"
        }, {
          "language" : "Simple",
          "propertyName" : "resourceId",
          "propertyValue" : "${body[resource_id]}",
          "uuid" : "0cb0ecd8-485c-41f3-b039-1c4f2b5b5547"
        }, {
          "language" : "Simple",
          "propertyName" : "status",
          "propertyValue" : "${body[status]}",
          "uuid" : "22e8bddc-db4f-49bc-9087-5bcc62c0cc93"
        }, {
          "language" : "Simple",
          "propertyName" : "provider",
          "propertyValue" : "${body[provider]}",
          "uuid" : "c5380286-4d21-498d-82c2-b5e8d4fac8b5"
        } ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?roomId=roomId&resourceId=${body[resource_id]}&status=${body[status]}&provider=${body[provider]}&addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "messageFilter",
      "nodeId" : "925b4992-1d57-4b2a-a40d-7cf707a79b89",
      "description" : "",
      "properties" : {
        "_type" : "messageFilter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageFilter",
        "url" : ""
      },
      "_type" : "messageFilter",
      "branches" : [ {
        "type" : "filter",
        "label" : "! in-progress",
        "route" : [ {
          "name" : "setProperties",
          "nodeId" : "ef5bda05-f25d-4588-b9f1-7a5bb122249b",
          "description" : "Set Error",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Constant",
              "propertyName" : "error",
              "propertyValue" : "Video room is already closed.",
              "uuid" : "64e18b6f-01fe-4d45-a236-5d1a61c6c6c0"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?error=Video room is already closed.&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "dff460d8-aea3-4baf-af35-a07eca86b577",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean(\"renderResponse\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
        }, {
          "name" : "log",
          "nodeId" : "9eeda002-818e-4e59-b2b6-84e297cff72a",
          "description" : "210.api.video.close.400",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "WARN",
            "logType" : "EIP",
            "loggerName" : "210.api.video.close.400",
            "message" : "(${header.CamelHttpResponseCode}) ${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=WARN&logType=EIP&loggerName=210.api.video.close.400&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "stop",
          "nodeId" : "7080c2de-9d24-4475-99e5-68a408085930",
          "description" : "",
          "properties" : {
            "_type" : "stop",
            "camelGroup" : "misc",
            "name" : "stop",
            "url" : ""
          },
          "_type" : "stop",
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${exchangeProperty.status} != \"in-progress\"",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      }, {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "exchangePattern",
          "nodeId" : "133d0922-3d6f-4b2d-9303-061b6777c05e",
          "description" : "InOut",
          "properties" : {
            "_type" : "exchangePattern",
            "active" : true,
            "camelGroup" : "core",
            "exchangePattern" : "InOut",
            "name" : "exchangePattern",
            "url" : ""
          },
          "_type" : "exchangePattern",
          "kameletPropertiesUrl" : "?exchangePattern=InOut"
        }, {
          "name" : "setHeaders",
          "nodeId" : "47d3e382-7eeb-45d3-969c-a3264b541d14",
          "description" : "Set JMS Destination",
          "properties" : {
            "_type" : "setHeaders",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "headerList" : [ {
              "headerName" : "CamelJmsDestinationName",
              "headerValue" : "providers.video.${exchangeProperty.provider}",
              "language" : "Simple",
              "uuid" : "e939213e-1fb4-4237-a277-684034ccfb71"
            }, {
              "headerName" : "x-requested-operation",
              "headerValue" : "complete-room",
              "language" : "Constant",
              "uuid" : "9e597981-d9f7-492e-a711-284b2ee370b5"
            } ],
            "name" : "setHeaders",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setHeaders",
          "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "setBody",
          "nodeId" : "eeac2f2a-21c0-4ce1-9dc7-7c3a7df2002e",
          "description" : "Set Resource ID",
          "properties" : {
            "_type" : "setBody",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "expression" : "{\"resource_id\": \"${exchangeProperty.resourceId}\"}",
            "language" : "Simple",
            "name" : "setBody",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setBody",
          "kameletPropertiesUrl" : "?addNamespaces=false&expression={\"resource_id\": \"${exchangeProperty.resourceId}\"}&language=Simple&suppressExceptions=false"
        }, {
          "name" : "jms",
          "nodeId" : "9a1c5548-dd75-4dfe-bab4-4049224808ce",
          "description" : "providers.{prvdr}.video",
          "properties" : {
            "_type" : "jms",
            "active" : true,
            "advancedParameters" : [ ],
            "asyncConsumer" : false,
            "camelGroup" : "component",
            "concurrentConsumers" : "1",
            "connectionFactory" : "#pooledConnectionFactory",
            "destinationName" : "queue.name",
            "destinationType" : "queue",
            "exchangePattern" : "InOnly",
            "name" : "jms",
            "setConnectionFactory" : true,
            "toDynamicEndpoint" : false,
            "transacted" : true,
            "url" : ""
          },
          "_type" : "jms",
          "kameletPropertiesUrl" : "?asyncConsumer=false&concurrentConsumers=1&connectionFactory=#pooledConnectionFactory&destinationName=queue.name&destinationType=queue&exchangePattern=InOnly&setConnectionFactory=true&transacted=true"
        }, {
          "name" : "log",
          "nodeId" : "3c2bd087-4942-4bcd-80f4-4e3788753be4",
          "description" : "api.video.close.jms.out",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "210.api.video.close.jms.out",
            "message" : "(${header.CamelHttpResponseCode}) ${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.api.video.close.jms.out&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "messagingEndpoint",
          "nodeId" : "33ce7288-fed2-4a51-b9cc-f387349acbd8",
          "description" : "SQL Update Video Room",
          "properties" : {
            "_type" : "messagingEndpoint",
            "active" : true,
            "camelGroup" : "core",
            "name" : "messagingEndpoint",
            "toDynamicEndpoint" : false,
            "uri" : "sql:UPDATE video_rooms SET status = \\'completed\\' WHERE id = CAST(:#${exchangeProperty.roomId} AS uuid)?dataSource=#dsPostgres",
            "url" : ""
          },
          "_type" : "messagingEndpoint",
          "kameletPropertiesUrl" : "?uri=sql:UPDATE video_rooms SET status = \\'completed\\' WHERE id = CAST(:#${exchangeProperty.roomId} AS uuid)?dataSource=#dsPostgres"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "570686e3-a481-4c35-8467-eecb293cb6d5",
          "description" : "Remove Headers",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".removeHeaders(\"*\", \"x-*\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-*\")"
        }, {
          "name" : "setHeaders",
          "nodeId" : "c55eb0b7-40e8-4e70-927f-097b907d2f52",
          "description" : "Set Room ID",
          "properties" : {
            "_type" : "setHeaders",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "headerList" : [ {
              "headerName" : "roomId",
              "headerValue" : "${exchangeProperty.roomId}",
              "language" : "Simple",
              "uuid" : "2f09825b-68fe-4f99-a8a9-ea4ed8e17d55"
            }, {
              "headerName" : "x-authorized",
              "headerValue" : "true",
              "language" : "Simple",
              "uuid" : "044b1a94-a4d0-4932-85a1-d4c7bf309443"
            } ],
            "name" : "setHeaders",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setHeaders",
          "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "direct",
          "nodeId" : "abeddbd6-1ff0-4b72-876b-f1addf2d6ecf",
          "description" : "getVideoRoomById",
          "properties" : {
            "_type" : "direct",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "core",
            "endpointName" : "getVideoRoomById",
            "name" : "direct",
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "direct",
          "kameletPropertiesUrl" : "?endpointName=getVideoRoomById"
        }, {
          "name" : "setBody",
          "nodeId" : "e08ac830-9c76-445c-84aa-2112ca3dc6f6",
          "description" : "Set Response",
          "properties" : {
            "_type" : "setBody",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "expression" : "$.data",
            "language" : "JsonPath",
            "name" : "setBody",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setBody",
          "kameletPropertiesUrl" : "?addNamespaces=false&expression=$.data&language=JsonPath&suppressExceptions=false"
        }, {
          "name" : "setHeaders",
          "nodeId" : "11cebd36-b0a0-418d-a372-da35b1f82d6d",
          "description" : "HTTP200",
          "properties" : {
            "_type" : "setHeaders",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "headerList" : [ {
              "headerName" : "CamelHttpResponseCode",
              "headerValue" : "200",
              "language" : "Constant",
              "uuid" : "c3a3b3c2-4803-461e-bbeb-54fce9fcd486"
            } ],
            "name" : "setHeaders",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setHeaders",
          "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "c3f73f35-829a-4acf-8481-39f6f969f553",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean(\"renderResponse\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
        }, {
          "name" : "seda",
          "nodeId" : "159e93eb-3bd1-4e71-bbd6-7ffdab8a080f",
          "description" : "publish-event",
          "properties" : {
            "_type" : "seda",
            "active" : true,
            "advancedParameters" : [ ],
            "blockWhenFull" : false,
            "camelGroup" : "core",
            "concurrentConsumers" : "1",
            "endpointName" : "publish-event",
            "limitConcurrentConsumers" : true,
            "multipleConsumers" : false,
            "name" : "seda",
            "pollTimeout" : "1000",
            "size" : "1000",
            "specifyMaximumCapacitySize" : false,
            "timeout" : "30000",
            "toDynamicEndpoint" : false,
            "url" : "",
            "waitForTaskToComplete" : "Never"
          },
          "_type" : "seda",
          "kameletPropertiesUrl" : "?blockWhenFull=false&concurrentConsumers=1&endpointName=publish-event&limitConcurrentConsumers=true&multipleConsumers=false&pollTimeout=1000&size=1000&specifyMaximumCapacitySize=false&timeout=30000&waitForTaskToComplete=Never"
        }, {
          "name" : "log",
          "nodeId" : "709ec109-f03f-4b7d-a024-33ed25e76e3f",
          "description" : "210.api.video.close.out",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "210.api.video.close.out",
            "message" : "(${header.CamelHttpResponseCode}) ${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.api.video.close.out&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        } ],
        "properties" : { }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-8",
    "enabled" : true,
    "routeId" : 9,
    "route" : [ {
      "name" : "putRequest",
      "nodeId" : "c8abc857-ad22-46ad-8e58-b7c71550dea8",
      "description" : "createVideoRoomToken",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/videorooms/{roomId}/tokens",
        "method" : "put",
        "name" : "putRequest",
        "operationName" : "createVideoRoomToken",
        "produces" : "application/json",
        "requestmethod" : "PUT",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/videorooms/{roomId}/tokens&method=put&operationName=createVideoRoomToken&produces=application/json&requestmethod=PUT"
    }, {
      "name" : "convertBodyTo",
      "nodeId" : "ba44d4e2-dbde-470b-8d70-d22f2cadf852",
      "description" : "To String",
      "properties" : {
        "_type" : "convertBodyTo",
        "active" : true,
        "camelGroup" : "transform",
        "name" : "convertBodyTo",
        "targetClass" : "String.class",
        "url" : ""
      },
      "_type" : "convertBodyTo",
      "kameletPropertiesUrl" : "?targetClass=String.class"
    }, {
      "name" : "setProperties",
      "nodeId" : "7a948d90-e94f-4f88-8090-9c0fe3e6da46",
      "description" : "Set Input Params",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Header",
          "propertyName" : "xAccessToken",
          "propertyValue" : "x-access-token",
          "uuid" : "74ce7adf-ce5d-4a33-b8fb-c3239071f7b0"
        }, {
          "language" : "Header",
          "propertyName" : "roomId",
          "propertyValue" : "roomId",
          "uuid" : "7aa6a216-de37-4de0-981b-8a90f97ca4ed"
        }, {
          "language" : "Simple",
          "propertyName" : "requestBody",
          "propertyValue" : "${body}",
          "uuid" : "518e5a60-48e3-46ae-9060-d7e163744ebe"
        } ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?xAccessToken=x-access-token&roomId=roomId&requestBody=${body}&addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "messageRouter",
      "nodeId" : "8186500b-0b23-4ef5-a653-64ee7fe6c612",
      "description" : "Auth Router",
      "properties" : {
        "_type" : "messageRouter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageRouter",
        "url" : ""
      },
      "_type" : "messageRouter",
      "branches" : [ {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "setBody",
          "nodeId" : "afb10b14-0bcd-4cf0-a692-595cc59562b0",
          "description" : "Set Request Body",
          "properties" : {
            "_type" : "setBody",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "expression" : "${exchangeProperty.requestBody}",
            "language" : "Simple",
            "name" : "setBody",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setBody",
          "kameletPropertiesUrl" : "?addNamespaces=false&expression=${exchangeProperty.requestBody}&language=Simple&suppressExceptions=false"
        }, {
          "name" : "log",
          "nodeId" : "cc7997d0-50ba-41ea-ad10-dc3eb9986b2a",
          "description" : "210.token.in",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "210.token.in",
            "message" : "${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.token.in&message=${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "setProperties",
          "nodeId" : "8cd3da9e-c8a9-4909-861b-5978d0220218",
          "description" : "Get Input Params",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "JsonPath",
              "propertyName" : "participant",
              "propertyValue" : "$.participant",
              "uuid" : "6e4ae530-4fb3-48e4-9e3a-83c6b49051a1"
            }, {
              "language" : "Header",
              "propertyName" : "agencyId",
              "propertyValue" : "x-agency-id",
              "uuid" : "53a5c144-ba98-45b7-abbd-a45b406aba3a"
            }, {
              "language" : "Simple",
              "propertyName" : "CamelJmsDestinationName",
              "propertyValue" : "providers.video.${exchangeProperty.provider}",
              "uuid" : "f794d088-dee1-48a6-b04d-2394395e88c2"
            }, {
              "language" : "Constant",
              "propertyName" : "x-requested-operation",
              "propertyValue" : "get-access-token",
              "uuid" : "04d62490-fb28-46b3-b5db-ad2d03c4c3ff"
            }, {
              "language" : "Simple",
              "propertyName" : "x-authorized",
              "propertyValue" : "true",
              "uuid" : "7281a9be-1bcc-4a8e-81e0-ead721f03112"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?participant=$.participant&agencyId=x-agency-id&CamelJmsDestinationName=providers.video.${exchangeProperty.provider}&x-requested-operation=get-access-token&x-authorized=true&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "69f45f75-a584-4e8d-a1ad-90e0d504fb42",
          "description" : "Remove Headers",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".removeHeaders(\"*\", \"x-*\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-*\")"
        }, {
          "name" : "setHeaders",
          "nodeId" : "4dd7c433-6623-4bd7-b62f-7d40f8dc912c",
          "description" : "Set Room ID",
          "properties" : {
            "_type" : "setHeaders",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "headerList" : [ {
              "headerName" : "roomId",
              "headerValue" : "${exchangeProperty.roomId}",
              "language" : "Simple",
              "uuid" : "3e4ff40b-e0f8-46f4-9dfc-7471aed10ae7"
            }, {
              "headerName" : "x-requested-operation",
              "headerValue" : "get-access-token",
              "language" : "Constant",
              "uuid" : "598fd5ed-850d-4836-a261-76cd31a5e8d2"
            }, {
              "headerName" : "CamelJmsDestinationName",
              "headerValue" : "providers.video.${exchangeProperty.provider}",
              "language" : "Simple",
              "uuid" : "18de0522-c960-44d9-a1fd-23dad961d61f"
            } ],
            "name" : "setHeaders",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setHeaders",
          "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "direct",
          "nodeId" : "ae37fd10-e7af-4764-b3ee-8e6eb2c8d643",
          "description" : "getVideoRoomById",
          "properties" : {
            "_type" : "direct",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "core",
            "endpointName" : "getVideoRoomById",
            "name" : "direct",
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "direct",
          "kameletPropertiesUrl" : "?endpointName=getVideoRoomById"
        }, {
          "name" : "setProperties",
          "nodeId" : "3e8ac9ed-02b6-48e7-a13e-0b62d1807bcd",
          "description" : "Get Video Room",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "JsonPath",
              "propertyName" : "videoRoom",
              "propertyValue" : "$.data",
              "uuid" : "9e374f2c-dfae-46af-b151-31ff4d045d66"
            }, {
              "language" : "JsonPath",
              "propertyName" : "resourceId",
              "propertyValue" : "$.data.resource_id",
              "uuid" : "954a3f60-8de6-485b-945d-c534137492aa"
            }, {
              "language" : "JsonPath",
              "propertyName" : "resourceUrl",
              "propertyValue" : "$.data.resource_url",
              "uuid" : "6509f6a3-a676-432e-b906-f5ca2563d184"
            }, {
              "language" : "JsonPath",
              "propertyName" : "status",
              "propertyValue" : "$.data.status",
              "uuid" : "6a1b871c-423f-4788-ad60-a3e3893b2e8f"
            }, {
              "language" : "JsonPath",
              "propertyName" : "conversationId",
              "propertyValue" : "$.conversation_id",
              "uuid" : "a0698744-03a6-4286-8ab3-2741a76ae2b6"
            }, {
              "language" : "JsonPath",
              "propertyName" : "conversationStatus",
              "propertyValue" : "$.data.conversation_status",
              "uuid" : "72c445e8-eb34-48c8-b7f5-376b64bcf09e"
            }, {
              "language" : "JsonPath",
              "propertyName" : "provider",
              "propertyValue" : "$.data.provider",
              "uuid" : "7f854b67-16a9-4aa6-b471-9023b9505aff"
            } ],
            "suppressExceptions" : true,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?videoRoom=$.data&resourceId=$.data.resource_id&resourceUrl=$.data.resource_url&status=$.data.status&conversationId=$.conversation_id&conversationStatus=$.data.conversation_status&provider=$.data.provider&addNamespaces=false&suppressExceptions=true"
        }, {
          "name" : "messageRouter",
          "nodeId" : "b050ef05-7daf-442e-828d-05ce71837fc2",
          "description" : "Valid?",
          "properties" : {
            "_type" : "messageRouter",
            "active" : true,
            "camelGroup" : "routing",
            "name" : "messageRouter",
            "url" : ""
          },
          "_type" : "messageRouter",
          "branches" : [ {
            "type" : "route",
            "label" : "route",
            "route" : [ {
              "name" : "setBody",
              "nodeId" : "74dbaeb3-cb5b-4a93-9416-3dfa5be291e7",
              "description" : "Set Token Request",
              "properties" : {
                "_type" : "setBody",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "expression" : "{\"room_id\": \"${exchangeProperty.roomId}\", \"participant\": \"${exchangeProperty.participant}\"}",
                "language" : "Simple",
                "name" : "setBody",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setBody",
              "kameletPropertiesUrl" : "?addNamespaces=false&expression={\"room_id\": \"${exchangeProperty.roomId}\", \"participant\": \"${exchangeProperty.participant}\"}&language=Simple&suppressExceptions=false"
            }, {
              "name" : "exchangePattern",
              "nodeId" : "d0d4964b-83d0-4a7b-981c-5e0956ab27c4",
              "description" : "InOut",
              "properties" : {
                "_type" : "exchangePattern",
                "active" : true,
                "camelGroup" : "core",
                "exchangePattern" : "InOut",
                "name" : "exchangePattern",
                "url" : ""
              },
              "_type" : "exchangePattern",
              "kameletPropertiesUrl" : "?exchangePattern=InOut"
            }, {
              "name" : "setHeaders",
              "nodeId" : "506ec214-4bf0-467c-b6e6-2d447dd984ce",
              "description" : "Set JMS Destination",
              "properties" : {
                "_type" : "setHeaders",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "headerList" : [ {
                  "headerName" : "CamelJmsDestinationName",
                  "headerValue" : "providers.video.${exchangeProperty.provider}",
                  "language" : "Simple",
                  "uuid" : "4e1db998-2376-460e-b29d-64bae18f0d25"
                }, {
                  "headerName" : "x-requested-operation",
                  "headerValue" : "get-access-token",
                  "language" : "Constant",
                  "uuid" : "e8fab027-3748-45bf-88c9-a5596c1c4185"
                } ],
                "name" : "setHeaders",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setHeaders",
              "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "log",
              "nodeId" : "b571207d-72d3-4bab-b4db-a083207a9c50",
              "description" : "jmsin",
              "properties" : {
                "_type" : "log",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "component",
                "level" : "INFO",
                "logType" : "EIP",
                "loggerName" : "api.video.token.jmsin",
                "message" : "(${header.x-requested-operation}) ${body}",
                "multiline" : false,
                "name" : "log",
                "showAll" : false,
                "showBody" : true,
                "showBodyType" : true,
                "showCaughtException" : false,
                "showExchangeId" : false,
                "showHeaders" : false,
                "showProperties" : false,
                "showStackTrace" : false,
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "log",
              "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=api.video.token.jmsin&message=(${header.x-requested-operation}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
            }, {
              "name" : "jms",
              "nodeId" : "e37ec22a-3041-4611-8386-6ca4f5a30753",
              "description" : "providers.{prvdr}.video",
              "properties" : {
                "_type" : "jms",
                "active" : true,
                "advancedParameters" : [ ],
                "asyncConsumer" : false,
                "camelGroup" : "component",
                "concurrentConsumers" : "1",
                "connectionFactory" : "#pooledConnectionFactory",
                "destinationName" : "queue.name",
                "destinationType" : "queue",
                "exchangePattern" : "InOnly",
                "name" : "jms",
                "setConnectionFactory" : true,
                "toDynamicEndpoint" : false,
                "transacted" : true,
                "url" : ""
              },
              "_type" : "jms",
              "kameletPropertiesUrl" : "?asyncConsumer=false&concurrentConsumers=1&connectionFactory=#pooledConnectionFactory&destinationName=queue.name&destinationType=queue&exchangePattern=InOnly&setConnectionFactory=true&transacted=true"
            }, {
              "name" : "log",
              "nodeId" : "6533ede7-74e2-4c12-9c89-842b27f365ac",
              "description" : "jmsout",
              "properties" : {
                "_type" : "log",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "component",
                "level" : "INFO",
                "logType" : "EIP",
                "loggerName" : "api.video.token.jmsout",
                "message" : "(${header.CamelHttpResponseCode}) ${body}",
                "multiline" : false,
                "name" : "log",
                "showAll" : false,
                "showBody" : true,
                "showBodyType" : true,
                "showCaughtException" : false,
                "showExchangeId" : false,
                "showHeaders" : false,
                "showProperties" : false,
                "showStackTrace" : false,
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "log",
              "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=api.video.token.jmsout&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
            }, {
              "name" : "setProperties",
              "nodeId" : "c4250703-6479-494b-a244-071b2558dd88",
              "description" : "Get Access Token",
              "properties" : {
                "_type" : "setProperties",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "name" : "setProperties",
                "namespaces" : [ ],
                "propertyList" : [ {
                  "language" : "JsonPath",
                  "propertyName" : "accessToken",
                  "propertyValue" : "$.access_token",
                  "uuid" : "0cf2bb66-69c7-41ad-96c1-9dc042c756d1"
                } ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setProperties",
              "kameletPropertiesUrl" : "?accessToken=$.access_token&addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "process",
              "nodeId" : "e7c37559-0fd7-46b8-ba75-764e85039389",
              "description" : "Set Response JSON",
              "properties" : {
                "_type" : "process",
                "active" : true,
                "camelGroup" : "transform",
                "code" : "ObjectMapper mapper = new ObjectMapper();\nHashMap<String, String> responseJson = new HashMap<String, String>() {{\n\tput(\"room_id\", (String)exchange.getProperty(\"roomId\"));\n\tput(\"participant\", (String)exchange.getProperty(\"participant\"));\n\tput(\"resource_url\", (String)exchange.getProperty(\"resourceUrl\"));\n\tput(\"resource_id\", (String)exchange.getProperty(\"resourceId\"));\t\n\tput(\"access_token\", (String)exchange.getProperty(\"accessToken\"));\t\n}};\n\nexchange.getIn().setBody(responseJson);",
                "import" : "import com.fasterxml.jackson.databind.ObjectMapper;",
                "name" : "process",
                "url" : ""
              },
              "_type" : "process",
              "kameletPropertiesUrl" : "?code=ObjectMapper mapper = new ObjectMapper();\nHashMap<String, String> responseJson = new HashMap<String, String>() {{\n\tput(\"room_id\", (String)exchange.getProperty(\"roomId\"));\n\tput(\"participant\", (String)exchange.getProperty(\"participant\"));\n\tput(\"resource_url\", (String)exchange.getProperty(\"resourceUrl\"));\n\tput(\"resource_id\", (String)exchange.getProperty(\"resourceId\"));\t\n\tput(\"access_token\", (String)exchange.getProperty(\"accessToken\"));\t\n}};\n\nexchange.getIn().setBody(responseJson);&import=import com.fasterxml.jackson.databind.ObjectMapper;"
            }, {
              "name" : "setHeaders",
              "nodeId" : "3853f445-3346-42b7-a21c-0c70a86bf97e",
              "description" : "HTTP201",
              "properties" : {
                "_type" : "setHeaders",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "headerList" : [ {
                  "headerName" : "CamelHttpResponseCode",
                  "headerValue" : "201",
                  "language" : "Constant",
                  "uuid" : "b6b48a9b-0ca5-4faf-96b5-59b1cb064d4a"
                } ],
                "name" : "setHeaders",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setHeaders",
              "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "dslProcessor",
              "nodeId" : "8e8d2a01-373f-43a5-8e1e-7e0ae23018ef",
              "description" : "Render Response",
              "properties" : {
                "_type" : "dslProcessor",
                "active" : true,
                "camelGroup" : "core",
                "dsl" : ".bean(\"renderResponse\")",
                "name" : "dslProcessor",
                "url" : ""
              },
              "_type" : "dslProcessor",
              "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
            }, {
              "name" : "log",
              "nodeId" : "74ea5573-c64c-4782-9ed7-562e0387c912",
              "description" : "out",
              "properties" : {
                "_type" : "log",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "component",
                "level" : "INFO",
                "logType" : "EIP",
                "loggerName" : "api.video.token.out",
                "message" : "(${header.CamelHttpResponseCode}) ${body}",
                "multiline" : false,
                "name" : "log",
                "showAll" : false,
                "showBody" : true,
                "showBodyType" : true,
                "showCaughtException" : false,
                "showExchangeId" : false,
                "showHeaders" : false,
                "showProperties" : false,
                "showStackTrace" : false,
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "log",
              "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=api.video.token.out&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
            } ],
            "properties" : { }
          }, {
            "type" : "when",
            "label" : "404",
            "route" : [ {
              "name" : "setHeaders",
              "nodeId" : "2f62d6eb-6f9e-4fa6-baf4-79387c9183ff",
              "description" : "HTTP404",
              "properties" : {
                "_type" : "setHeaders",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "headerList" : [ {
                  "headerName" : "CamelHttpResponseCode",
                  "headerValue" : "404",
                  "language" : "Constant",
                  "uuid" : "7a7c8426-430f-4225-a90e-c084215bf364"
                } ],
                "name" : "setHeaders",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setHeaders",
              "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "setBody",
              "nodeId" : "12f2c25d-a515-4d9b-b0c1-22115632a3bf",
              "description" : "Clear Body",
              "properties" : {
                "_type" : "setBody",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "expression" : "constant('')",
                "language" : "GroovyDsl",
                "name" : "setBody",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setBody",
              "kameletPropertiesUrl" : "?addNamespaces=false&expression=constant('')&language=GroovyDsl&suppressExceptions=false"
            }, {
              "name" : "log",
              "nodeId" : "71d77831-dd77-4a1e-b7ca-700a2df48982",
              "description" : "404",
              "properties" : {
                "_type" : "log",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "component",
                "level" : "WARN",
                "logType" : "EIP",
                "loggerName" : "api.video.token.404",
                "message" : "(${header.CamelHttpResponseCode}) Video Room not found",
                "multiline" : false,
                "name" : "log",
                "showAll" : false,
                "showBody" : true,
                "showBodyType" : true,
                "showCaughtException" : false,
                "showExchangeId" : false,
                "showHeaders" : false,
                "showProperties" : false,
                "showStackTrace" : false,
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "log",
              "kameletPropertiesUrl" : "?level=WARN&logType=EIP&loggerName=api.video.token.404&message=(${header.CamelHttpResponseCode}) Video Room not found&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
            }, {
              "name" : "stop",
              "nodeId" : "e96c5248-d414-47bc-b157-af2167ececc8",
              "description" : "",
              "properties" : {
                "_type" : "stop",
                "camelGroup" : "misc",
                "name" : "stop",
                "url" : ""
              },
              "_type" : "stop",
              "kameletPropertiesUrl" : ""
            } ],
            "properties" : {
              "addNamespaces" : "false",
              "condition" : "${header.CamelHttpResponseCode} == 404",
              "language" : "Simple",
              "namespaces" : [ ],
              "suppressExceptions" : "false"
            }
          }, {
            "type" : "when",
            "label" : "!active",
            "route" : [ {
              "name" : "setHeaders",
              "nodeId" : "e555b7ed-483d-4412-b321-89dd90876ae2",
              "description" : "HTTP400",
              "properties" : {
                "_type" : "setHeaders",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "headerList" : [ {
                  "headerName" : "CamelHttpResponseCode",
                  "headerValue" : "400",
                  "language" : "Constant",
                  "uuid" : "f4d53037-94be-4242-b382-af886945436d"
                } ],
                "name" : "setHeaders",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setHeaders",
              "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "setProperties",
              "nodeId" : "c3ff937d-033e-4506-8672-57461954f408",
              "description" : "Set Error",
              "properties" : {
                "_type" : "setProperties",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "name" : "setProperties",
                "namespaces" : [ ],
                "propertyList" : [ {
                  "language" : "Constant",
                  "propertyName" : "error",
                  "propertyValue" : "Resource not active. Can not grant access to video room.",
                  "uuid" : "7adfdfb5-90e9-4bd5-8715-53ad54d8f661"
                } ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setProperties",
              "kameletPropertiesUrl" : "?error=Resource not active. Can not grant access to video room.&addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "dslProcessor",
              "nodeId" : "a6e4538c-33da-4c40-91bb-cab1c4e4e0bd",
              "description" : "Render Response",
              "properties" : {
                "_type" : "dslProcessor",
                "active" : true,
                "camelGroup" : "core",
                "dsl" : ".bean(\"renderResponse\")",
                "name" : "dslProcessor",
                "url" : ""
              },
              "_type" : "dslProcessor",
              "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
            }, {
              "name" : "log",
              "nodeId" : "48c3c8ae-87ad-44f2-97b4-9859f3f6954f",
              "description" : "400",
              "properties" : {
                "_type" : "log",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "component",
                "level" : "WARN",
                "logType" : "EIP",
                "loggerName" : "api.video.token.400",
                "message" : "(${header.CamelHttpResponseCode}) ${body}",
                "multiline" : false,
                "name" : "log",
                "showAll" : false,
                "showBody" : true,
                "showBodyType" : true,
                "showCaughtException" : false,
                "showExchangeId" : false,
                "showHeaders" : false,
                "showProperties" : false,
                "showStackTrace" : false,
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "log",
              "kameletPropertiesUrl" : "?level=WARN&logType=EIP&loggerName=api.video.token.400&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
            }, {
              "name" : "stop",
              "nodeId" : "5fc93f16-14b9-4ef0-b8e1-04a99972b3d6",
              "description" : "",
              "properties" : {
                "_type" : "stop",
                "camelGroup" : "misc",
                "name" : "stop",
                "url" : ""
              },
              "_type" : "stop",
              "kameletPropertiesUrl" : ""
            } ],
            "properties" : {
              "addNamespaces" : "false",
              "condition" : "${exchangeProperty.conversationStatus} != 'active' || ${exchangeProperty.status} != 'in-progress'",
              "language" : "Simple",
              "namespaces" : [ ],
              "suppressExceptions" : "false"
            }
          } ],
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : { }
      }, {
        "type" : "when",
        "label" : "x-access-token",
        "route" : [ {
          "name" : "setProperties",
          "nodeId" : "43191464-9cdb-4312-aecc-ca3b4f65cc11",
          "description" : "Set Operation ID",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Constant",
              "propertyName" : "x-operation-id",
              "propertyValue" : "createVideoRoomToken",
              "uuid" : "f428ef3a-261c-418c-9c93-ab3d314c2777"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?x-operation-id=createVideoRoomToken&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "d422381f-d8f1-4920-b617-eeb59bb777de",
          "description" : "Remove Headers",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".removeHeaders(\"*\", \"x-*\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-*\")"
        }, {
          "name" : "messagingEndpoint",
          "nodeId" : "70bdc5bd-ea6d-4746-b7dd-71c1ebe38e90",
          "description" : "SQL Validate Token",
          "properties" : {
            "_type" : "messagingEndpoint",
            "active" : true,
            "camelGroup" : "core",
            "name" : "messagingEndpoint",
            "toDynamicEndpoint" : false,
            "uri" : "sql:SELECT token FROM tokens WHERE access_token = :#${exchangeProperty.xAccessToken} AND expires_at >= NOW()?dataSource=#dsPostgres&OutputType=SelectOne",
            "url" : ""
          },
          "_type" : "messagingEndpoint",
          "kameletPropertiesUrl" : "?uri=sql:SELECT token FROM tokens WHERE access_token = :#${exchangeProperty.xAccessToken} AND expires_at >= NOW()?dataSource=#dsPostgres&OutputType=SelectOne"
        }, {
          "name" : "messageFilter",
          "nodeId" : "20b1e2cb-58b9-42ab-a765-a186380235fb",
          "description" : "",
          "properties" : {
            "_type" : "messageFilter",
            "active" : true,
            "camelGroup" : "routing",
            "name" : "messageFilter",
            "url" : ""
          },
          "_type" : "messageFilter",
          "branches" : [ {
            "type" : "filter",
            "label" : "filter",
            "route" : [ {
              "name" : "log",
              "nodeId" : "e2d665b8-4eb9-46a3-a3a1-08b0caece65b",
              "description" : "401",
              "properties" : {
                "_type" : "log",
                "active" : true,
                "advancedParameters" : [ ],
                "camelGroup" : "component",
                "level" : "INFO",
                "logType" : "EIP",
                "loggerName" : "210.api.token.401",
                "message" : "Invalid X-Access-Token",
                "multiline" : false,
                "name" : "log",
                "showAll" : false,
                "showBody" : true,
                "showBodyType" : true,
                "showCaughtException" : false,
                "showExchangeId" : false,
                "showHeaders" : false,
                "showProperties" : false,
                "showStackTrace" : false,
                "toDynamicEndpoint" : false,
                "url" : ""
              },
              "_type" : "log",
              "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.api.token.401&message=Invalid X-Access-Token&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
            }, {
              "name" : "setHeaders",
              "nodeId" : "f7ee8b3a-319c-4f3a-8345-12d18c4076bf",
              "description" : "HTTP404",
              "properties" : {
                "_type" : "setHeaders",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "headerList" : [ {
                  "headerName" : "CamelHttpResponseCode",
                  "headerValue" : "404",
                  "language" : "Constant",
                  "uuid" : "515e55ab-4cb5-4eeb-817d-65a8eb8e842b"
                } ],
                "name" : "setHeaders",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setHeaders",
              "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
            }, {
              "name" : "setBody",
              "nodeId" : "c45403c8-4528-4f53-b504-2f65b6dc304e",
              "description" : "Clear Body",
              "properties" : {
                "_type" : "setBody",
                "active" : true,
                "addNamespaces" : false,
                "camelGroup" : "core",
                "expression" : "constant('')",
                "language" : "GroovyDsl",
                "name" : "setBody",
                "namespaces" : [ ],
                "suppressExceptions" : false,
                "url" : ""
              },
              "_type" : "setBody",
              "kameletPropertiesUrl" : "?addNamespaces=false&expression=constant('')&language=GroovyDsl&suppressExceptions=false"
            }, {
              "name" : "stop",
              "nodeId" : "9ac6fc12-3dd9-453d-a626-bd05347d225e",
              "description" : "",
              "properties" : {
                "_type" : "stop",
                "camelGroup" : "misc",
                "name" : "stop",
                "url" : ""
              },
              "_type" : "stop",
              "kameletPropertiesUrl" : ""
            } ],
            "properties" : {
              "addNamespaces" : "false",
              "condition" : "${header.foo} == \"bar\"",
              "language" : "Simple",
              "namespaces" : [ ],
              "suppressExceptions" : "false"
            }
          } ],
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${exchangeProperty.xAccessToken} != null",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      }, {
        "type" : "otherwise",
        "label" : "otherwise",
        "route" : [ {
          "name" : "dslProcessor",
          "nodeId" : "48987a0c-9d01-469b-bf20-7a4c68aea4fc",
          "description" : "Validate JWT",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "edaa4a81-a9a3-4f41-9cd6-2f2cbdfe4eed",
          "description" : "Validate Request",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".to(\"bean:validateRequest\")\n    .filter().simple('${header.CamelHttpResponseCode} >= 400')\n    \t.bean('renderResponse')\n    \t.log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    \t.stop()\n      .end()",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.to(\"bean:validateRequest\")\n    .filter().simple('${header.CamelHttpResponseCode} >= 400')\n    \t.bean('renderResponse')\n    \t.log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    \t.stop()\n      .end()"
        } ],
        "properties" : { }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-10",
    "enabled" : true,
    "routeId" : 10,
    "route" : [ {
      "name" : "getRequest",
      "nodeId" : "5246317a-505c-45fd-9b57-8912f95126f4",
      "description" : "getVideoRoomParticipants",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/videorooms/{roomId}/participants",
        "method" : "get",
        "name" : "getRequest",
        "operationName" : "getVideoRoomParticipants",
        "produces" : "application/json",
        "requestmethod" : "GET",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/videorooms/{roomId}/participants&method=get&operationName=getVideoRoomParticipants&produces=application/json&requestmethod=GET"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "d48d0016-0c14-47b5-9782-0d5895e9d67e",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "b0f85e82-47a2-4629-b7b3-6b359884d650",
      "description" : "Validate Request",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"bean:validateRequest\")\n    .filter().simple('${header.CamelHttpResponseCode} >= 400')\n    \t.bean('renderResponse')\n    \t.log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    \t.stop()\n      .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"bean:validateRequest\")\n    .filter().simple('${header.CamelHttpResponseCode} >= 400')\n    \t.bean('renderResponse')\n    \t.log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    \t.stop()\n      .end()"
    }, {
      "name" : "setProperties",
      "nodeId" : "baf09368-2f8a-433e-83b0-d082995953d4",
      "description" : "Get Input Params",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Header",
          "propertyName" : "roomId",
          "propertyValue" : "roomId",
          "uuid" : "b485af8f-9e1d-4386-b603-ad91b35b6d69"
        }, {
          "language" : "Header",
          "propertyName" : "agencyId",
          "propertyValue" : "x-agency-id",
          "uuid" : "3b35b1fc-dd7f-48db-9cef-f2edd7d4ec7a"
        }, {
          "language" : "Header",
          "propertyName" : "participantStatus",
          "propertyValue" : "participantStatus",
          "uuid" : "23748061-fcd5-4a27-bce3-3947cbc8cb5b"
        } ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?roomId=roomId&agencyId=x-agency-id&participantStatus=participantStatus&addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "22f76ecc-5657-40a1-ae83-b010ac8de9f8",
      "description" : "Remove Headers",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".removeHeaders(\"*\", \"x-\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-\")"
    }, {
      "name" : "messagingEndpoint",
      "nodeId" : "87067cc4-b9fe-46c7-a50a-7cf9ee6f6235",
      "description" : "SQL Validate RoomId",
      "properties" : {
        "_type" : "messagingEndpoint",
        "active" : true,
        "camelGroup" : "core",
        "name" : "messagingEndpoint",
        "toDynamicEndpoint" : false,
        "uri" : "sql:SELECT resource_id FROM video_rooms WHERE id = CAST(:#${exchangeProperty.roomId} AS uuid)?dataSource=#dsPostgres&OutputType=SelectOne",
        "url" : ""
      },
      "_type" : "messagingEndpoint",
      "kameletPropertiesUrl" : "?uri=sql:SELECT resource_id FROM video_rooms WHERE id = CAST(:#${exchangeProperty.roomId} AS uuid)?dataSource=#dsPostgres&OutputType=SelectOne"
    }, {
      "name" : "messageFilter",
      "nodeId" : "2eec2c94-4433-4863-9f43-a23bb83fbd3b",
      "description" : "Valid?",
      "properties" : {
        "_type" : "messageFilter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageFilter",
        "url" : ""
      },
      "_type" : "messageFilter",
      "branches" : [ {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "setProperties",
          "nodeId" : "16288567-0131-45dc-b8b8-9f2dcade281c",
          "description" : "Get Resource ID",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Simple",
              "propertyName" : "resourceId",
              "propertyValue" : "${body}",
              "uuid" : "61c5fdc0-563a-4651-9324-e413a2957b2a"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?resourceId=${body}&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "c957d9ba-3845-4c52-a9ce-f428806837af",
          "description" : "Remove Headers",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".removeHeaders(\"*\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\")"
        }, {
          "name" : "setHeaders",
          "nodeId" : "abf4061e-be3d-4fcb-bedf-448ae01ccea8",
          "description" : "Set Operation",
          "properties" : {
            "_type" : "setHeaders",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "headerList" : [ {
              "headerName" : "x-requested-operation",
              "headerValue" : "get-participants",
              "language" : "Constant",
              "uuid" : "cbd387d3-50fa-4b56-b5fb-506176c614af"
            }, {
              "headerName" : "x-participant-status",
              "headerValue" : "${exchangeProperty.participantStatus}",
              "language" : "Simple",
              "uuid" : "14815d80-fe85-4761-8bfb-43e173a06cc6"
            } ],
            "name" : "setHeaders",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setHeaders",
          "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "exchangePattern",
          "nodeId" : "1c7ef135-a152-4f44-8c7d-4932a0b55d27",
          "description" : "InOut",
          "properties" : {
            "_type" : "exchangePattern",
            "active" : true,
            "camelGroup" : "core",
            "exchangePattern" : "InOut",
            "name" : "exchangePattern",
            "url" : ""
          },
          "_type" : "exchangePattern",
          "kameletPropertiesUrl" : "?exchangePattern=InOut"
        }, {
          "name" : "setBody",
          "nodeId" : "70eba3e2-bdc4-4a5e-b72d-5c199b9ca812",
          "description" : "Set Resource ID",
          "properties" : {
            "_type" : "setBody",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "expression" : "{\"resource_id\": \"${exchangeProperty.resourceId}\"}",
            "language" : "Simple",
            "name" : "setBody",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setBody",
          "kameletPropertiesUrl" : "?addNamespaces=false&expression={\"resource_id\": \"${exchangeProperty.resourceId}\"}&language=Simple&suppressExceptions=false"
        }, {
          "name" : "jms",
          "nodeId" : "4df0f1f2-4655-4c5c-9227-9b4d765c41c1",
          "description" : "providers.video.twilio",
          "properties" : {
            "_type" : "jms",
            "active" : true,
            "advancedParameters" : [ ],
            "asyncConsumer" : false,
            "camelGroup" : "component",
            "concurrentConsumers" : "1",
            "connectionFactory" : "#pooledConnectionFactory",
            "destinationName" : "providers.video.twilio",
            "destinationType" : "queue",
            "exchangePattern" : "InOnly",
            "name" : "jms",
            "setConnectionFactory" : true,
            "toDynamicEndpoint" : false,
            "transacted" : false,
            "url" : ""
          },
          "_type" : "jms",
          "kameletPropertiesUrl" : "?asyncConsumer=false&concurrentConsumers=1&connectionFactory=#pooledConnectionFactory&destinationName=providers.video.twilio&destinationType=queue&exchangePattern=InOnly&setConnectionFactory=true&transacted=false"
        }, {
          "name" : "convertBodyTo",
          "nodeId" : "920ae198-55d6-462a-9020-4cfdeb3937ff",
          "description" : "",
          "properties" : {
            "_type" : "convertBodyTo",
            "active" : true,
            "camelGroup" : "transform",
            "name" : "convertBodyTo",
            "targetClass" : "String.class",
            "url" : ""
          },
          "_type" : "convertBodyTo",
          "kameletPropertiesUrl" : "?targetClass=String.class"
        }, {
          "name" : "setBody",
          "nodeId" : "2da11001-7441-475a-8608-cc28acbef941",
          "description" : "Get JSON",
          "properties" : {
            "_type" : "setBody",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "expression" : "$.participants",
            "language" : "JsonPath",
            "name" : "setBody",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setBody",
          "kameletPropertiesUrl" : "?addNamespaces=false&expression=$.participants&language=JsonPath&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "cd1586bd-147e-4b37-8a15-e64aed3f110b",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean(\"renderResponse\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
        }, {
          "name" : "log",
          "nodeId" : "6e74bfca-c67e-4e8c-a794-f03c70e49cf4",
          "description" : "210.api.prcpt.get.out",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "210.api.prcpt.get.out",
            "message" : "(${header.CamelHttpResponseCode}) ${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.api.prcpt.get.out&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        } ],
        "properties" : { }
      }, {
        "type" : "filter",
        "label" : "rowcount == 0",
        "route" : [ {
          "name" : "setHeaders",
          "nodeId" : "ca7870a6-06c0-43a3-a550-ec891117d7fd",
          "description" : "HTTP404",
          "properties" : {
            "_type" : "setHeaders",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "headerList" : [ {
              "headerName" : "CamelHttpResponseCode",
              "headerValue" : "404",
              "language" : "Constant",
              "uuid" : "d8f19eaa-bad2-49bc-8806-1d984f41036d"
            } ],
            "name" : "setHeaders",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setHeaders",
          "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "clearBody",
          "nodeId" : "5e894de2-4c03-4254-8241-48942bb92ce7",
          "description" : "",
          "properties" : {
            "_type" : "clearBody",
            "camelGroup" : "core",
            "name" : "clearBody",
            "url" : ""
          },
          "_type" : "clearBody",
          "kameletPropertiesUrl" : ""
        }, {
          "name" : "stop",
          "nodeId" : "439ebdcf-b918-48b7-be50-84ad68603d9e",
          "description" : "",
          "properties" : {
            "_type" : "stop",
            "camelGroup" : "misc",
            "name" : "stop",
            "url" : ""
          },
          "_type" : "stop",
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${header.CamelSqlRowCount} == 0",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-11",
    "enabled" : true,
    "routeId" : 11,
    "route" : [ {
      "name" : "postRequest",
      "nodeId" : "da2733d7-9b2b-496b-b0a5-cb1e93dd81f3",
      "description" : "addVideoRoomParticipant",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/videorooms/{roomId}/participants",
        "method" : "post",
        "name" : "postRequest",
        "operationName" : "addVideoRoomParticipant",
        "produces" : "application/json",
        "requestmethod" : "POST",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/videorooms/{roomId}/participants&method=post&operationName=addVideoRoomParticipant&produces=application/json&requestmethod=POST"
    }, {
      "name" : "convertBodyTo",
      "nodeId" : "d5a3a3e3-1529-44f0-8282-a298f47a1931",
      "description" : "",
      "properties" : {
        "_type" : "convertBodyTo",
        "active" : true,
        "camelGroup" : "transform",
        "name" : "convertBodyTo",
        "targetClass" : "String.class",
        "url" : ""
      },
      "_type" : "convertBodyTo",
      "kameletPropertiesUrl" : "?targetClass=String.class"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "0a32eca6-d336-47cf-97b4-5830c0bb9372",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "459e30e2-332b-44af-835e-6e86d6407cf6",
      "description" : "Validate Request",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"bean:validateRequest\")\n    .filter().simple('${header.CamelHttpResponseCode} >= 400')\n    \t.bean('renderResponse')\n    \t.log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    \t.stop()\n      .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"bean:validateRequest\")\n    .filter().simple('${header.CamelHttpResponseCode} >= 400')\n    \t.bean('renderResponse')\n    \t.log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    \t.stop()\n      .end()"
    }, {
      "name" : "log",
      "nodeId" : "cbce74dd-5cb0-449b-9217-b427cbc76863",
      "description" : "210.api.prcpt.add.in",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "INFO",
        "logType" : "EIP",
        "loggerName" : "210.api.prcpt.add.in",
        "message" : "${body}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.api.prcpt.add.in&message=${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "setProperties",
      "nodeId" : "1c5a6bc3-7815-4660-bc05-aa9fb822ba5b",
      "description" : "Get Input Params",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Header",
          "propertyName" : "roomId",
          "propertyValue" : "roomId",
          "uuid" : "1850a40c-1e5a-4a78-87c8-6a43a6b5b086"
        }, {
          "language" : "JsonPath",
          "propertyName" : "participant",
          "propertyValue" : "$.participant",
          "uuid" : "855eee17-61ce-4108-b9d6-d85bcde20d5d"
        }, {
          "language" : "JsonPath",
          "propertyName" : "metadata",
          "propertyValue" : "$.metadata",
          "uuid" : "19977482-ce38-4a2c-9688-500472bc3529"
        }, {
          "language" : "JsonPath",
          "propertyName" : "participantId",
          "propertyValue" : "$.participant_id",
          "uuid" : "be2f5592-6621-4fd9-b120-e78c9ce63e4e"
        }, {
          "language" : "Simple",
          "propertyName" : "requestBody",
          "propertyValue" : "${body}",
          "uuid" : "32df57b1-8a7f-49c6-ad51-d10e4b8d9070"
        } ],
        "suppressExceptions" : true,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?roomId=roomId&participant=$.participant&metadata=$.metadata&participantId=$.participant_id&requestBody=${body}&addNamespaces=false&suppressExceptions=true"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "6653e706-0f33-42b8-810b-c4ce14660c81",
      "description" : "Remove Headers",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".removeHeaders(\"*\", \"x-*\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-*\")"
    }, {
      "name" : "setHeaders",
      "nodeId" : "e08fc5e4-dd87-46fb-8954-90fd9f38ed5f",
      "description" : "Set Room ID",
      "properties" : {
        "_type" : "setHeaders",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "headerList" : [ {
          "headerName" : "roomId",
          "headerValue" : "${exchangeProperty.roomId}",
          "language" : "Simple",
          "uuid" : "87828f06-be77-4d11-91ff-c0f3a29e4a5c"
        } ],
        "name" : "setHeaders",
        "namespaces" : [ ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setHeaders",
      "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "direct",
      "nodeId" : "7b44f259-a32b-49e7-b6f2-7affda0b1181",
      "description" : "getVideoRoomById",
      "properties" : {
        "_type" : "direct",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "core",
        "endpointName" : "getVideoRoomById",
        "name" : "direct",
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "direct",
      "kameletPropertiesUrl" : "?endpointName=getVideoRoomById"
    }, {
      "name" : "messageFilter",
      "nodeId" : "76413f2a-3780-4555-8859-94d6c3442ada",
      "description" : "",
      "properties" : {
        "_type" : "messageFilter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageFilter",
        "url" : ""
      },
      "_type" : "messageFilter",
      "branches" : [ {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "setProperties",
          "nodeId" : "54cef132-e576-4dcc-b125-5e44dac2bd92",
          "description" : "Set Agency",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "JsonPath",
              "propertyName" : "agencyId",
              "propertyValue" : "$.data.agency_id",
              "uuid" : "7458ba0c-cf55-4653-b7b2-afbf96a84e33"
            }, {
              "language" : "JsonPath",
              "propertyName" : "conversationId",
              "propertyValue" : "$.data.agency_id",
              "uuid" : "5e7b0fca-f19e-480b-ad33-50dadf1c587f"
            } ],
            "suppressExceptions" : true,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?agencyId=$.data.agency_id&conversationId=$.data.agency_id&addNamespaces=false&suppressExceptions=true"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "695b6fe0-5cf0-4552-b87b-bf437dfe90fe",
          "description" : "SQL Add Participant",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".to(\"sql:classpath:video_participants.insert.sql?dataSource=#dsPostgres\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.to(\"sql:classpath:video_participants.insert.sql?dataSource=#dsPostgres\")"
        }, {
          "name" : "process",
          "nodeId" : "fc7b651d-f692-49be-bd75-43c2913bb67f",
          "description" : "Format Response",
          "properties" : {
            "_type" : "process",
            "active" : true,
            "camelGroup" : "transform",
            "code" : "HashMap<String, Object> response = new HashMap<String, Object>() {{\n\tput(\"room_id\", (String)exchange.getProperty(\"roomId\"));\n\tput(\"participant\", (String)exchange.getProperty(\"participant\"));\n\tput(\"participant_id\", (String)exchange.getProperty(\"participantId\"));\t\n\tput(\"metadata\", (HashMap)exchange.getProperty(\"metadata\"));\n\tput(\"agency_id\", (String)exchange.getProperty(\"agencyId\"));\t\n}};\n\nexchange.getIn().setBody(response);",
            "import" : "",
            "name" : "process",
            "url" : ""
          },
          "_type" : "process",
          "kameletPropertiesUrl" : "?code=HashMap<String, Object> response = new HashMap<String, Object>() {{\n\tput(\"room_id\", (String)exchange.getProperty(\"roomId\"));\n\tput(\"participant\", (String)exchange.getProperty(\"participant\"));\n\tput(\"participant_id\", (String)exchange.getProperty(\"participantId\"));\t\n\tput(\"metadata\", (HashMap)exchange.getProperty(\"metadata\"));\n\tput(\"agency_id\", (String)exchange.getProperty(\"agencyId\"));\t\n}};\n\nexchange.getIn().setBody(response);"
        }, {
          "name" : "setHeaders",
          "nodeId" : "051135e2-f542-4cf4-9896-da9b351f9c1e",
          "description" : "HTTP201",
          "properties" : {
            "_type" : "setHeaders",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "headerList" : [ {
              "headerName" : "CamelHttpResponseCode",
              "headerValue" : "201",
              "language" : "Constant",
              "uuid" : "3bdeee8f-4de6-41fa-bf35-156267010ba7"
            } ],
            "name" : "setHeaders",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setHeaders",
          "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "f1f124a4-99ff-42b5-9f80-eb175f0c24d8",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean(\"renderResponse\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
        }, {
          "name" : "log",
          "nodeId" : "ffff6d81-9284-46b3-9db2-d20ab7138858",
          "description" : "210.api.prcpt.add.out",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "210.api.prcpt.add.out",
            "message" : "(${header.CamelHttpResponseCode}) ${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.api.prcpt.add.out&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "seda",
          "nodeId" : "b05be728-d5f0-44f9-bc1d-2f6320560617",
          "description" : "publish-event",
          "properties" : {
            "_type" : "seda",
            "active" : true,
            "advancedParameters" : [ ],
            "blockWhenFull" : false,
            "camelGroup" : "core",
            "concurrentConsumers" : "1",
            "endpointName" : "publish-event",
            "limitConcurrentConsumers" : true,
            "multipleConsumers" : false,
            "name" : "seda",
            "pollTimeout" : "1000",
            "size" : "1000",
            "specifyMaximumCapacitySize" : false,
            "timeout" : "30000",
            "toDynamicEndpoint" : false,
            "url" : "",
            "waitForTaskToComplete" : "Never"
          },
          "_type" : "seda",
          "kameletPropertiesUrl" : "?blockWhenFull=false&concurrentConsumers=1&endpointName=publish-event&limitConcurrentConsumers=true&multipleConsumers=false&pollTimeout=1000&size=1000&specifyMaximumCapacitySize=false&timeout=30000&waitForTaskToComplete=Never"
        } ],
        "properties" : { }
      }, {
        "type" : "filter",
        "label" : "404",
        "route" : [ {
          "name" : "setProperties",
          "nodeId" : "76197a46-e3a1-4ab1-8607-a6914b7a4364",
          "description" : "Set Error",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Constant",
              "propertyName" : "error",
              "propertyValue" : "Video Room Not Found",
              "uuid" : "b8ca9fad-13db-48c0-b518-4ca7e24a0c3f"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?error=Video Room Not Found&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "f46120c4-2754-4972-a171-869722f5c572",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean('renderResponse')",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean('renderResponse')"
        }, {
          "name" : "stop",
          "nodeId" : "83cc22de-b23e-44e2-aa49-a33b95bb141a",
          "description" : "",
          "properties" : {
            "_type" : "stop",
            "camelGroup" : "misc",
            "name" : "stop",
            "url" : ""
          },
          "_type" : "stop",
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${header.CamelHttpResponseCode} == 404",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-12",
    "enabled" : true,
    "routeId" : 12,
    "route" : [ {
      "name" : "getRequest",
      "nodeId" : "1c081c92-3017-4e5f-a68a-119fb0e48243",
      "description" : "getVideoRoomParticipant",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/videorooms/{roomId}/participants/{participantId}",
        "method" : "get",
        "name" : "getRequest",
        "operationName" : "getVideoRoomParticipant",
        "produces" : "application/json",
        "requestmethod" : "GET",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/videorooms/{roomId}/participants/{participantId}&method=get&operationName=getVideoRoomParticipant&produces=application/json&requestmethod=GET"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "1bc3a37c-b79c-4751-9537-d12da2a18eca",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "4c18cf6e-e16b-4257-a9ac-d3e4bae5e47d",
      "description" : "Validate Request",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"bean:validateRequest\")\n    .filter().simple('${header.CamelHttpResponseCode} >= 400')\n    \t.bean('renderResponse')\n    \t.log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    \t.stop()\n      .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"bean:validateRequest\")\n    .filter().simple('${header.CamelHttpResponseCode} >= 400')\n    \t.bean('renderResponse')\n    \t.log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    \t.stop()\n      .end()"
    }, {
      "name" : "setProperties",
      "nodeId" : "53c80625-183a-4a72-bd04-e1ad5f076420",
      "description" : "Get Input Params",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Header",
          "propertyName" : "roomId",
          "propertyValue" : "roomId",
          "uuid" : "7c554eb5-a5cb-462c-b1e6-9f2f056a71f8"
        }, {
          "language" : "Header",
          "propertyName" : "participantId",
          "propertyValue" : "participantId",
          "uuid" : "41805042-4bf6-44a4-b6a9-4381aa34e99e"
        }, {
          "language" : "Header",
          "propertyName" : "agencyId",
          "propertyValue" : "x-agency-id",
          "uuid" : "2e799a0a-3930-4673-a74c-a351e0c9afe3"
        } ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?roomId=roomId&participantId=participantId&agencyId=x-agency-id&addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "de5b6258-547e-4a7d-8c0e-6a41bcce73f4",
      "description" : "Remove Headers",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".removeHeaders(\"*\", \"x-*\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-*\")"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "2c473263-741c-4750-aa2f-2821bee69398",
      "description" : "SQL Get Participant",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"velocity:video_participants.select.sql.vm?allowContextMapAll=true\")\n.log(LoggingLevel.INFO, 'log', '${body}')\n.to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectOne&useMessageBodyForSql=true\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"velocity:video_participants.select.sql.vm?allowContextMapAll=true\")\n.log(LoggingLevel.INFO, 'log', '${body}')\n.to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectOne&useMessageBodyForSql=true\")"
    }, {
      "name" : "setHeaders",
      "nodeId" : "accae89a-71c3-4380-98e4-1fd8bc6b8fec",
      "description" : "HTTP200",
      "properties" : {
        "_type" : "setHeaders",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "headerList" : [ {
          "headerName" : "CamelHttpResponseCode",
          "headerValue" : "200",
          "language" : "Constant",
          "uuid" : "b11b1660-263e-4e3c-9bb9-f63e0dc02365"
        } ],
        "name" : "setHeaders",
        "namespaces" : [ ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setHeaders",
      "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "2a3286da-91e9-4b66-9688-acf7eb20b76c",
      "description" : "Render Response",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean(\"renderResponse\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
    } ]
  }, {
    "id" : null,
    "camelRouteId" : "route-13",
    "enabled" : true,
    "routeId" : 13,
    "route" : [ {
      "name" : "deleteRequest",
      "nodeId" : "17d62910-82c3-43a8-8fd1-20b685a0a939",
      "description" : "deleteVideoRoomParticipan",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/videorooms/{roomId}/participants/{participantId}",
        "method" : "delete",
        "name" : "deleteRequest",
        "operationName" : "deleteVideoRoomParticipant",
        "produces" : "application/json",
        "requestmethod" : "DELETE",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/videorooms/{roomId}/participants/{participantId}&method=delete&operationName=deleteVideoRoomParticipant&produces=application/json&requestmethod=DELETE"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "175649a6-1634-4d59-a2ed-fb4965b279cf",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "18814485-4c0d-4bd8-873a-870e094c652b",
      "description" : "Validate Request",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"bean:validateRequest\")\n    .filter().simple('${header.CamelHttpResponseCode} >= 400')\n    \t.bean('renderResponse')\n    \t.log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    \t.stop()\n      .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"bean:validateRequest\")\n    .filter().simple('${header.CamelHttpResponseCode} >= 400')\n    \t.bean('renderResponse')\n    \t.log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n    \t.stop()\n      .end()"
    }, {
      "name" : "setProperties",
      "nodeId" : "ad18270d-98f2-4638-84c3-9fc4db581d2b",
      "description" : "Get Input Params",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Header",
          "propertyName" : "roomId",
          "propertyValue" : "roomId",
          "uuid" : "1050fa8d-d788-4003-9f37-593d9e5da230"
        }, {
          "language" : "Header",
          "propertyName" : "participantId",
          "propertyValue" : "participantId",
          "uuid" : "17a15641-86ac-4eb4-af8d-d2838b659cdf"
        }, {
          "language" : "Header",
          "propertyName" : "agencyId",
          "propertyValue" : "x-agency-id",
          "uuid" : "8a9a6f6d-e621-45cc-ad27-5230fb7e47c1"
        }, {
          "language" : "Simple",
          "propertyName" : "requestBody",
          "propertyValue" : "${body}",
          "uuid" : "d62ae1a9-0ec1-43ae-9372-21f04410e226"
        } ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?roomId=roomId&participantId=participantId&agencyId=x-agency-id&requestBody=${body}&addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "log",
      "nodeId" : "ab79e07b-cda6-47b0-b110-02404b214c73",
      "description" : "210.api.prcpt.del.in",
      "properties" : {
        "_type" : "log",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "component",
        "level" : "INFO",
        "logType" : "EIP",
        "loggerName" : "210.api.prcpt.del.in",
        "message" : "DELETE /${exchangeProperty.roomId}/${exchangeProperty.participantId}",
        "multiline" : false,
        "name" : "log",
        "showAll" : false,
        "showBody" : true,
        "showBodyType" : true,
        "showCaughtException" : false,
        "showExchangeId" : false,
        "showHeaders" : false,
        "showProperties" : false,
        "showStackTrace" : false,
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "log",
      "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.api.prcpt.del.in&message=DELETE /${exchangeProperty.roomId}/${exchangeProperty.participantId}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "6d086e39-ae11-41d1-a999-3ccf16013317",
      "description" : "Remove Headers",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".removeHeaders(\"*\", \"x-*\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\", \"x-*\")"
    }, {
      "name" : "setHeaders",
      "nodeId" : "93c2fc91-51a0-4f89-8ecf-4376b0d9b892",
      "description" : "Set Room ID",
      "properties" : {
        "_type" : "setHeaders",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "headerList" : [ {
          "headerName" : "roomId",
          "headerValue" : "${exchangeProperty.roomId}",
          "language" : "Simple",
          "uuid" : "7256f652-950b-43e4-89b4-421b474b93f5"
        } ],
        "name" : "setHeaders",
        "namespaces" : [ ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setHeaders",
      "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "direct",
      "nodeId" : "c6f66ccb-f6d1-4a65-af38-7e9d82aafe92",
      "description" : "getVideoRoomById",
      "properties" : {
        "_type" : "direct",
        "active" : true,
        "advancedParameters" : [ ],
        "camelGroup" : "core",
        "endpointName" : "getVideoRoomById",
        "name" : "direct",
        "toDynamicEndpoint" : false,
        "url" : ""
      },
      "_type" : "direct",
      "kameletPropertiesUrl" : "?endpointName=getVideoRoomById"
    }, {
      "name" : "messageFilter",
      "nodeId" : "1e120f77-8b07-4fe2-9425-1afd2c54fcba",
      "description" : "",
      "properties" : {
        "_type" : "messageFilter",
        "active" : true,
        "camelGroup" : "routing",
        "name" : "messageFilter",
        "url" : ""
      },
      "_type" : "messageFilter",
      "branches" : [ {
        "type" : "route",
        "label" : "route",
        "route" : [ {
          "name" : "setProperties",
          "nodeId" : "0a65c653-180d-4ad3-afff-07c9d40a7f65",
          "description" : "Set Agency ID",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "JsonPath",
              "propertyName" : "agencyId",
              "propertyValue" : "$.data.agency_id",
              "uuid" : "db9db3fa-fc51-4704-a0b3-efa7c56d1a5e"
            }, {
              "language" : "JsonPath",
              "propertyName" : "conversationId",
              "propertyValue" : "$.data.conversation_id",
              "uuid" : "f2aa734a-fb40-41e2-8f7d-a8731b5b2fa6"
            } ],
            "suppressExceptions" : true,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?agencyId=$.data.agency_id&conversationId=$.data.conversation_id&addNamespaces=false&suppressExceptions=true"
        }, {
          "name" : "messagingEndpoint",
          "nodeId" : "8997db19-9dbf-42dc-9785-ed539aa2c6f5",
          "description" : "SQL Delete Participant",
          "properties" : {
            "_type" : "messagingEndpoint",
            "active" : true,
            "camelGroup" : "core",
            "name" : "messagingEndpoint",
            "toDynamicEndpoint" : false,
            "uri" : "sql:DELETE FROM video_participants WHERE room_id = CAST(:#${exchangeProperty.roomId} AS uuid) AND resource_id = :#${exchangeProperty.participantId}?dataSource=#dsPostgres",
            "url" : ""
          },
          "_type" : "messagingEndpoint",
          "kameletPropertiesUrl" : "?uri=sql:DELETE FROM video_participants WHERE room_id = CAST(:#${exchangeProperty.roomId} AS uuid) AND resource_id = :#${exchangeProperty.participantId}?dataSource=#dsPostgres"
        }, {
          "name" : "process",
          "nodeId" : "5649cddd-b6e6-4caa-850f-c90788ddeb1f",
          "description" : "Set Response",
          "properties" : {
            "_type" : "process",
            "active" : true,
            "camelGroup" : "transform",
            "code" : "HashMap<String, Object> response = new HashMap<String, Object>() {{\n\tput(\"room_id\", (String)exchange.getProperty(\"roomId\"));\n\tput(\"participant_id\", (String)exchange.getProperty(\"participantId\"));\t\n\tput(\"agency_id\", (String)exchange.getProperty(\"agencyId\"));\n}};\n\nexchange.getIn().setBody(response);",
            "import" : "// import org.apache.camel.Message",
            "name" : "process",
            "url" : ""
          },
          "_type" : "process",
          "kameletPropertiesUrl" : "?code=HashMap<String, Object> response = new HashMap<String, Object>() {{\n\tput(\"room_id\", (String)exchange.getProperty(\"roomId\"));\n\tput(\"participant_id\", (String)exchange.getProperty(\"participantId\"));\t\n\tput(\"agency_id\", (String)exchange.getProperty(\"agencyId\"));\n}};\n\nexchange.getIn().setBody(response);&import=// import org.apache.camel.Message"
        }, {
          "name" : "setHeaders",
          "nodeId" : "47446bb4-6d10-4a24-943d-ce9df4167e07",
          "description" : "HTTP200",
          "properties" : {
            "_type" : "setHeaders",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "headerList" : [ {
              "headerName" : "CamelHttpResponseCode",
              "headerValue" : "200",
              "language" : "Constant",
              "uuid" : "710e62e8-51f8-4084-926d-c0d547555cf7"
            } ],
            "name" : "setHeaders",
            "namespaces" : [ ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setHeaders",
          "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "5a5f7de7-7b15-4619-aebf-b2a8985f7d4d",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean(\"renderResponse\")",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean(\"renderResponse\")"
        }, {
          "name" : "log",
          "nodeId" : "15055930-22c1-4c05-96da-e8bdae524d8e",
          "description" : "210.api.prcpt.del.out",
          "properties" : {
            "_type" : "log",
            "active" : true,
            "advancedParameters" : [ ],
            "camelGroup" : "component",
            "level" : "INFO",
            "logType" : "EIP",
            "loggerName" : "210.api.prcpt.del.out",
            "message" : "(${header.CamelHttpResponseCode}) ${body}",
            "multiline" : false,
            "name" : "log",
            "showAll" : false,
            "showBody" : true,
            "showBodyType" : true,
            "showCaughtException" : false,
            "showExchangeId" : false,
            "showHeaders" : false,
            "showProperties" : false,
            "showStackTrace" : false,
            "toDynamicEndpoint" : false,
            "url" : ""
          },
          "_type" : "log",
          "kameletPropertiesUrl" : "?level=INFO&logType=EIP&loggerName=210.api.prcpt.del.out&message=(${header.CamelHttpResponseCode}) ${body}&multiline=false&showAll=false&showBody=true&showBodyType=true&showCaughtException=false&showExchangeId=false&showHeaders=false&showProperties=false&showStackTrace=false"
        }, {
          "name" : "seda",
          "nodeId" : "2f0092d0-44a2-4451-9131-61edb73f8058",
          "description" : "publish-event",
          "properties" : {
            "_type" : "seda",
            "active" : true,
            "advancedParameters" : [ ],
            "blockWhenFull" : false,
            "camelGroup" : "core",
            "concurrentConsumers" : "1",
            "endpointName" : "publish-event",
            "limitConcurrentConsumers" : true,
            "multipleConsumers" : false,
            "name" : "seda",
            "pollTimeout" : "1000",
            "size" : "1000",
            "specifyMaximumCapacitySize" : false,
            "timeout" : "30000",
            "toDynamicEndpoint" : false,
            "url" : "",
            "waitForTaskToComplete" : "Never"
          },
          "_type" : "seda",
          "kameletPropertiesUrl" : "?blockWhenFull=false&concurrentConsumers=1&endpointName=publish-event&limitConcurrentConsumers=true&multipleConsumers=false&pollTimeout=1000&size=1000&specifyMaximumCapacitySize=false&timeout=30000&waitForTaskToComplete=Never"
        } ],
        "properties" : { }
      }, {
        "type" : "filter",
        "label" : "filter",
        "route" : [ {
          "name" : "setProperties",
          "nodeId" : "225fcc63-a095-4abc-a3c7-0d85eaac1431",
          "description" : "Set Error",
          "properties" : {
            "_type" : "setProperties",
            "active" : true,
            "addNamespaces" : false,
            "camelGroup" : "core",
            "name" : "setProperties",
            "namespaces" : [ ],
            "propertyList" : [ {
              "language" : "Constant",
              "propertyName" : "error",
              "propertyValue" : "Video room not found",
              "uuid" : "d1be8bed-3828-4922-a1c9-e9daae823fb3"
            }, {
              "language" : "Constant",
              "propertyName" : "CamelHttpResponseCode",
              "propertyValue" : "404",
              "uuid" : "58628ab8-4926-4f41-9ff7-3eaa5dd76fbf"
            } ],
            "suppressExceptions" : false,
            "url" : ""
          },
          "_type" : "setProperties",
          "kameletPropertiesUrl" : "?error=Video room not found&CamelHttpResponseCode=404&addNamespaces=false&suppressExceptions=false"
        }, {
          "name" : "dslProcessor",
          "nodeId" : "80855e4c-ee94-4835-a169-62229e16d279",
          "description" : "Render Response",
          "properties" : {
            "_type" : "dslProcessor",
            "active" : true,
            "camelGroup" : "core",
            "dsl" : ".bean('renderResponse')",
            "name" : "dslProcessor",
            "url" : ""
          },
          "_type" : "dslProcessor",
          "kameletPropertiesUrl" : "?dsl=.bean('renderResponse')"
        }, {
          "name" : "stop",
          "nodeId" : "443a20fa-2fe5-4f16-9ad4-3b337cb35ed7",
          "description" : "",
          "properties" : {
            "_type" : "stop",
            "camelGroup" : "misc",
            "name" : "stop",
            "url" : ""
          },
          "_type" : "stop",
          "kameletPropertiesUrl" : ""
        } ],
        "properties" : {
          "addNamespaces" : "false",
          "condition" : "${header.foo} == \"bar\"",
          "language" : "Simple",
          "namespaces" : [ ],
          "suppressExceptions" : "false"
        }
      } ],
      "kameletPropertiesUrl" : ""
    } ]
  } ],
  "traits" : [ {
    "name" : "health",
    "configuration" : {
      "enabled" : true,
      "livenessProbeEnabled" : true,
      "readinessProbeEnabled" : true
    }
  } ],
  "id" : "0649856e-bdaa-414c-98cd-ab89dcfd3ef4",
  "name" : "r210-video-api",
  "description" : "",
  "createdAt" : "2023-10-04T18:05:10.179388798",
  "updatedAt" : "2023-10-04T18:05:10.179389264",
  "createdBy" : "612c1b37-217d-49f9-b344-54b8af760f6a",
  "updatedBy" : "612c1b37-217d-49f9-b344-54b8af760f6a"
}