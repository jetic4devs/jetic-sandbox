{
  "revision" : 30,
  "compression" : false,
  "dataAnalyzer" : true,
  "replicas" : 1,
  "openApiUuid" : "90986bd7-9d70-482d-a416-be69fec8510d",
  "currentProfileUuid" : "62c1cde5-30f6-41d5-8c08-26ffb86e3053",
  "parameterGroupUuids" : [ "e1d81a6a-655e-42ff-8288-6b0891abe7b0", "3dacce84-b8c8-4759-8bfa-355c8cf6acd6", "c9a8ecf3-391c-4a06-bdc0-68a1a504fdd9" ],
  "repoResourceUuids" : [ "a1057428-1531-40a8-a129-ed27382e947f", "3b5aa833-0eaa-4cb9-8ce8-ca97eac74110", "1872a943-2a9b-4513-8739-06e95090b977", "71e48dda-80e9-4034-af48-cf39a9a10938", "0d41f9ca-58b0-434f-a68e-5855e59f3249", "07e34d9c-7cea-4532-94e6-7da0f6bddeb3", "2d21c0b9-a829-4420-84e6-67d34aaf6026", "fedc2ba8-c348-4a92-a89c-844badda8f1f", "eddb9cf2-828c-4bf6-a038-93128340a0c2", "60b1161c-74ee-4cd8-96a1-0055c90271c1", "f50d9293-f6bf-47b6-b21e-4cfda6eee3c4", "55882383-5e69-44b0-a3ac-12785e306303", "17e7ca54-4247-4e9c-ba30-d078e3ac407a", "e859d27c-054e-489d-96ef-1338b179fde7", "38657aaf-c7a4-4a04-9321-bb750c2e67b5", "cea63fc0-42b4-43ef-8a11-ab37de1f4f55" ],
  "routeDefinitions" : [ {
    "id" : null,
    "camelRouteId" : "route-1",
    "enabled" : true,
    "routeId" : 1,
    "route" : [ {
      "name" : "getRequest",
      "nodeId" : "af94cdd3-a7c6-4c31-a00f-14780cfb3515",
      "description" : "getGeolocations",
      "properties" : {
        "_type" : "restApi",
        "active" : true,
        "camelGroup" : "rest",
        "consumes" : "application/json",
        "endpoint" : "/api/v1/geolocations",
        "method" : "get",
        "name" : "getRequest",
        "operationName" : "getGeolocations",
        "produces" : "application/json",
        "requestmethod" : "GET",
        "url" : ""
      },
      "_type" : "restApi",
      "kameletPropertiesUrl" : "?consumes=application/json&endpoint=/api/v1/geolocations&method=get&operationName=getGeolocations&produces=application/json&requestmethod=GET"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "953dc472-591c-4365-ba8d-767fbcb72747",
      "description" : "Validate JWT",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('validateJwt')\n.filter().simple('${exchangeProperty.jwtAuth} != true')\n            .stop()\n        .end()"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "a7314cac-2442-4375-af75-362a11cc8a05",
      "description" : "Validate Request",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"bean:validateRequest\")\n    .filter().simple('${header.CamelHttpResponseCode} >= 400')\n        .bean('renderResponse')\n      .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n            .stop()\n        .end()",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"bean:validateRequest\")\n    .filter().simple('${header.CamelHttpResponseCode} >= 400')\n        .bean('renderResponse')\n      .log(LoggingLevel.WARN, 'log', '${header.CamelHttpResponseCode} ${body}') \n            .stop()\n        .end()"
    }, {
      "name" : "setProperties",
      "nodeId" : "ededa19b-a503-48bf-ba3e-fab93a4cfea4",
      "description" : "Get Input Params",
      "properties" : {
        "_type" : "setProperties",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "name" : "setProperties",
        "namespaces" : [ ],
        "propertyList" : [ {
          "language" : "Header",
          "propertyName" : "agencyId",
          "propertyValue" : "x-agency-id",
          "uuid" : "9ac96338-5d17-4983-b764-c7f342780a4a"
        }, {
          "language" : "Header",
          "propertyName" : "conversationId",
          "propertyValue" : "conversationId",
          "uuid" : "63e2c069-40fb-43c9-b1aa-65229a750a57"
        }, {
          "language" : "Header",
          "propertyName" : "recipientId",
          "propertyValue" : "recipientId",
          "uuid" : "3f064dc8-6dbf-4816-9df1-7e8b229c3d54"
        }, {
          "language" : "Header",
          "propertyName" : "recipientNumber",
          "propertyValue" : "recipientNumber",
          "uuid" : "6849b189-0789-458c-8092-dcc629103144"
        } ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setProperties",
      "kameletPropertiesUrl" : "?agencyId=x-agency-id&conversationId=conversationId&recipientId=recipientId&recipientNumber=recipientNumber&addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "0b60f794-585a-4aa3-81e2-9668b03cd9eb",
      "description" : "Remove Headers",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".removeHeaders(\"*\",  \"x-*\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.removeHeaders(\"*\",  \"x-*\")"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "e2301c33-e40a-4e62-be8b-ae7b5f986223",
      "description" : "SQL Get Geolocations",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".to(\"velocity:geolocations.select.sql.vm?allowContextMapAll=true\")\n        .log(LoggingLevel.INFO, 'log', '${body}')\n                .to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectList&useMessageBodyForSql=true\")",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.to(\"velocity:geolocations.select.sql.vm?allowContextMapAll=true\")\n        .log(LoggingLevel.INFO, 'log', '${body}')\n                .to(\"sql:query?dataSource=#dsPostgres&OutputType=SelectList&useMessageBodyForSql=true\")"
    }, {
      "name" : "setHeaders",
      "nodeId" : "26f15371-e7aa-42ff-b5b7-2c5a99f6236a",
      "description" : "HTTP200",
      "properties" : {
        "_type" : "setHeaders",
        "active" : true,
        "addNamespaces" : false,
        "camelGroup" : "core",
        "headerList" : [ {
          "headerName" : "CamelHttpResponseCode",
          "headerValue" : "200",
          "language" : "Constant",
          "uuid" : "b5eeb4e0-02f9-47b0-bc6a-7e8423989371"
        } ],
        "name" : "setHeaders",
        "namespaces" : [ ],
        "suppressExceptions" : false,
        "url" : ""
      },
      "_type" : "setHeaders",
      "kameletPropertiesUrl" : "?addNamespaces=false&suppressExceptions=false"
    }, {
      "name" : "dslProcessor",
      "nodeId" : "d4a465e9-d28f-4b80-8293-fabe8a767901",
      "description" : "Render Response",
      "properties" : {
        "_type" : "dslProcessor",
        "active" : true,
        "camelGroup" : "core",
        "dsl" : ".bean('renderResponse')",
        "name" : "dslProcessor",
        "url" : ""
      },
      "_type" : "dslProcessor",
      "kameletPropertiesUrl" : "?dsl=.bean('renderResponse')"
    } ]
  } ],
  "traits" : [ {
    "name" : "health",
    "configuration" : {
      "enabled" : true,
      "livenessProbeEnabled" : true,
      "readinessProbeEnabled" : true
    }
  } ],
  "id" : "c50cbd1e-59ac-4a97-8311-5dbe72e8aa2f",
  "name" : "r217-geolocation-api",
  "description" : "",
  "createdAt" : "2023-10-04T18:05:13.325359863",
  "updatedAt" : "2023-10-04T18:05:13.325360803",
  "createdBy" : "612c1b37-217d-49f9-b344-54b8af760f6a",
  "updatedBy" : "612c1b37-217d-49f9-b344-54b8af760f6a"
}